ADY;PAINEL DE PROPOSTAS;69;20200430;;12;2;ADY;0;;;'ADY->ADY_FILIAL=xFilial("ADY") .And. ADY->ADY_STATUS = "H" .AND. DTOS(ADY->ADY_DTUPL) >= mv_par01 .AND. DTOS(ADY->ADY_DTUPL) <= mv_par02';2;01;;;1;2;0;;;1;;;;
AGRPRO;AGRUPADOR X PRODUTO;73;20180716;;51;2;;0;;;;2;02;;;1;2;0;;;1;;SELECT DISTINCT
AZ0_CODNIV
,AOM_DESCRI
,B1_COD
,B1_DESC
,AZ0_DE
,DA0_DESCRI
,B1_GRUPO
,BM_DESC
,BM_GRUREL
FROM SB1000 SB1
INNER JOIN AZ0000 AZ0 ON AZ0.D_E_L_E_T_ = ' '
AND AZ0_FILIAL = ' '
AND AZ0_CODAGR = '000112'
INNER JOIN DA1000 DA1 ON DA1.D_E_L_E_T_ = ' '
AND DA1_FILIAL = ' '
AND DA1_CODTAB = AZ0_DE
AND DA1_CODPRO = B1_COD
INNER JOIN DA0000 DA0 ON DA1.D_E_L_E_T_ = ' '
AND DA0_FILIAL = ' '
AND DA0_CODTAB = AZ0_DE
INNER JOIN SBM000 SBM ON SBM.D_E_L_E_T_ = ' '
AND BM_FILIAL = ' '
AND BM_GRUPO = B1_GRUPO
INNER JOIN AOM000 AOM ON AOM.D_E_L_E_T_ = ' '
AND AOM_FILIAL = ' '
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = AZ0_CODNIV

WHERE SB1.D_E_L_E_T_ = ' '
AND B1_FILIAL = ' '
AND AZ0_CODNIV BETWEEN @I_AZ0_CODNIV@ AND @F_AZ0_CODNIV@;;Relatório de Agrupador x Produtos
ANAFIN;ANALISE FINANCEIRA MAIARA;73;20210427;;25;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
'CLIENTE' AS ENTIDADE
,ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
END AS ADY_STATUS
,ADY_DATA
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_PRCVEN
,ADZ_QTDVEN
,ADZ_TOTAL
,ADY_CODIGO
,A1_CGC
,A1_NOME
,SUBSTR(ZT0_CHAVE,1,6) AS ZT0_CHAVE
,PDV_DESCRI
,ZXS_CODAPR
,USR_NOME
,ZXS_DTENV
,ZXS_DTRET
,ZXS_STAFLG
,ZXS_IDFLG
,YP_TEXTO

FROM ADY000 ADY

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' ' 
AND A1_COD = ADY_CODIGO

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' ' 
AND ADZ.D_E_L_E_T_ = ' ' 
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS

INNER JOIN ZRM000 ZRM ON ZRM_FILIAL = ' '
AND ZRM.D_E_L_E_T_ = ' '
AND ZRM_IDPROC = ADY_XIDPRC
AND ZRM_CHAVE = ADY_PROPOS

INNER JOIN ZT0000 ZT0 ON ZT0_FILIAL = ' ' 
AND ZT0.D_E_L_E_T_ = ' '
AND ZT0_IDPROC = ZRM_IDPROC
AND ZT0_RESP IN ('274014','003992','003815')

INNER JOIN PDV000 PDV ON PDV_FILIAL = ' '
AND PDV.D_E_L_E_T_ = ' '
AND PDV_CODIGO = SUBSTR(ZT0_CHAVE,1,6)

LEFT JOIN ZXS000 ZXS ON ZXS_FILIAL = ' '
AND ZXS.D_E_L_E_T_ = ' '
AND ZXS_IDPROC = ZRM_IDPROC

LEFT JOIN SYP000 SYP ON YP_FILIAL = ' '
AND SYP.D_E_L_E_T_ =' '
AND YP_CHAVE = ZXS_CODRET

LEFT JOIN SYS_USR USR ON USR.D_E_L_E_T_ = ' '
AND USR_ID = ZXS_CODAPR

WHERE ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' ' 
AND ZXS_CODAPR IN ('274014','003992','003815')
AND ADY_ENTIDA = '1'
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@

UNION ALL

SELECT DISTINCT
'PROSPECT' AS ENTIDADE
,ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
END AS ADY_STATUS
,ADY_DATA
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_PRCVEN
,ADZ_QTDVEN
,ADZ_TOTAL
,ADY_CODIGO
,US_CGC
,US_NOME
,SUBSTR(ZT0_CHAVE,1,6) AS ZT0_CHAVE
,PDV_DESCRI
,ZXS_CODAPR
,USR_NOME
,ZXS_DTENV
,ZXS_DTRET
,ZXS_STAFLG
,ZXS_IDFLG
,YP_TEXTO

FROM ADY000 ADY

INNER JOIN SUS000 SUS ON US_FILIAL = ' ' 
AND SUS.D_E_L_E_T_ = ' ' 
AND US_COD = ADY_CODIGO

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' ' 
AND ADZ.D_E_L_E_T_ = ' ' 
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS

INNER JOIN ZRM000 ZRM ON ZRM_FILIAL = ' '
AND ZRM.D_E_L_E_T_ = ' '
AND ZRM_IDPROC = ADY_XIDPRC
AND ZRM_CHAVE = ADY_PROPOS

INNER JOIN ZT0000 ZT0 ON ZT0_FILIAL = ' ' 
AND ZT0.D_E_L_E_T_ = ' '
AND ZT0_IDPROC = ZRM_IDPROC
AND ZT0_RESP IN ('274014','003992','003815')

INNER JOIN PDV000 PDV ON PDV_FILIAL = ' '
AND PDV.D_E_L_E_T_ = ' '
AND PDV_CODIGO = SUBSTR(ZT0_CHAVE,1,6)

LEFT JOIN ZXS000 ZXS ON ZXS_FILIAL = ' '
AND ZXS.D_E_L_E_T_ = ' '
AND ZXS_IDPROC = ZRM_IDPROC

LEFT JOIN SYP000 SYP ON YP_FILIAL = ' '
AND SYP.D_E_L_E_T_ =' '
AND YP_CHAVE = ZXS_CODRET

LEFT JOIN SYS_USR USR ON USR.D_E_L_E_T_ = ' '
AND USR_ID = ZXS_CODAPR

WHERE ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' ' 
AND ZXS_CODAPR IN ('274014','003992','003815')
AND ADY_ENTIDA = '2'
AND NOT EXISTS (SELECT A1_COD FROM SA1000 SA1 WHERE A1_FILIAL= ' ' AND A1_CGC = US_CGC AND SA1.D_E_L_E_T_=' ')
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@;;
AOX;DE/PARA DE CAMPOS;73;20201110;;6;2;AOX;0;;;;2;;;;1;2;0;;;1;;;;
APPROJ;APROVADORES DE PROJETOS DE VIAGENS;06;20180620;;52;2;;0;;;;2;03;;;1;2;0;;;1;;SELECT 

PE8_COORD AS COD_CP,
RD0.RD0_NOME AS NOME_CP,
RD0.RD0_IDRESE AS ID_CP,
RD0.RD0_MSBLQL BLQ,
PE7_CODREC,
RD0A.RD0_NOME AS NOME_GPP,
RD0A.RD0_IDRESE AS ID_GPP,
RD0A.RD0_IDRESE AS ID_GPP,
RD0A.RD0_MSBLQL BLQ2,
RD0B.RD0_CODIGO AS COD_APROV,
RD0B.RD0_NOME AS NOME_APROV,
RD0B.RD0_IDRESE AS ID_APROV,
RD0B.RD0_MSBLQL BLQ3

FROM RD0000 RD0 

JOIN PE8000 PE8 ON RD0.RD0_CODIGO = PE8_COORD
AND PE8.D_E_L_E_T_ = ' '

JOIN PE7000 PE7 ON PE7_PROJET = PE8_PROJET
AND  PE7_PAPEL = 'GPP'
AND PE7.D_E_L_E_T_ = ' '

JOIN RD0000 RD0A ON RD0A.RD0_CODIGO = PE7.PE7_CODREC
AND RD0A.D_E_L_E_T_ = ' '

JOIN RD0000 RD0B ON RD0A.RD0_APROPC = RD0B.RD0_CODIGO
AND RD0B.D_E_L_E_T_ = ' '

WHERE 
PE8_PROJET = @PROJETO@
AND PE8_CODIGO = @FRENTE@
AND RD0.D_E_L_E_T_ = ' ';;
ATUZQE;INCLUI CLIENTES P/ ATENDIMENTO ZENDESK - ZQE E AI0;69;20180731;;67;2;;0;;;;2;04;;;1;2;0;;;1;;SELECT ZQE_CODCLI, ZQE_LJCLI, 'N' AS ZQE_INADIM, 'S' AS ZQE_ATENDE
	FROM ZQE000
WHERE ZQE_FILIAL = ' ' AND ZQE_CODCLI = ' ' AND ZQE_LJCLI = ' 'AND  D_E_L_E_T_ = ' ';Rotina para importação de arquivo CSV contendo lista com codigo do cliente que deve ser importado nas tabelas ZQE e AI0 para receber atendimento zendesk. A necessidade surgiu quando clientes CMNET com produto "Reservas" ligavam no atendimento e eram informados que não possuiam contrato.;
AUD001;RELATÓRIO DE ACESSO A ROTINAS;73;20180807;;18;2;;0;;;;2;05;;;1;2;0;;;1;;SELECT 
USR.USR_ID AS USR_ID
,USR.USR_CODIGO AS USR_CODIGO
,USR.USR_NOME AS USR_NOME

,CASE USR.USR_MSBLQL 
WHEN '1' THEN 'SIM'
WHEN '2' THEN 'NAO'
END AS USU_BLQ

,GRP.USR_GRUPO AS USR_GRUPO 
,GGP.GR__CODIGO AS GR__CODIGO
,RGR.GR__RL_ID AS GR__RL_ID

,CASE RLT.RL__ACESSO
WHEN '2' THEN 'NAO'
WHEN '1' THEN 'SIM'
END AS PERM_ROTIN

,RLF.RL__ROTINA AS RL__ROTINA
,RLT.RL__DESROT AS RL__DESROT

,CASE RLF.RL__ACESSO
WHEN '2' THEN 'NAO'
WHEN '1' THEN 'SIM'
END AS PERMITE

,RLF.RL__DESMDEF AS FUNCAO


FROM SYS_USR USR

JOIN SYS_USR_GROUPS GRP ON GRP.USR_ID = USR.USR_ID
AND GRP.D_E_L_E_T_ = ' '

JOIN SYS_GRP_GROUP GGP ON GGP.GR__ID = GRP.USR_GRUPO
AND GGP.D_E_L_E_T_ = ' '

JOIN SYS_RULES_GRP_RULES RGR ON GGP.GR__ID = RGR.GROUP_ID
AND RGR.D_E_L_E_T_ = ' '


JOIN SYS_RULES_FEATURES RLF ON RGR.GR__RL_ID = RLF.RL__ID
AND RLF.D_E_L_E_T_ = ' '

JOIN SYS_RULES_TRANSACT RLT ON RLF.RL__ID = RLT.RL__ID
AND RLT.RL__ROTINA = RLF.RL__ROTINA
AND RLT.D_E_L_E_T_ = ' '

WHERE USR.USR_MSBLQL = '2'
AND RLT.RL__ACESSO = '1'
AND USR.USR_GRPRULE = '1'
AND RLF.RL__ROTINA <ADVPL>If(_OPCAO = "1", " = 'TCRMA015'", If(_OPCAO = "2", "= 'TCRMA002'", "= 'OMSA010'"))</ADVPL>
AND USR.D_E_L_E_T_ = ' ';;Relatório para extração de acesso das rotinas de alçada e regras de aprovação de WF disparados pelo CRM para fins de auditoria.
AUD002;RELATÓRIO TABELA DE PREÇOS;73;20180807;;4;2;;0;;;;2;06;;;1;2;0;;;1;;SELECT DISTINCT
DA1_CODTAB
,DA0_DESCRI
,DA1_CODPRO
,DA1_PRCVEN
,CASE
WHEN DA1_ATIVO = '1' THEN 'ATIVO'
WHEN DA1_ATIVO <> '1' THEN 'INATIVO'
END AS DA1_ATIVO
,SUBSTR(DA1_DATVIG,7,2) || '/' || SUBSTR(DA1_DATVIG,5,2) || '/' || SUBSTR(DA1_DATVIG,1,4) AS DA1_DATVIG
,DA1_XVLTIU

FROM DA1000 DA1

INNER JOIN DA0000 DA0 ON DA0_FILIAL = ' ' 
AND DA0.D_E_L_E_T_ = ' ' 
AND DA0_CODTAB = DA1_CODTAB

WHERE DA1_FILIAL = ' ' 
AND DA1.D_E_L_E_T_ = ' ';;Relatório de tabela de preços.
Traz todas as tabelas cadastradas na DA0
AUD003;PROPOSTAS NEGOCIAÇÃO ESPECÍFICA;73;20180807;;11;2;;0;;;;2;07;;;1;2;0;;;1;;SELECT DISTINCT
ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS ADY_STATUS
,SUBSTR(ADY_DATA,7,2) || '/' || SUBSTR(ADY_DATA,5,2) || '/' || SUBSTR(ADY_DATA,1,4) AS ADY_DATA
,'CLIENTE' AS ENTIDADE
,ADY_CODIGO
,A1_NOME
,ZXS_IDFLG
,ZXS_STAFLG
,ZXS_CODAPR
,USR_NOME
,SUBSTR(ZXS_DTRET,7,2) || '/' || SUBSTR(ZXS_DTRET,5,2) || '/' || SUBSTR(ZXS_DTRET,1,4) AS ZXS_DTRET
,ZT0_CHAVE
,PDV_DESCRI
,A1_VEND
,UTL_RAW.CAST_TO_VARCHAR2(DBMS_LOB.SUBSTR(ADY_XMEMNE,2000)) ADY_XMEMNE

FROM ADY000 ADY

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND A1_COD = ADY_CODIGO
AND A1_VEND NOT IN ('T99001','000001') 
AND SA1.D_E_L_E_T_ = ' '

INNER JOIN ZXS000 ZXS ON ZXS_FILIAL = ' ' 
AND ZXS_IDPROC = ADY_XIDPRC 
AND ZXS.D_E_L_E_T_ = ' '

INNER JOIN ZT0000 ZT0 ON ZT0_FILIAL = ' ' 
AND ZT0_IDPROC = ZXS_IDPROC 
AND ZT0.D_E_L_E_T_ = ' '
AND SUBSTR(ZT0_CHAVE,1,6) IN ('ES0006','ES1000','ES1002','ES1003','ES1004','ES1005','ES1006','ES1007','ES1008','ES1009','ES1010','ES1011','ES1012','TAXA1J','TAXA22')

INNER JOIN PDV000 PDV ON PDV_FILIAL = ' ' 
AND PDV_CODIGO = SUBSTR(ZT0_CHAVE,1,6) 
AND PDV.D_E_L_E_T_ = ' '

LEFT JOIN SYS_USR USR ON USR_ID = ZXS_CODAPR 
AND USR.D_E_L_E_T_ = ' '

WHERE ADY_FILIAL = ' '
AND ADY_ENTIDA = '1'
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@
AND ADY_XIDPRC <> ' ' 
AND ZXS_IDFLG <> ' ' 
AND ADY.D_E_L_E_T_ = ' '

UNION ALL

SELECT DISTINCT
ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS ADY_STATUS
,SUBSTR(ADY_DATA,7,2) || '/' || SUBSTR(ADY_DATA,5,2) || '/' || SUBSTR(ADY_DATA,1,4) AS ADY_DATA
,'PROSPECT' AS ENTIDADE
,ADY_CODIGO
,US_NOME
,ZXS_IDFLG
,ZXS_STAFLG
,ZXS_CODAPR
,USR_NOME
,SUBSTR(ZXS_DTRET,7,2) || '/' || SUBSTR(ZXS_DTRET,5,2) || '/' || SUBSTR(ZXS_DTRET,1,4) AS ZXS_DTRET
,ZT0_CHAVE
,PDV_DESCRI
,US_VEND
,UTL_RAW.CAST_TO_VARCHAR2(DBMS_LOB.SUBSTR(ADY_XMEMNE,2000)) ADY_XMEMNE

FROM ADY000 ADY

INNER JOIN SUS000 SUS ON US_FILIAL = ' '
AND US_COD = ADY_CODIGO
AND US_VEND NOT IN ('T99001','000001') 
AND SUS.D_E_L_E_T_ = ' '

INNER JOIN ZXS000 ZXS ON ZXS_FILIAL = ' ' 
AND ZXS_IDPROC = ADY_XIDPRC 
AND ZXS.D_E_L_E_T_ = ' '

INNER JOIN ZT0000 ZT0 ON ZT0_FILIAL = ' ' 
AND ZT0_IDPROC = ZXS_IDPROC 
AND ZT0.D_E_L_E_T_ = ' '
AND SUBSTR(ZT0_CHAVE,1,6) IN ('ES0006','ES1000','ES1002','ES1003','ES1004','ES1005','ES1006','ES1007','ES1008','ES1009','ES1010','ES1011','ES1012','TAXUSJ','TAXA22')

INNER JOIN PDV000 PDV ON PDV_FILIAL = ' ' 
AND PDV_CODIGO = SUBSTR(ZT0_CHAVE,1,6) 
AND PDV.D_E_L_E_T_ = ' '

LEFT JOIN SYS_USR USR ON USR_ID = ZXS_CODAPR 
AND USR.D_E_L_E_T_ = ' '

WHERE ADY_FILIAL = ' '
AND ADY_ENTIDA = '2'
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@
AND ADY_XIDPRC <> ' ' 
AND ZXS_IDFLG <> ' ' 
AND NOT EXISTS (SELECT A1_COD FROM SA1000 SA1 WHERE A1_FILIAL= ' ' AND A1_CGC = US_CGC AND SA1.D_E_L_E_T_=' ')
AND ADY.D_E_L_E_T_ = ' ';;Relatório contendo as propostas que geraram negociação específica para fins de auditoria
AUD004;RELATÓRIO DE ALÇADAS DE APROVAÇÃO;73;20180807;;4;2;;0;;;;2;08;;;1;2;0;;;1;;SELECT DISTINCT
PDV_CODIGO
,PDV_DESCRI
,CASE
WHEN PDV_TIPO = '1' THEN 'APROVADOR UNICO'
WHEN PDV_TIPO = '2' THEN 'FILA DE APROVACAO'
END AS PDV_TIPO
,CASE
WHEN PDV_TPAPRO = '1' THEN 'HIERARQUIA'
WHEN PDV_TPAPRO = '2' THEN 'NEGÓCIO'
END AS PDV_TPAPRO
,CASE
WHEN PDV_ORIVLA = '1' THEN 'VALOR DE TABELA'
WHEN PDV_ORIVLA = '2' THEN 'VALOR DE VEND'
END AS PDV_ORIVLA
,PDV_AGRUPV
,AOM_DESCRI
,ZL2_ITEM
,ZL2_DESCRI
,ZL2_DE
,ZL2_ATE
,ZL2_CARGO
,UM_DESC
,ZL2_VEND
,A3_NOME
,ZL2_USER
,ZL2_NOMUSR
,ZL2_USRCOP
,ZL2_NOMCOP

FROM PDV000 PDV

INNER JOIN ZL2000 ZL2 ON ZL2_FILIAL = ' '
AND ZL2.D_E_L_E_T_ = ' '
AND ZL2_CODIGO = PDV_CODIGO

LEFT JOIN SUM000 SUM ON UM_FILIAL = ' '
AND SUM.D_E_L_E_T_ = ' '
AND UM_CARGO = ZL2_CARGO

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = ZL2_VEND

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = '000112'
AND AOM_IDINT = PDV_AGRUPV

WHERE PDV_FILIAL = ' '
AND PDV.D_E_L_E_T_ = ' ';;Relatório de alçada de aprovações para fins de auditoria.
AUDSRV;PROPOSTAS/APROVAÇÃO SERVIÇOS;73;20210203;;112;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT	
ADY_OPORTU
,ADY_PROPOS	
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
END AS ADY_STATUS
,ADY_XMODAL
,ADY_DATA
,ADY_DTUPL
,ADY_XFILSF
,ADY_XUNSRV
,PE1_DESCRI
,AD1_VEND
,A3_NOME
,A3_UNIDAD
,ADK_NOME
,ADY_XMLUCR
,ADY_MESES
,(SELECT MAX(PA3_RISK) 
	FROM PA3000 PA3
	WHERE PA3_FILIAL = ' ' 
	AND PA3.D_E_L_E_T_ = ' ' 
	AND PA3_OPORTU = ADY_OPORTU) AS PA3_RISK
,ADZ_ITEM	
,ADZ_PRODUT	
,ADZ_DESCRI	
,ADZ_CONDPG	
,ADZ_PRCTAB	
,ADZ_PRCVEN	
,ADZ_QTDVEN	
,ADZ_TOTAL	
,CONCAT(ADZ_DESCON,'%') AS ADZ_DESCON	
,ADZ_VALDES	
,SUBSTR(ZT0_CHAVE,1,6) AS ZT0_CHAVE	
,PDV_DESCRI	
,UTL_RAW.CAST_TO_VARCHAR2(DBMS_LOB.SUBSTR(ZRM_OBS, 2000,1)) AS ZRM_OBS	
,ZXS_CODAPR	
,USR_NOME	
,USR_EMAIL	
,ZXS_IDFLG	
,ZXS_STAFLG
,UTL_RAW.CAST_TO_VARCHAR2(DBMS_LOB.SUBSTR(ADY_XMEMNE, 2000,1)) AS ADY_XMEMNE
	
FROM ADY000 ADY	
	
LEFT JOIN ADZ000 ADZ ON ADZ_FILIAL = ' ' 	
AND ADZ.D_E_L_E_T_ = ' ' 	
AND ADZ_PROPOS = ADY_PROPOS	
AND ADZ_REVISA = ADY_PREVIS	
	
LEFT JOIN ZRM000 ZRM ON ZRM_FILIAL = ' '	
AND ZRM.D_E_L_E_T_ = ' '	
AND ZRM_IDPROC = ADY_XIDPRC	
AND ZRM_CHAVE = ADY_PROPOS	
	
LEFT JOIN ZT0000 ZT0 ON ZT0_FILIAL = ' ' 	
AND ZT0.D_E_L_E_T_ = ' '	
AND ZT0_IDPROC = ZRM_IDPROC	
	
LEFT JOIN PDV000 PDV ON PDV_FILIAL = ' '	
AND PDV.D_E_L_E_T_ = ' '	
AND PDV_CODIGO = SUBSTR(ZT0_CHAVE,1,6)	
	
LEFT JOIN ZL2000 ZL2 ON ZL2_FILIAL = ' ' 	
AND ZL2.D_E_L_E_T_ = ' ' 	
AND ZL2_CODIGO = SUBSTR(ZT0_CHAVE,1,6) 	
AND SUBSTR(ZL2_XREVIS,2,2) = SUBSTR(ZT0_CHAVE,7,2)	
	
LEFT JOIN ZXS000 ZXS ON ZXS_FILIAL = ' '	
AND ZXS.D_E_L_E_T_ = ' '	
AND ZXS_IDPROC = ZT0_IDPROC	
	
LEFT JOIN SYS_USR USR ON USR.D_E_L_E_T_ = ' '	
AND USR_ID = ZXS_CODAPR	
	
LEFT JOIN AZS000 AZS ON AZS_FILIAL = ' '	
AND AZS.D_E_L_E_T_ = ' ' 	
AND AZS_CODUSR = ZXS_CODAPR	
	
LEFT JOIN SYP000 SYP ON YP_FILIAL = ' ' 	
AND SYP.D_E_L_E_T_ =' ' 	
AND YP_CHAVE = ZXS_CODRET

LEFT JOIN PE1000 PE1 ON PE1_FILIAL = ' ' 
AND PE1.D_E_L_E_T_ = ' ' 
AND PE1_CODIGO = ADY_XUNSRV

LEFT JOIN AD1000 AD1 ON AD1_FILIAL = ' ' 
AND AD1.D_E_L_E_T_ = ' ' 
AND AD1_NROPOR = ADY_OPORTU
AND AD1_REVISA = ADY_REVISA

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' 
AND SA3.D_E_L_E_T_ = ' ' 
AND A3_COD = AD1_VEND

LEFT JOIN ADK000 ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' ' 
AND ADK_COD = A3_UNIDAD
		
WHERE ADY_FILIAL = ' ' 	
AND ADY.D_E_L_E_T_ = ' '	
AND ADY_XMODAL IN ('0001','0002','0003','0004','0005','0006','0007','0008','0009','0010','0011','0012','0014','0015','0016','0017','0018','0019','0020','0021','0022','0024','0027','0028','0029','0030','0031','0032','0033','0034','0035','0036','0037','0038','0039','0040','0041','0042','0043','0044','0045','0046','0047','0048','0049','0050','0051','0052','0053','0054','0055','0061','0062','0063','0064','0065','0068','0069','0076','0080','0081','0082','0083','0084','0085','0086','0087','0089','0090','0091','0092','0093','0094','0095','0100','0102','0103','0105','0106','0108','0116','0144','0145','0146','0147','0148','0149','0150','0151','0152','0153','0154','0155','0156','0157','0158','0160','0161','0163','0165','0166','0167','0168','0169','0170','0171','0176','0180','0182','0183','0185','0187','0192','0193','0194','0195','0196','0197','0198','0199','0200','0201','0202','0205','0206','0207','0208','0209','0210','0211','0215','0220','0222','0223','0224','0225','0226','0227','0228','0229','0230','0231','0234','0236','0237','0238','0239','0240','0241','0243','0244','0245','0246','0247','0248','0250','0251','0252','0253','0254','0255','0256','0257','0258','0259','0260','0263','0264','0266','0268','0269','0270','0271','0272','0273','0274','0275','0276','0278','0280','0281','0282','0283','0284','0285','0286','0287','0288','0289','0290','0291','0292','0293','0294','0295','0296','0297','0298','0299','0300','0301','0302','0303','0304','0306','0307','0308','0309','0310','0311','0312','0313','0314','0315','0316','0317','0318','0319','0320','0321','0322','0323','0324','0325','0326','0327','0328','0329','0330','0333','0335','0336','0337','0338','0339','0340','0341','0342','0343','0344','0345','0346','0347','0348','0349','0350','0351','0353','0354','0355','0356','0357','0358','0364','0365','0366','0367','0368','0375','0377','0379','0380','0381','0383','0384','0385','0386','0388','0390','0391','0392','0393','0394','0395','0396','0397','0398','0399','0400','0401','0402','0403','0404','0405','0406','0407','0408','0409','0410','0411','0412','0413','0414','0415','0416','0417','0418','0419','0420','0421','0422','0423','0424','0425','0426','0427','0428','0429','0431','0432','0433','0434','0435','0436','0437','0438','0439','0440','0441','0442','0443','0444','0448','0449','0450','0451','0452','0453','0454','0455','0456','0457','0466','0467','0468','0469','0470','0471','0474','0475','0477','0478','0066','0067','0070','0071','0072','0073','0074','0075','0096','0125','0126','0127','0128','0129','0130','0131','0132','0133','0134','0138','0139','0203','0204','0216','0249','0262','0277')
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@;;
AUDSSN;CONTRATOS ATIVOS DE CLOUD;69;20210726;;13;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT a1_cod,
a1_cgc,
a1_nome,
cnb_item,
cnb_produt,
cnb_descri,
cnb_vlunit,
cnb_quant,
cnb_vltot,
cnb_situac,
cnb_unineg,
m0_filial,
CASE
WHEN cnb_condic = '00' THEN 'Mensal'
WHEN cnb_condic = '01' THEN 'Bimestral'
WHEN cnb_condic = '02' THEN 'Trimestral'
WHEN cnb_condic = '03' THEN 'Quadrimestral'
WHEN cnb_condic = '05' THEN 'Semestral'
WHEN cnb_condic = '11' THEN 'Anual'
WHEN cnb_condic = '12' THEN 'Bianual'
END AS FATURAMENT,
CASE
WHEN cnb_situac = 'A' THEN 'ATIVO'
WHEN cnb_situac = 'S' THEN 'SUSPENSO'
WHEN cnb_situac = 'C' THEN 'CANCELADO'
WHEN cnb_situac = 'G' THEN 'GRATUITO'
WHEN cnb_situac = 'P' THEN 'PENDENTE'
WHEN cnb_situac = 'M' THEN 'MANUAL'
WHEN cnb_situac = 'O' THEN 'TROCADO'
WHEN cnb_situac = 'T' THEN 'TRANSFERIDO'
END AS SITUACAO,
CASE
WHEN cnb_tiprec = '1' THEN 'SIM'
WHEN cnb_tiprec <> '1' THEN 'NAO'
END AS CNB_TIPREC,
cnb_propos,
ady_xmodal,
ady_xsegme,
aov_desseg,
AOM1.aom_descri AS D_XMODAL,
ady_xcodnv,
AOM2.aom_descri AS D_NIVREF
FROM cn9000 CN9
INNER JOIN sa1000 SA1
ON a1_filial = ' '
AND SA1.d_e_l_e_t_ = ' '
AND a1_cod = Substr(cn9_numero, 4, 6)
INNER JOIN cnb000 CNB
ON cnb_filial = ' '
AND CNB.d_e_l_e_t_ = ' '
AND cnb_contra = cn9_numero
AND cnb_revisa = cn9_revisa
INNER JOIN ady000 ADY
ON ady_filial = ' '
AND ADY.d_e_l_e_t_ = ' '
AND ady_codigo = a1_cod
AND ady_propos = cnb_propos
INNER JOIN aov000 AOV
ON ady_xsegme = aov_codseg
AND AOV.d_e_l_e_t_ = ' '
INNER JOIN SIGAMAT SM0 ON M0_CODFIL = CNB_UNINEG
AND SM0.D_E_L_E_T_ = ' '
LEFT JOIN aom000 AOM1
ON AOM1.aom_filial = ' '
AND AOM1.d_e_l_e_t_ = ' '
AND AOM1.aom_codagr = '000112'
AND AOM1.aom_codniv = ady_xmodal
LEFT JOIN aom000 AOM2
ON AOM2.aom_filial = ' '
AND AOM2.d_e_l_e_t_ = ' '
AND AOM2.aom_codagr = '000112'
AND AOM2.aom_codniv = ady_xcodnv
WHERE cn9_filial = ' '
AND CN9.d_e_l_e_t_ = ' '
AND cn9_situac = '05'
AND cn9_espctr = '2'
AND cn9_revatu = ' '
AND cnb_situac NOT IN ( 'C', 'S' );;
AUDSSY;SIGAJURI;05;20220519;;0;2;;0;;;;2;;;;1;2;0;;;1;;SELECT PW8_CODIGO,PW8_CLIENT,PW8_LOJA,PW8_DATA,PW8_HORA
 FROM PW8000;;
BEMATI;ATIVACAO CONTRATOS BEMACASH;69;20190326;;9;2;;0;;;;2;09;;;1;2;0;;;1;;SELECT A1_COD, A1_NOME, ' ' AS ADY_PROPOS
FROM SA1000
WHERE A1_FILIAL = ' ' AND A1_COD = ' ' AND D_E_L_E_T_ = ' ';;Formulario que permite a execução de metodo de ativação de contratos para o processo bemacash. Opção só deverá ser utilizado em casos em que ocorrer falha na ativação por algum problema na rotina
BEMCAN;CANCELAMENTO DE CONTRATOS BEMACASH;69;20180516;;6;2;;0;;;;2;10;;;1;2;0;;;1;;SELECT A1_COD, A1_NOME, ' ' AS ADY_PROPOS, '1' AS STATUS
FROM SA1000
WHERE A1_FILIAL = ' ' AND A1_COD = ' ' AND D_E_L_E_T_ = ' ';;Rotina para importação de arquivo CSV contendo lista com codigo do cliente e proposta a serem cancelados da carteira bemacash. Durante a importação os códigos informados são comparados com o contrato que geram legenda de quais linhas serao importadas. O resultado é gerado na tabela de de contratos de Adquiridas (PMX disponivel no modulo Faturamento -> Integracoes -> Ativ/Dev/Troca de Contratos)
BEMCPX;AGENDAMENTOS;69;20180516;;244;2;PMX;0;;;'PMX->PMX_CLIENT <> " "';2;11;;;1;2;0;;;1;;;;
BEMFAT;FALHA NA ATIVACAO DE PROPOSTAS BEMACASH;69;20180613;;10;2;;0;;;;2;12;;;1;2;0;;;1;;SELECT PMU_PRPEXT, ADZ_PROPOS, ADZ_PRODUT, ADZ_FOLDER, ADZ_ITEM, B1_DESC, PVORA.PN8_PVEXT
  FROM PMU000 PMU
  JOIN ADZ000 ADZ ON ADZ_FILIAL = PMU_FILIAL AND ADZ_PROPOS = PMU_PROPOS AND ADZ.D_E_L_E_T_ = ' '
  JOIN SB1000 SB1 ON B1_FILIAL = PMU_FILIAL AND B1_COD = ADZ_PRODUT AND SB1.D_E_L_E_T_ = ' '
  JOIN PN8000 PVORA ON PVORA.PN8_FILIAL = PMU.PMU_FILIAL AND PVORA.PN8_IDPMU = PMU.PMU_IDSEQ AND PVORA.PN8_SYSINP = '5' AND PVORA.PN8_PVEXT <> ' '
   AND PVORA.D_E_L_E_T_ = ' '
 WHERE PMU_FILIAL = ' ' AND PMU_CINTEG = '000001' AND PMU_STPRPE = 'C' AND PMU.D_E_L_E_T_ = ' '
   AND PMU_PROPOS IN (
SELECT PMX_PROPOS FROM PMX000 PMX WHERE PMX_FILIAL = ' ' AND PMX_CINTEG = '000001' AND PMX_TPTRAN = '1' AND (PMX_STATUS <> '4' AND PMX_STATUS <> '3' ) AND D_E_L_E_T_ = ' '
   AND NOT EXISTS(SELECT 1 FROM PMX000 PMX1 WHERE PMX1.PMX_FILIAL = PMX.PMX_FILIAL AND PMX1.PMX_CINTEG = PMX.PMX_CINTEG AND PMX1.PMX_TPTRAN = PMX.PMX_TPTRAN
                     AND PMX1.PMX_PROPOS = PMX.PMX_PROPOS AND PMX_STATUS = '4' AND D_E_L_E_T_ = ' ')    
   AND R_E_C_N_O_ = (SELECT MAX(R_E_C_N_O_) FROM PMX000 PMX1 WHERE PMX1.PMX_FILIAL = PMX.PMX_FILIAL AND PMX1.PMX_CINTEG = PMX.PMX_CINTEG 
                       AND PMX1.PMX_TPTRAN = PMX.PMX_TPTRAN AND PMX1.PMX_PROPOS = PMX.PMX_PROPOS AND (PMX_STATUS <> '4' AND PMX_STATUS <> '3')  AND D_E_L_E_T_ = ' ')   
   );;
BEMMKL;FALHAS DE INTEGRACAO DE LICENCAS - MARKETPLACE;69;20180611;;18;2;;0;;;;2;13;;;1;2;0;;;1;;SELECT PN7_DTINC, PN7_HRINC, PN7_DTINT, PN7_HRINT, PN7_CONTRA, CNB_PROPOS, A1_COD, A1_NOME, A1_CGC, A1_TEL, A1_EMAIL, 
       PN8_PVEXT, PN7_HRDLCK, PN7_PRODUT, B1_DESC, PN7_ACAO, PN7_STATUS, PN1E.R_E_C_N_O_ AS PN1_RECNO
  FROM PN7000 PN7
  JOIN SB1000 SB1 ON B1_FILIAL = PN7_FILIAL AND B1_COD = PN7_PRODUT AND SB1.D_E_L_E_T_ = ' '
  LEFT JOIN PN1000 PN1 ON PN1_FILIAL = PN7_FILIAL AND PN1_TPEXIM = 'E' AND PN1_ALIAS = 'PN7' AND PN1_RCNALS = PN7.R_E_C_N_O_
   AND PN1_STATUS IN ('1','2') AND PN1_MSEXP = ' ' AND PN1.D_E_L_E_T_ = ' '
  LEFT JOIN PN1000 PN1E ON PN1E.PN1_FILIAL = PN7_FILIAL AND PN1E.PN1_TPEXIM = 'E' AND PN1E.PN1_ALIAS = 'PN7' AND PN1E.PN1_RCNALS = PN7.R_E_C_N_O_
   AND PN1E.PN1_STATUS = '5' AND PN1E.D_E_L_E_T_ = ' '
   AND PN1E.R_E_C_N_O_ = (SELECT MAX(R_E_C_N_O_) FROM PN1000 PN1M WHERE PN1M.PN1_FILIAL = PN7_FILIAL AND PN1M.PN1_TPEXIM = 'E' 
                             AND PN1M.PN1_ALIAS = 'PN7' AND PN1M.PN1_RCNALS = PN7.R_E_C_N_O_ AND PN1M.PN1_STATUS = '5' 
							 AND PN1M.D_E_L_E_T_ = ' ') AND PN1.D_E_L_E_T_ = ' '
  JOIN CNB000 CNB ON CNB_FILIAL = PN7_FILIAL AND CNB_CONTRA = PN7_CONTRA AND CNB_REVISA = PN7_REVISA AND CNB_NUMERO = PN7_NUMERO
   AND CNB_ITEM = PN7_ITEM AND PN7_PRODUT = CNB_PRODUT AND CNB.D_E_L_E_T_ = ' '
  LEFT JOIN PMU000 PMU ON PMU.PMU_FILIAL = CNB_FILIAL AND PMU_PROPOS = CNB_PROPOS AND PMU.D_E_L_E_T_ = ' '
  LEFT JOIN SA1000 SA1 ON A1_FILIAL = PMU_FILIAL AND A1_COD = PMU_CLIENT AND SA1.D_E_L_E_T_ = ' '
  LEFT JOIN PN8000 PVMKT ON PVMKT.PN8_FILIAL = PMU.PMU_FILIAL AND PVMKT.PN8_IDPMU = PMU.PMU_IDSEQ AND PVMKT.PN8_SYSINP = '3' AND PVMKT.PN8_PVEXT <> ' ' 
   AND PVMKT.D_E_L_E_T_ = ' '
 WHERE PN7_FILIAL = ' ' AND PN7_CINTEG = '000001' AND PN7_STATUS = '1' AND PN7.D_E_L_E_T_ = ' '
 ORDER BY PN7_DTINT, PN7_HRINT, PN7_HRINC, PN7_HRINC;;Consulta para apresentacao de licencas com falha para integracao com MarketPlace
BEMMKP;PENDENCIAS DE INTEGRACAO MARKETPLACE - PEDIDOS;69;20180611;;85;2;;0;;;;2;14;;;1;2;0;;;1;;SELECT PMU_IDSEQ, PMU_PRPEXT, A1_COD, A1_NOME, A1_CGC, A1_TEL, A1_EMAIL, X5_DESCRI AS STATUS, PMU_DTPRPE, PMU_HRPRPE, ZRM_DTINC, ZRM_HRINC, 
       PMU_DTREPR, PMU_HRREPR, ADY_XANRIS, PMU_FORMA, PMU_VENDED, A3_NOME, PMU_OPORTU, PMU_DTOPOR, PMU_HROPOR, PMU_PROPOS, PMU_DTPROP, PMU_HRPROP, PMU_CONTRA, 
       PMU_DTCONT, PMU_HRCONT, PVORA.PN8_PVEXT AS PV_ORACLE, PVORA.PN8_DTINC AS PN8_DTORA, PVORA.PN8_HRINC AS PN8_HRORA, PMX_DTPROC, PMX_HRPROC, PMX_ULTVRC,
       PVMKT.R_E_C_N_O_ AS PN8_RECNO
  FROM PMU000 PMU
  JOIN SA1000 SA1 ON A1_FILIAL = PMU_FILIAL AND A1_COD = PMU_CLIENT AND SA1.D_E_L_E_T_ = ' '
  LEFT JOIN SA3000 SA3 ON A3_FILIAL = PMU_FILIAL AND A3_COD = PMU_VENDED AND SA3.D_E_L_E_T_ = ' '
  LEFT JOIN ADY000 ADY ON ADY_FILIAL = PMU_FILIAL AND ADY_PROPOS = PMU_PROPOS AND ADY.D_E_L_E_T_ = ' '
  LEFT JOIN ZRM000 ZRM ON ZRM_FILIAL = PMU_FILIAL AND ZRM_IDPROC = PMU_IDPROC AND ZRM_STATUS = '1' AND ZRM.D_E_L_E_T_ = ' '
  LEFT JOIN ZXS000 ZXS ON ZXS_FILIAL = PMU_FILIAL AND ZXS_IDPROC = PMU_IDPROC AND ZXS_DTENV <> ' ' AND ZXS.D_E_L_E_T_ = ' '
  LEFT JOIN PMX000 PMX ON PMX_FILIAL = PMU_FILIAL AND PMX_CINTEG = PMU.PMU_CINTEG AND PMX_PROPOS = PMU.PMU_PROPOS 
   AND PMX_CONTRA = PMU.PMU_CONTRA AND PMX_STATUS = '4' AND PMX.D_E_L_E_T_ = ' '
  JOIN SX5000 SX5 ON SX5.X5_TABELA = 'ZL' AND X5_CHAVE = PMU_STPRPE AND SX5.D_E_L_E_T_ = ' '
  JOIN PN8000 PVMKT ON PVMKT.PN8_FILIAL = PMU.PMU_FILIAL AND PVMKT.PN8_IDPMU = PMU.PMU_IDSEQ AND PVMKT.PN8_SYSINP = '3' AND PVMKT.PN8_PVEXT = ' ' 
   AND PVMKT.D_E_L_E_T_ = ' '
  LEFT JOIN PN8000 PVORA ON PVORA.PN8_FILIAL = PMU.PMU_FILIAL AND PVORA.PN8_IDPMU = PMU.PMU_IDSEQ AND PVORA.PN8_SYSINP = '5' AND PVORA.PN8_PVEXT <> ' '
   AND PVORA.D_E_L_E_T_ = ' '
 WHERE PMU_FILIAL = ' ' AND PMU_CINTEG = '000001' AND PMU.D_E_L_E_T_ = ' ';;Apresentacao de pedidos com falha para integração entre Protheus e MarketPlace
CAD001;CONSULTA CADASTROS RD0 - CFG;06;20190403;;0;2;;0;;;;2;15;;;1;2;0;;;1;;SELECT 
RD0_CODIGO,
RD0_NOME,
USR_NOME CFG_NOME,
RD0_EMAIL,
USR_EMAIL CFG_EMAIL,
RD0_USER,
USR_ID CFG_ID,
RD0_MSBLQL,
USR_MSBLQL CFG_BLQ
FROM RD0000 RD0

JOIN SYS_USR SYS ON USR_ID = RD0_USER
AND SYS.D_E_L_E_T_ = ' '

WHERE RD0.D_E_L_E_T_ = ' '
AND RD0_NOME LIKE '@NOME@%'

ORDER BY RD0_NOME;;
CAD002;EXTRAÇÃO AC8 DE FORNECEDORES;97;20200622;;3;2;;0;;;;2;16;;;1;2;0;;;1;;SELECT DISTINCT * FROM AC8000 AC8

INNER JOIN SU5000 SU5 ON

AC8.AC8_CODCON = SU5.U5_CODCONT
AND SU5.D_E_L_E_T_ = ' '

WHERE AC8.AC8_ENTIDA = 'SA2'
AND AC8.D_E_L_E_T_ = ' ';;
CADZQK;CADASTRO ZQK;69;20200505;;39;2;;0;;;;2;17;;;1;2;0;;;1;;SELECT * FROM ZQK000 ZQK
WHERE ZQK.ZQK_CODZQJ BETWEEN @I_CODIGO@ AND @F_CODIGO@
AND ZQK.D_E_L_E_T_ = ' ';;Geração dos dados da tabela ZQK
CANCEL;RELATÓRIO DE CANCELAMENTOS;69;20180611;;403;2;;0;;;;2;18;;;1;2;0;;;1;;SELECT DISTINCT
PH3_CONTRA,
PH3_REVISA,
PKV_NFIL,
A1_COD,
A1_NOME,
AOV_DESSEG,
CASE
WHEN A1_XCLIVIP = '1' THEN 'VIP'
WHEN A1_XCLIVIP = '2' THEN 'PADRAO'
WHEN A1_XCLIVIP = '3' THEN 'GOVERNO'
WHEN A1_XCLIVIP = '4' THEN 'PRIVATE'
WHEN A1_XCLIVIP = '5' THEN 'GEN'
WHEN A1_XCLIVIP = '6' THEN 'TFS'
WHEN A1_XCLIVIP = '7' THEN 'VBP'
WHEN A1_XCLIVIP = '8' THEN 'PBP'
WHEN A1_XCLIVIP = '9' THEN 'FRAN'
WHEN A1_XCLIVIP = 'P' THEN 'PARCIAL'
WHEN A1_XCLIVIP = 'G' THEN 'GARE'
WHEN A1_XCLIVIP = 'U' THEN 'UN PR'
WHEN A1_XCLIVIP = 'F' THEN 'MPN FLY01'
WHEN A1_XCLIVIP = 'T' THEN 'TQTVD'
WHEN A1_XCLIVIP = 'B' THEN 'MPN BEMA'
WHEN A1_XCLIVIP = 'V' THEN 'VIP ADV'
END AS A1_XCLIVIP,
A1_VEND,
A3_NOME,
A1_CODMEMB,
ADK_NOME,
PH3_PROPOS,
PH3_NUMERO,
PH3_ITEM,
BM_GRUPO,
BM_DESC,
CNB_QTDLIC,
BM_XLINREC,
AOM_DESCRI DES_LINREC,
PH3_PRODUT,
B1_DESC,
PH3_QUANT,
CASE 
WHEN PH3_SITUAC = 'A' THEN 'ATIVO'
WHEN PH3_SITUAC = 'C' THEN 'CANCELADO'
WHEN PH3_SITUAC = 'G' THEN 'GRATUITO'
WHEN PH3_SITUAC = 'M' THEN 'MANUAL'
WHEN PH3_SITUAC = 'P' THEN 'PENDENTE'
WHEN PH3_SITUAC = 'S' THEN 'SUSPENSO'
WHEN PH3_SITUAC = 'O' THEN 'TROCADO'
WHEN PH3_SITUAC = 'T' THEN 'TRANSRERIDO'
END AS PH3_SITUAC,
PH3_QTDCAN,
CNB_VLUNIT,
CNB_VLTOT,
CNB_CONDIC,
PH3_MOTBC,
SX5.X5_DESCRI DESC_MOT,
REPLACE(REPLACE(UTL_RAW.CAST_TO_VARCHAR2(DBMS_LOB.SUBSTR(PH3_OBS, 2000,1)), CHR(13), '. '), CHR(10), '') PH3_OBS,
PHX_DESCRI,
PHY_MOTIVO,
PHY_REVISA,
PH3_DATA,
PH3_CMPSOL,
PH3_CMPCAN,
PH3_PERIOD,
SX5UA.X5_DESCRI PERIOD,
PH3_CHAMAD, 
PH3_PRONEG,
CASE
WHEN PH3_STATUS = 'P' THEN 'PROGRAMADO'
WHEN PH3_STATUS = 'D' THEN 'DESPROGR'
WHEN PH3_STATUS = 'C' THEN 'CANCELADO'
WHEN PH3_STATUS = 'R' THEN 'REATIVADO'
END AS PH3_STATUS,
BM_XGRPREC

FROM CN9000 CN9

INNER JOIN CNA000 CNA
ON CNA.D_E_L_E_T_ = ' '
AND CNA_FILIAL = ' '
AND CNA_CONTRA = CN9_NUMERO
AND CNA_REVISA = CN9_REVISA


INNER JOIN CNB000 CNB
ON CNB.D_E_L_E_T_ = ' '
AND CNB_FILIAL = ' '
AND CNB_CONTRA = CN9_NUMERO
AND CNB_REVISA = CN9_REVISA
AND CNB_NUMERO = CNA_NUMERO


INNER JOIN PH3000 PH3
ON PH3.D_E_L_E_T_ = ' '
AND PH3_FILIAL = ' '
AND PH3_CONTRA = CN9_NUMERO
AND PH3_REVISA = CN9_REVISA
AND PH3_NUMERO = CNB_NUMERO
AND PH3_ITEM = CNB_ITEM
AND PH3_STATUS <> 'D'


INNER JOIN SA1000 SA1
ON SA1.D_E_L_E_T_ = ' '
AND A1_FILIAL = ' '
AND A1_COD = CNA_CLIENT
AND A1_LOJA = CNA_LOJACL

LEFT JOIN AOV000 AOV
ON AOV.D_E_L_E_T_ = ' '
AND AOV_FILIAL = ' '
AND AOV_CODSEG = A1_CODSEG

INNER JOIN SB1000 SB1
ON SB1.D_E_L_E_T_ = ' '
AND B1_FILIAL = ' '
AND B1_COD = CNB_PRODUT

LEFT JOIN SBM000 SBM
ON SBM.D_E_L_E_T_ = ' '
AND BM_FILIAL = ' '
AND BM_GRUPO = B1_GRUPO

LEFT JOIN AOM000 AOM
ON AOM.D_E_L_E_T_ = ' '
AND AOM_FILIAL = ' '
AND AOM_CODAGR = '000001'
AND AOM_CODNIV = BM_XLINREC


LEFT JOIN SX5000 SX5
ON SX5.D_E_L_E_T_ = ' '
AND SX5.X5_FILIAL = ' '
AND SX5.X5_TABELA = '_C'
AND SX5.X5_CHAVE = PH3_MOTBC

LEFT JOIN SX5000 SX5UA
ON SX5UA.D_E_L_E_T_ = ' '
AND SX5UA.X5_FILIAL = ' '
AND SX5UA.X5_TABELA = 'UA'
AND SX5UA.X5_CHAVE = PH3_MOTBC

LEFT JOIN PHY000 PHY
ON PHY.D_E_L_E_T_ = ' '
AND PHY_FILIAL = ' '
AND PHY_CONTRA = CN9_NUMERO
AND PHY_REVISA = CN9_REVISA
AND PHY_NUMNEG = PH3_NUMNEG
AND PHY_MOTIVO = PH3_MOTBC
AND PHY_TIPO = 'C'
AND PHY_FLGMOT = '1'

LEFT JOIN PHX000 PHX
ON PHX.D_E_L_E_T_ = ' '
AND PHX_FILIAL = ' '
AND PHX_MOTIVO = PHY_MOTIVO
AND PHX_SUBMOT = PHY_SUBMOT
AND PHX_TIPO = PHY_TIPO

LEFT JOIN PKV000 PKV ON PKV_FILIAL = ' ' 
AND PKV.D_E_L_E_T_ = ' ' 
AND PKV_CODIGO = '00'
AND PKV_CODFIL = PH3_UNINEG

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' 
AND SA3.D_E_L_E_T_ = ' ' 
AND A3_COD = A1_VEND

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = A1_CODMEMB

WHERE CN9.D_E_L_E_T_ = ' '
AND CN9_FILIAL = ' '
AND CN9_ESPCTR = '2'
AND CN9_SITUAC = '05'
AND CN9_TPCTO = '013'
AND PH3_DATA BETWEEN @I_PH3_DATA@ AND @F_PH3_DATA@
AND SUBSTR(PH3_CMPCAN,4,4)||SUBSTR(PH3_CMPCAN,1,2) BETWEEN <ADVPL>"'" + RIGHT(_I_COMP,4) + LEFT(_I_COMP,2) + "'"</ADVPL> 
AND <ADVPL>"'" + RIGHT(_F_COMP,4) + LEFT(_F_COMP,2)+ "'"</ADVPL>;;
CFGCSV;IMPORTAÇÃO DE CSV - CHAPA|CPF USERS;06;20181024;;1;2;;0;;;;2;19;;;1;2;0;;;1;;SELECT * FROM THIAGO TH

WHERE TH.D_E_L_E_T_ = ' ';;
CIABAI;BAIXA CIASHOP;05;20190430;;24;2;;0;;;;2;20;;;1;2;0;;;2;;SELECT 
	E5_PREFIXO
	,E5_NUMERO
	,E5_PARCELA
	,E5_DATA
                          ,E5_VENCTO
	,E5_VALOR
	,E5_TIPODOC
	,E5_HISTOR
	,A1_CGC
FROM 
	SE5000 SE5
		INNER JOIN 
			SA1000 SA1
		ON 
			A1_FILIAL = ' '
			AND A1_COD = E5_CLIFOR
			AND A1_LOJA = E5_LOJA
			AND SA1.D_E_L_E_T_ = ' '
WHERE 
	E5_FILIAL = '01101000100'
	AND SE5.E5_PREFIXO IN ('CSH', 'UNE' )
	AND SE5.E5_NUMERO<>' '
	AND SE5.E5_TIPO='NF' 
	AND SE5.E5_RECPAG='R' 
	AND SE5.E5_SITUACA <>'C' 
	AND SE5.E5_MOTBX <> 'FAT'
	AND SE5.E5_MOTBX <> 'LIQ'
                           AND SE5.E5_VENCTO BETWEEN @VENCTO_DE@ AND @VENCTO_ATE@
                           AND SE5.E5_DATA BETWEEN @BAIXA_DE@ AND @BAIXA_ATE@
	AND SE5.D_E_L_E_T_=' '
	AND NOT EXISTS (SELECT A.E5_NUMERO
						FROM SE5000 A 
					WHERE  A.E5_FILIAL = SE5.E5_FILIAL
							AND A.E5_NATUREZ=SE5.E5_NATUREZ 
							AND A.E5_PREFIXO=SE5.E5_PREFIXO 
							AND A.E5_NUMERO=SE5.E5_NUMERO 
							AND A.E5_PARCELA=SE5.E5_PARCELA 
							AND A.E5_TIPO=SE5.E5_TIPO 
							AND A.E5_CLIFOR=SE5.E5_CLIFOR 
							AND A.E5_LOJA=SE5.E5_LOJA 
							AND A.E5_SEQ=SE5.E5_SEQ 
							AND A.E5_TIPODOC='ES' 
							AND A.E5_RECPAG<>'R' 
							AND A.D_E_L_E_T_=' ')
ORDER BY 4 DESC, 1,2,3;;
CIABOL;BOLETO CIASHOP;05;20190429;;21;2;;0;;;;2;21;;;1;2;0;;;2;;SELECT
	'PAGAVEL PREFERENCIALMENTE EM QUALQUER AGENCIA ITAU' local_pgto
	,CASE WHEN PDR_PARCEL <> ' ' THEN PDR_PARCEL ELSE '1' END nr_parcela
	,SUBSTR(E1_VENCREA,1,4)||'/'||SUBSTR(E1_VENCREA,5,2)||'/'||SUBSTR(E1_VENCREA,7,2) A
	,'CIASHOP SOLUCOES P/ COMERCIO ELETRONICO' cedente
	,'2938/0023434-7' B
	,SUBSTR(E1_EMISSAO,1,4)||'/'||SUBSTR(E1_EMISSAO,5,2)||'/'||SUBSTR(E1_EMISSAO,7,2) C
	,PDR_NUMDOC	D
	,PDR_ESPDOC	E
	,PDR_ACEITE	F
	,PDR_PROCDO	G
	,PDR_NOSSON	H
	,PDR_CARTEI	I
	,PDR_ESPECI	moeda
	,E1_VALOR	J
	,'(Todas informacoes deste bloqueto sao de exclusiva responsabilidade do cedente)' K
	,' ' L
	,RTRIM(LTRIM(PDR_INST05)) corpo
	,substr(A1_NOME,1,40)	sac_nome
	,substr(A1_END,1,40) 	M
	,A1_CEP					sac_cep
	,A1_MUN					sac_cidade
	,A1_EST					sac_estado
	,A1_CGC					sac_cgccpf
	,E1_NUM					id_titli
	,PDR_CODBAR				cd_barra
	,Replace(PDR_LINDIG,'  ', ' ')	SAS
	,E1_CLIENTE
	,PMV_IDESTR
FROM
	SE1000 E
		INNER JOIN
			PDR000 P
		ON
			PDR_FILIAL = E1_FILIAL
			AND
			PDR_PREFIX = E1_PREFIXO
			AND
			PDR_NUM = E1_NUM
			AND
			PDR_PARCEL = E1_PARCELA
			AND
			PDR_TIPO = E1_TIPO
			AND
			PDR_CLIENT = E1_CLIENTE
			AND
			PDR_LOJA = E1_LOJA
			AND
			PDR_STATUS = '1'
			AND
			P.D_E_L_E_T_ = ' '
		INNER JOIN
			SA1000 A
		ON
			A1_FILIAL = ' '
			AND
			A1_COD = E1_CLIENTE
			AND
			A1_LOJA = E1_LOJA
			AND
			A.D_E_L_E_T_ = ' '
		LEFT JOIN
			PMV000 P
		ON 
			PMV_FILIAL = ' '
		AND	PMV_CINTEG = '000009'
		AND	PMV_ALIAS = 'SA1'
		AND	PMV_CHVFUL = E1_CLIENTE||E1_LOJA
		AND	P.D_E_L_E_T_ = ' '		
WHERE
	E1_FILIAL = '01101000100'
	AND
	E1_PREFIXO = 'UNE'
	AND
	E1_NUM BETWEEN @TITULO_DE@ AND @TITULO_ATE@
	AND
	E1_TIPO = 'NF'
	AND
	E.D_E_L_E_T_ = ' '
ORDER BY 
	E1_NUM;;
CIAFAT;FATURAMENTO CIASHOP;05;20190430;;24;2;;0;;;;2;22;;;1;2;0;;;2;;SELECT
	' '		A
	,'1' 		B
	,'F' 		nr_serie
	,D2_CLIENTE	
	,D2_COD 	
	,D2_QUANT	
	,D2_TOTAL	vl_total
	,SUBSTR(D2_EMISSAO,1,4)||'/'||SUBSTR(D2_EMISSAO,5,2)||'/'||SUBSTR(D2_EMISSAO,7,2) D
	,SUBSTR(E1_VENCREA,1,4)||'/'||SUBSTR(E1_VENCREA,5,2)||'/'||SUBSTR(E1_VENCREA,7,2) E
	,D2_DOC		
	,'NULL'		observacao
	,SUBSTR(D2_EMISSAO,1,4)||'/'||SUBSTR(D2_EMISSAO,5,2)||'/'||SUBSTR(D2_EMISSAO,7,2) proposta
	,'3'			F
	,'1'			G
	,D2_TOTAL 		
	,' ' 			html
	,E1_PARCELA		
	,' '			J
	,PMV_IDESTR
	,A1_CGC
FROM
	SD2000 D
		INNER JOIN
			SE1000 E
		ON
			D2_FILIAL = E1_FILIAL
			AND
			D2_CLIENTE = E1_CLIENTE
			AND
			D2_LOJA = E1_LOJA
			AND
			D2_SERIE = E1_PREFIXO
			AND
			D2_DOC = E1_NUM
			AND
			E1_TIPO = 'NF'
			AND
			E.D_E_L_E_T_ = ' '
		INNER JOIN 
			SA1000 A
		ON 
			A1_FILIAL = ' '
			AND 
			A1_COD = E1_CLIENTE
			AND 
			A1_LOJA = E1_LOJA
			AND 
			A.D_E_L_E_T_ = ' '	
		LEFT JOIN
			PMV000 P
		ON 
			PMV_FILIAL = ' '
		AND	PMV_CINTEG = '000009'
		AND	PMV_ALIAS = 'SA1'
		AND	PMV_CHVFUL = E1_CLIENTE||E1_LOJA
		AND	P.D_E_L_E_T_ = ' '	
WHERE
	D2_FILIAL = '01101000100'
	AND
	D2_SERIE = 'UNE'
	AND
	D2_DOC BETWEEN @NOTA_I@ AND @NOTA_F@
	AND
	D.D_E_L_E_T_ = ' '	;;
CIANOT;NOTA CIASHOP;05;20190430;;14;2;;0;;;;2;23;;;1;2;0;;;2;;SELECT
	'1'		cd_empresa
	,'F'		nr_serie
	,F2_DOC		nr_nota
	,F2_CLIENTE	cd_cadast
	,'1'	        cd_origem
	,'0'	        cd_tipoped
	,'1'	        cd_deposit
	,SUBSTR(F2_EMISSAO,1,4)||'/'||SUBSTR(F2_EMISSAO,5,2)||'/'||SUBSTR(F2_EMISSAO,7,2) dt_emissao
	,'8000'	        cd_cfop
	,'1'	        cd_cfopvar
	,'0'		cd_tabpre
	,'0'		cd_condic
	,'0'		cd_comiss
	,'1'		cd_frete
	,'0'		cd_transp
	,'0'		cd_redesp
	,'0'		nr_end_en
	,'0'		nr_end_cb
	,'0'		pr_comis
	,'0'		pr_desc1
	,'0'		pr_desc2
	,'0'		pr_desc3
	,'0'		vl_descon
	,'0'		vl_desc1
	,'0'		vl_desc2
	,'0'		vl_desc3
	,'0'		vl_comiss
	,'0'		vl_frete
	,'0'		vl_despes
	,'0'		vl_mercad
	,F2_VALBRUT     vl_servic
	,F2_VALBRUT     vl_nota
	,'0'		cd_carim1
	,'0'		cd_carim2
	,'0'		qt_volume
	,' '		esp_vol
	,'0'		peso_bruto
	,'0'		peso_liqui
	,F2_SERIE	V
	,F2_DOC 	X
	,'0'		Z
	,'NULL'		W
	,'1'		cd_usuario
	,'A'	        situacao
	,'NULL'	        obs
	,'NULL'	        WWW
	,SUBSTR(F2_EMINFE,1,4)||'/'||SUBSTR(F2_EMINFE,5,2)||'/'||SUBSTR(F2_EMINFE,7,2) processado
	,F2_NFELETR			nr_nfem
	,F2_CODNFE			AAAA
	,'04364470000195' 	cd_nfem
	,SUBSTR(F2_EMINFE,1,4)||'/'||SUBSTR(F2_EMINFE,5,2)||'/'||SUBSTR(F2_EMINFE,7,2)||' '|| F2_HORNFE data_email
	,PMV_IDESTR
	,A1_CGC
FROM
	SF2000 F
INNER JOIN SA1000 A
ON A1_FILIAL = ' '
AND A1_COD = F2_CLIENTE
AND A1_LOJA = F2_LOJA
AND A.D_E_L_E_T_ = ' '	
LEFT JOIN
PMV000 P
ON PMV_FILIAL = ' '
AND PMV_CINTEG = '000009'
AND PMV_ALIAS = 'SA1'
AND PMV_CHVFUL = F2_CLIENTE||F2_LOJA
AND P.D_E_L_E_T_ = ' '
WHERE
	F2_FILIAL = '01101000100'
	AND
	F2_SERIE = 'UNE'
	AND
	F2_CLIENTE BETWEEN @CLIENTE_DE@ AND @CLIENTE_ATE@
                           AND
	F2_DOC BETWEEN @NOTA_DE@ AND @NOTA_ATE@
	AND
	F.D_E_L_E_T_ = ' '
ORDER BY 3;;
CIATIT;TITULO CIASHOP;05;20190429;;25;2;;0;;;;2;24;;;1;2;0;;;2;;SELECT 
'1' 		cd_empresa,
' ' 		id_titulo,
E1_PREFIXO 	nr_serie,
E1_NUM 		nr_titulo,
E1_PARCELA 	nr_parcela,
E1_CLIENTE      cd_cadast,
'341' 		cd_portado ,
'100' 		cd_operaca ,
'1' 		qt_parcela ,
SUBSTR(E1_EMISSAO, 1, 4)||'/'||SUBSTR(E1_EMISSAO, 5, 2)||'/'||SUBSTR(E1_EMISSAO, 7, 2) dt_lanca,
SUBSTR(E1_VENCREA, 1, 4)||'/'||SUBSTR(E1_VENCREA, 5, 2)||'/'||SUBSTR(E1_VENCREA, 7, 2) dt_vencto,
'NULL' 		dt_liquida ,
E1_DESCONT 	vl_desc,
E1_VALOR 	vl_titulo ,
'NULL' 		dt_prot ,
'1.01.03' 	cd_plano,
' ' 		cd_ccusto ,
ROUND((E1_VALOR*0.02),2) 		vl_multa ,
ROUND(((E1_VALOR*0.033)/100),2)	vl_juros ,
'A' situacao ,
'S' fluxo ,
' ' obs ,
A1_CGC cnpj,
PMV_IDESTR depara
FROM SE1000 E
INNER JOIN SA1000 A
ON A1_FILIAL = ' '
AND A1_COD = E1_CLIENTE
AND A1_LOJA = E1_LOJA
AND A.D_E_L_E_T_ = ' '
LEFT JOIN
PMV000 P
ON PMV_FILIAL = ' '
AND PMV_CINTEG = '000009'
AND PMV_ALIAS = 'SA1'
AND PMV_CHVFUL = E1_CLIENTE||E1_LOJA
AND P.D_E_L_E_T_ = ' '
WHERE E1_FILIAL = '01101000100'
  AND E1_PREFIXO = 'UNE'
  AND E1_TIPO = 'NF' 
  AND E1_NUM BETWEEN @TITULO_DE@ AND @TITULO_ATE@
  AND E1_EMISSAO BETWEEN @EMISSAO_DE@ AND @EMISSAO_ATE@
  AND E.D_E_L_E_T_ = ' '
ORDER BY E1_NUM;;
CNABHJ;CONSULTA PROCESSAMENTO CNAB;06;20180608;;331;2;;0;;;;2;25;;;1;2;0;;;1;;SELECT 

C.FI0_FILIAL,
C.FI0_DTPRC,
C.FI0_ARQ,
C.FI0_CTA,
C.FI0_LASTLN,
C.E5_VALOR FI0_TOTBX,
C.FI0_IDARQ,
C.E5_FILIAL,
C.E5_DATA,
C.E5_HISTOR,
C.E5_VALOR,
COUNT(C.FI1_IDTIT) ID

FROM (SELECT 
FI0.FI0_FILIAL,
FI0.FI0_DTPRC,
FI0.FI0_ARQ,
FI0.FI0_CTA,
FI0_LASTLN,
FI0_TOTBX,
FI0.FI0_IDARQ,
SE5.E5_FILIAL,
SE5.E5_DATA,
SE5.E5_HISTOR,
SE5.E5_VALOR,
FI1_IDTIT

FROM FI0000 FI0

LEFT JOIN SE5000 SE5 ON E5_FILIAL = FI0_FILIAL
AND E5_DATA = @DT_DIA@
AND E5_HISTOR LIKE '%CNAB.%'
AND (E5_ORIGEM = 'FINA205' OR E5_ORIGEM='FINA305T')
AND SE5.D_E_L_E_T_ = ' '

LEFT JOIN (SELECT FI1_FILIAL, FI1_IDARQ, FI1_IDTIT, SUM(1) QTD FROM FI1000 FI1 WHERE FI1.D_E_L_E_T_ = ' '
GROUP BY FI1_FILIAL, FI1_IDARQ, FI1_IDTIT) T 
ON T.FI1_FILIAL = FI0_FILIAL 
AND T.FI1_IDARQ = FI0_IDARQ


WHERE FI0_DTPRC >= @INI_MES@
AND FI0_ARQ = @ARQUIVO@
AND FI0.D_E_L_E_T_ = ' '

GROUP BY FI0_FILIAL, FI0_DTPRC, FI0_ARQ, FI0_CTA,FI0_LASTLN, FI0_TOTBX, FI0_IDARQ, E5_FILIAL, E5_DATA, E5_HISTOR, E5_VALOR, FI1_IDTIT) C

GROUP BY C.FI0_FILIAL,
C.FI0_DTPRC,
C.FI0_ARQ,
C.FI0_CTA,
C.FI0_LASTLN,
C.FI0_TOTBX,
C.FI0_IDARQ,
C.E5_FILIAL,
C.E5_DATA,
C.E5_HISTOR,
C.E5_VALOR
;;
COM001;RELATORIO DE PEDIDOS DE COMPRA APROVADOS;02;20180814;;819;2;;0;;;;2;26;;;1;2;0;;;1;;SELECT DISTINCT 
C7_FILIAL, 
M0_FILIAL,
C7_PRODUTO, 
C7_DESCRI, 
C7_QUJE  ,
C7_UM, 
C7_PRECO, 
C7_TOTAL,
TOT_CONV,
C7_CC,
CTT_DESC01,
C7_CONTA,
CT1_DESC01,
C7_ITEMCTA,
CTD_DESC01,
C7_CLVL,
CTH_DESC01,
C7_XTOPER,
X5_DESCRI,
C7_DATPRF,
C7_NUMSC,
C7_ITEMSC,
ULTAPRSC,
C7_COND,
E4_DESCRI,
C7_EMISSAO,
MES,
C7_NUM, 
C7_ITEM, 
ULTAPRPC,
C7_FORNECE,
C7_LOJA,
A2_NOME,
C7_NUMCOT,
C1_QUANT,
C7_TXMOEDA,
C7_MOEDA,
C7_RATEIO,
C7_TIPCOM,
C7_TPPED,
C7_USER, 
C7_OBS,
C7_XJUSTIF,
USR_NOME,
CODAPR,
NIVEL,
APROV

FROM

( SELECT DISTINCT
C7_FILIAL, 
M0_FILIAL,
C7_PRODUTO, 
C7_DESCRI, 
C7_QUANT, 
C7_QUJE  , 
C7_UM, 
C7_PRECO, 
C7_TOTAL,
CASE WHEN C7_MOEDA <> 1 AND C7_TXMOEDA <> 0 THEN C7_TOTAL * C7_TXMOEDA 
     WHEN C7_MOEDA = 1 THEN C7_TOTAL 
ELSE 0 END TOT_CONV,
C7_CC,
CTT_DESC01,
C7_CONTA,
CT1_DESC01,
C7_ITEMCTA,
CTD_DESC01,
C7_CLVL,
CTH_DESC01,
C7_XTOPER,
X5_DESCRI,
C7_DATPRF,
C7_NUMSC,
C7_ITEMSC,
SCRA.CR_DATALIB AS ULTAPRSC,
C7_COND,
E4_DESCRI,
C7_EMISSAO, 
CASE WHEN SUBSTR(C7_EMISSAO,5,2) = '01' THEN 'Janeiro' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '02' THEN 'Fevereiro' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '03' THEN 'Março' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '04' THEN 'Abril' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '05' THEN 'Maio' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '06' THEN 'Junho' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '07' THEN 'Julho' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '08' THEN 'Agosto' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '09' THEN 'Setembro' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '10' THEN 'Outubro' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '11' THEN 'Novembro' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '12' THEN 'Dezembro' 
ELSE ' ' END MES,
C7_NUM, 
C7_ITEM, 
SCR.CR_DATALIB AS ULTAPRPC,
C7_FORNECE,
C7_LOJA,
A2_NOME,
C7_NUMCOT,
C1_QUANT,
C7_TXMOEDA,
C7_MOEDA,
CASE WHEN C7_RATEIO='1' THEN '1=Sim' 
	 WHEN C7_RATEIO='2' THEN '2=Nao'
ELSE ' ' END C7_RATEIO,
C7_TIPCOM,
CASE WHEN C7_TPPED = '1' THEN '1=Auto'
     WHEN C7_TPPED = '2' THEN '2=Cot'
	 WHEN C7_TPPED = '3' THEN '3=Reg'
	 WHEN C7_TPPED = '4' THEN '4=Recor'
	 WHEN C7_TPPED = '5' THEN '5=Contr'
	 WHEN C7_TPPED = '6' THEN '6=Comis'
	 WHEN C7_TPPED = '7' THEN '7=Rev'
	 WHEN C7_TPPED = '8' THEN '8=SI'
	 WHEN C7_TPPED = '9' THEN '9=HE'
	 WHEN C7_TPPED = 'A' THEN 'A=Cpr CTR/COT'
	 WHEN C7_TPPED = 'B' THEN 'B=Cpr Confi'
	 WHEN C7_TPPED = 'C' THEN 'C=Cpr Frota'
	 WHEN C7_TPPED = 'D' THEN 'D=Cpr Direta'
	 WHEN C7_TPPED = 'E' THEN 'E=Cpr TI/Cot'
ELSE ' ' END C7_TPPED,
C7_USER, 
C7_OBS,
C7_XJUSTIF,
USR.USR_NOME ,
SCRC.CR_USER CODAPR,
SCRC.CR_NIVEL NIVEL,
USRA.USR_NOME AS APROV

  FROM <ADVPL>RetSqlName("SC7")</ADVPL> SC7

 JOIN <ADVPL>RetSqlName("SA2")</ADVPL> SA2 ON A2_FILIAL = ' ' AND A2_COD = C7_FORNECE AND A2_LOJA = C7_LOJA AND SA2.D_E_L_E_T_=' '
  
LEFT JOIN <ADVPL>RetSqlName("SCR")</ADVPL> SCR ON SCR.CR_FILIAL = C7_FILIAL AND SCR.CR_NUM = C7_NUM AND SCR.D_E_L_E_T_ = ' '
LEFT JOIN <ADVPL>RetSqlName("CT1")</ADVPL> CT1 ON CT1_FILIAL = ' ' AND CT1_CONTA = C7_CONTA AND CT1.D_E_L_E_T_=' '
LEFT JOIN <ADVPL>RetSqlName("CTT")</ADVPL> CTT ON CTT_FILIAL = ' ' AND CTT_CUSTO = C7_CC AND CTT.D_E_L_E_T_=' '
LEFT JOIN <ADVPL>RetSqlName("CTD")</ADVPL> CTD ON CTD_FILIAL = ' ' AND CTD_ITEM = C7_ITEMCTA AND CTD.D_E_L_E_T_=' '
LEFT JOIN <ADVPL>RetSqlName("CTH")</ADVPL> CTH ON CTH_FILIAL = ' ' AND CTH_CLVL = C7_CLVL AND CTH.D_E_L_E_T_=' '
LEFT JOIN <ADVPL>RetSqlName("SX5")</ADVPL> SX5 ON X5_FILIAL = ' ' AND X5_TABELA = 'ZV' AND X5_CHAVE = C7_XTOPER AND SX5.D_E_L_E_T_=' '
LEFT JOIN <ADVPL>RetSqlName("SE4")</ADVPL> SE4 ON E4_FILIAL = ' ' AND E4_CODIGO = C7_COND AND SE4.D_E_L_E_T_ = ' '
LEFT JOIN <ADVPL>RetSqlName("SC1")</ADVPL> SC1 ON C1_FILIAL = C7_FILIAL AND C1_NUM = C7_NUMSC AND C1_ITEM = C7_ITEMSC AND SC1.D_E_L_E_T_ = ' '
LEFT JOIN <ADVPL>RetSqlName("SCR")</ADVPL> SCRA ON SCRA.CR_FILIAL = C1_FILIAL  AND SCRA.CR_NUM = C1_NUM AND C1_APROV = 'L' AND SCRA.CR_TIPO = 'SC' AND SCRA.D_E_L_E_T_ = ' ' 
						 AND SCRA.CR_DATALIB = (SELECT MAX(SCRB.CR_DATALIB) 
												  FROM <ADVPL>RetSqlName("SCR")</ADVPL> SCRB 
												 WHERE SCRB.CR_FILIAL = C7_FILIAL AND SCRB.CR_DATALIB <> ' ' AND SCRB.CR_NUM = C1_NUM AND SCRB.D_E_L_E_T_=' ')
						 AND SCRA.CR_NIVEL = ( SELECT MAX(SCRN.CR_NIVEL) 
												 FROM <ADVPL>RetSqlName("SCR")</ADVPL> SCRN 
												WHERE SCRN.CR_FILIAL = SCRA.CR_FILIAL 
													  AND SCRN.CR_DATALIB <> ' ' 
													  AND SCRN.CR_NUM = SCRA.CR_NUM 
													  AND SCRN.CR_TIPO = SCRA.CR_TIPO
													  AND SCRN.D_E_L_E_T_ = ' ')
LEFT JOIN <ADVPL>RetSqlName("SCR")</ADVPL> SCRC ON SCRC.CR_FILIAL = C7_FILIAL AND SCRC.CR_NUM = C7_NUM AND SCRC.D_E_L_E_T_ = ' '	
												   AND SCRC.CR_NIVEL = ( SELECT MAX(SCRN.CR_NIVEL) 
												 FROM <ADVPL>RetSqlName("SCR")</ADVPL> SCRN 
												WHERE SCRN.CR_FILIAL = SCRC.CR_FILIAL 
													  AND SCRN.CR_DATALIB <> ' ' 
													  AND SCRN.CR_NUM = SCRC.CR_NUM 
													  AND SCRN.CR_TIPO = SCRC.CR_TIPO
													  AND SCRN.D_E_L_E_T_ = ' ')
LEFT JOIN SYS_USR USR ON USR_ID = C7_USER AND USR.D_E_L_E_T_= ' '
LEFT JOIN SYS_USR USRA ON USRA.USR_ID = SCRC.CR_USER AND USRA.D_E_L_E_T_= ' '
LEFT JOIN SIGAMAT EMP ON M0_CODIGO = '00' AND M0_CODFIL = C7_FILIAL AND EMP.D_E_L_E_T_= ' '
												 
WHERE C7_FILIAL BETWEEN @MV_PAR03@ AND @MV_PAR04@
AND SCR.CR_TIPO IN ('PC','IP')
AND SC7.D_E_L_E_T_= ' '
AND SUBSTR(C7_TPPED,1,1) <> '6'
AND C7_EMISSAO BETWEEN @MV_PAR01@ AND @MV_PAR02@  
AND SCR.CR_DATALIB = (SELECT MAX(SCRC.CR_DATALIB) 
                         FROM <ADVPL>RetSqlName("SCR")</ADVPL> SCRC
                         WHERE SCRC.CR_FILIAL = C7_FILIAL  AND SCRC.CR_NUM = C7_NUM AND SCRC.CR_TIPO IN ('PC','IP') AND SCRC.D_E_L_E_T_= ' ') 
AND SCR.CR_NIVEL = (SELECT MAX(SCRN.CR_NIVEL) FROM <ADVPL>RetSqlName("SCR")</ADVPL> SCRN 
                     WHERE SCRN.CR_FILIAL = SCR.CR_FILIAL 
						   AND SCRN.CR_DATALIB <> ' ' 
                           AND SCRN.CR_NUM = SCR.CR_NUM 
			               AND SCRN.CR_TIPO = SCR.CR_TIPO
                           AND SCRN.D_E_L_E_T_ = ' ')						 
<ADVPL>If( Alltrim(MV_PAR05) == '1', "AND C7_ACCPROC<>'1' And  C7_CONAPRO='B' And C7_QUJE < C7_QUANT","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '2', "AND C7_ACCPROC<>'1' And C7_CONAPRO='R' And C7_QUJE < C7_QUANT","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '3', "AND C7_QUJE=0 And C7_QTDACLA=0 And C7_RESIDUO=' '","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '4', "AND C7_ACCPROC='1'","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '5', "AND C7_QTDACLA >0","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '6', "AND C7_QUJE<>0 And C7_QUJE<C7_QUANT And C7_RESIDUO=' '","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '7', "AND C7_QUJE>=C7_QUANT","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '8', "AND C7_RESIDUO<> ' '","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '9', "AND C7_TIPO<> '1'","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '10', "AND C7_CONTRA<> ' ' And C7_RESIDUO=' '","")</ADVPL>

UNION ALL

SELECT DISTINCT
C7_FILIAL, 
M0_FILIAL,
C7_PRODUTO, 
C7_DESCRI, 
C7_QUANT, 
C7_QUJE  , 
C7_UM, 
C7_PRECO, 
C7_TOTAL,
CASE WHEN C7_MOEDA <> 1 AND C7_TXMOEDA <> 0 THEN C7_TOTAL * C7_TXMOEDA 
     WHEN C7_MOEDA = 1 THEN C7_TOTAL 
ELSE 0 END TOT_CONV,
C7_CC,
CTT_DESC01,
C7_CONTA,
CT1_DESC01,
C7_ITEMCTA,
CTD_DESC01,
C7_CLVL,
CTH_DESC01,
C7_XTOPER,
X5_DESCRI,
C7_DATPRF,
C7_NUMSC,
C7_ITEMSC,
SCRA.CR_DATALIB AS ULTAPRSC,
C7_COND,
E4_DESCRI,
C7_EMISSAO, 
CASE WHEN SUBSTR(C7_EMISSAO,5,2) = '01' THEN 'Janeiro' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '02' THEN 'Fevereiro' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '03' THEN 'Março' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '04' THEN 'Abril' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '05' THEN 'Maio' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '06' THEN 'Junho' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '07' THEN 'Julho' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '08' THEN 'Agosto' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '09' THEN 'Setembro' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '10' THEN 'Outubro' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '11' THEN 'Novembro' 
	 WHEN SUBSTR(C7_EMISSAO,5,2) = '12' THEN 'Dezembro' 
ELSE ' ' END MES,
C7_NUM, 
C7_ITEM, 
' ' AS ULTAPRPC,
C7_FORNECE,
C7_LOJA,
A2_NOME,
C7_NUMCOT,
C1_QUANT,
C7_TXMOEDA,
C7_MOEDA,
CASE WHEN C7_RATEIO='1' THEN '1=Sim' 
	 WHEN C7_RATEIO='2' THEN '2=Nao'
ELSE ' ' END C7_RATEIO,
C7_TIPCOM,
CASE WHEN C7_TPPED = '1' THEN '1=Auto'
     WHEN C7_TPPED = '2' THEN '2=Cot'
	 WHEN C7_TPPED = '3' THEN '3=Reg'
	 WHEN C7_TPPED = '4' THEN '4=Recor'
	 WHEN C7_TPPED = '5' THEN '5=Contr'
	 WHEN C7_TPPED = '6' THEN '6=Comis'
	 WHEN C7_TPPED = '7' THEN '7=Rev'
	 WHEN C7_TPPED = '8' THEN '8=SI'
	 WHEN C7_TPPED = '9' THEN '9=HE'
	 WHEN C7_TPPED = 'A' THEN 'A=Cpr Emerg'
	 WHEN C7_TPPED = 'B' THEN 'B=Cpr Confi'
	 WHEN C7_TPPED = 'C' THEN 'C=Cpr Frota'
	 WHEN C7_TPPED = 'D' THEN 'D=Cpr Direta'
	 WHEN C7_TPPED = 'E' THEN 'E=Cpr TI/Cot'
ELSE ' ' END C7_TPPED,
C7_USER, 
C7_OBS,
C7_XJUSTIF,
USR.USR_NOME,
SCRA.CR_USER CODAPR,
SCRC.CR_NIVEL NIVEL,
USRA.USR_NOME AS APROV

  FROM <ADVPL>RetSqlName("SC7")</ADVPL> SC7

 JOIN <ADVPL>RetSqlName("SA2")</ADVPL> SA2 ON A2_FILIAL = ' ' AND A2_COD = C7_FORNECE AND A2_LOJA = C7_LOJA AND SA2.D_E_L_E_T_=' '

LEFT JOIN <ADVPL>RetSqlName("SCR")</ADVPL> SCR ON SCR.CR_FILIAL = C7_FILIAL AND SCR.CR_NUM = C7_NUM AND SCR.D_E_L_E_T_ = ' '
  
LEFT JOIN <ADVPL>RetSqlName("CT1")</ADVPL> CT1 ON CT1_FILIAL = ' ' AND CT1_CONTA = C7_CONTA AND CT1.D_E_L_E_T_=' '
LEFT JOIN <ADVPL>RetSqlName("CTT")</ADVPL> CTT ON CTT_FILIAL = ' ' AND CTT_CUSTO = C7_CC AND CTT.D_E_L_E_T_=' '
LEFT JOIN <ADVPL>RetSqlName("CTD")</ADVPL> CTD ON CTD_FILIAL = ' ' AND CTD_ITEM = C7_ITEMCTA AND CTD.D_E_L_E_T_=' '
LEFT JOIN <ADVPL>RetSqlName("CTH")</ADVPL> CTH ON CTH_FILIAL = ' ' AND CTH_CLVL = C7_CLVL AND CTH.D_E_L_E_T_=' '
LEFT JOIN <ADVPL>RetSqlName("SX5")</ADVPL> SX5 ON X5_FILIAL = ' ' AND X5_TABELA = 'ZV' AND X5_CHAVE = C7_XTOPER AND SX5.D_E_L_E_T_=' '
LEFT JOIN <ADVPL>RetSqlName("SE4")</ADVPL> SE4 ON E4_FILIAL = ' ' AND E4_CODIGO = C7_COND AND SE4.D_E_L_E_T_ = ' '
LEFT JOIN <ADVPL>RetSqlName("SC1")</ADVPL> SC1 ON C1_FILIAL = C7_FILIAL AND C1_NUM = C7_NUMSC AND C1_ITEM = C7_ITEMSC AND SC1.D_E_L_E_T_ = ' '
LEFT JOIN <ADVPL>RetSqlName("SCR")</ADVPL> SCRA ON SCRA.CR_FILIAL = C1_FILIAL  AND SCRA.CR_NUM = C1_NUM AND C1_APROV = 'L' AND SCRA.CR_TIPO = 'SC' AND SCRA.D_E_L_E_T_ = ' ' 
						 AND SCRA.CR_DATALIB = (SELECT MAX(SCRB.CR_DATALIB) 
												  FROM <ADVPL>RetSqlName("SCR")</ADVPL> SCRB 
												 WHERE SCRB.CR_FILIAL = C7_FILIAL AND SCRB.CR_DATALIB <> ' ' AND SCRB.CR_NUM = C1_NUM AND SCRB.D_E_L_E_T_=' ')
					     AND SCRA.CR_NIVEL = (SELECT MAX(SCRN.CR_NIVEL) 
						                        FROM <ADVPL>RetSqlName("SCR")</ADVPL> SCRN 
											   WHERE SCRN.CR_FILIAL = SCRA.CR_FILIAL 
													 AND SCRN.CR_DATALIB <> ' ' 
												     AND SCRN.CR_NUM = SCRA.CR_NUM 
													 AND SCRN.CR_TIPO = SCRA.CR_TIPO
													 AND SCRN.D_E_L_E_T_ = ' ')
LEFT JOIN SCR000 SCRC ON SCRC.CR_FILIAL = C7_FILIAL AND SCRC.CR_NUM = C7_NUM AND SCRC.D_E_L_E_T_ = ' '	
													AND SCRC.CR_NIVEL = ( SELECT MAX(SCRN.CR_NIVEL) 
												 FROM <ADVPL>RetSqlName("SCR")</ADVPL> SCRN 
												WHERE SCRN.CR_FILIAL = SCRC.CR_FILIAL 
													  AND SCRN.CR_DATALIB <> ' ' 
													  AND SCRN.CR_NUM = SCRC.CR_NUM 
													  AND SCRN.CR_TIPO = SCRC.CR_TIPO
													  AND SCRN.D_E_L_E_T_ = ' ')
LEFT JOIN SYS_USR USR ON USR_ID = C7_USER AND USR.D_E_L_E_T_= ' '
LEFT JOIN SYS_USR USRA ON USRA.USR_ID = SCRC.CR_USER AND USRA.D_E_L_E_T_= ' '
LEFT JOIN SIGAMAT EMP ON M0_CODIGO = '00' AND M0_CODFIL = C7_FILIAL AND EMP.D_E_L_E_T_= ' '
										 
WHERE C7_FILIAL BETWEEN @MV_PAR03@ AND @MV_PAR04@
AND C7_EMISSAO BETWEEN @MV_PAR01@ AND @MV_PAR02@  
AND SCR.CR_DATALIB IS NULL 
AND SC7.D_E_L_E_T_= ' '
AND SUBSTR(C7_TPPED,1,1) <> '6'
<ADVPL>If( Alltrim(MV_PAR05) == '1', "AND C7_ACCPROC<>'1' And  C7_CONAPRO='B' And C7_QUJE < C7_QUANT","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '2', "AND C7_ACCPROC<>'1' And C7_CONAPRO='R' And C7_QUJE < C7_QUANT","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '3', "AND C7_QUJE=0 And C7_QTDACLA=0 And C7_RESIDUO=' '","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '4', "AND C7_ACCPROC='1'","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '5', "AND C7_QTDACLA >0","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '6', "AND C7_QUJE<>0 And C7_QUJE<C7_QUANT And C7_RESIDUO=' '","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '7', "AND C7_QUJE>=C7_QUANT","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '8', "AND C7_RESIDUO<> ' '","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '9', "AND C7_TIPO<> '1'","")</ADVPL>
<ADVPL>If( Alltrim(MV_PAR05) == '10', "AND C7_CONTRA<> ' ' And C7_RESIDUO=' '","")</ADVPL>);;
COM002;CONSULTA PRODUTOS X CONTA CONTÁBIL;02;20181015;;9;2;;0;;;;2;27;;;1;2;0;;;1;;SELECT 
SB1.B1_COD,
SB1.B1_DESC ,
SB1.B1_CONTA,
CT1.CT1_CONTA,
CT1.CT1_DESC01
FROM SB1000 SB1
LEFT JOIN CT1000 CT1
ON SB1.B1_CONTA = CT1.CT1_CONTA
WHERE SB1.B1_COD BETWEEN @PRODUTO@ AND @PRODUTO2@
AND SB1.D_E_L_E_T_ = ' ';;
COM003;CONSULTA WF FLUIG PEDIDO DE COMPRA;02;20190319;;199;2;;0;;;;2;28;;;1;2;0;;;1;;SELECT 
C7_FILIAL,
C7_NUM,
CR_TIPO,
C7_ITEM,
C7_PRODUTO,
C7_DESCRI,
C7_QUANT,
C7_PRECO,
C7_TOTAL,
C7_FORNECE,
C7_EMISSAO,
CR_NIVEL,
CR_STATUS,
CR_FLUIG


FROM SC7000X SC7

LEFT JOIN SCR000 SCR ON CR_FILIAL = C7_FILIAL 
AND CR_NUM = C7_NUM
AND SCR.D_E_L_E_T_ = ' '

WHERE SC7.D_E_L_E_T_ = ' '
AND C7_NUM = @NUMERO@
;;
COM004;CONSULTA WF FLUIG SOLICITAÇÃO DE COMPRAS;02;20190319;;9;2;;0;;;;2;29;;;1;2;0;;;1;;SELECT 
C1_FILIAL,
C1_NUM,
CR_TIPO,
C1_ITEM,
C1_PRODUTO,
C1_DESCRI,
C1_QUANT,
C1_PRECO,
C1_TOTAL,
C1_FORNECE,
C1_EMISSAO,
CR_NIVEL,
CR_STATUS,
CR_FLUIG


FROM SC1000 SC1

LEFT JOIN SCR000 SCR ON CR_FILIAL = C1_FILIAL 
AND CR_NUM = C1_NUM
AND SCR.D_E_L_E_T_ = ' '

WHERE SC1.D_E_L_E_T_ = ' '
AND C1_NUM = @NUMERO@
;;
COM005;CONSULTA SCR - REPLICA GENERICA;02;20210510;;6;2;;0;;;;2;;;;1;2;0;;;1;;SELECT 
CR_FILIAL,
CR_NUM,
CR_TIPO,
CR_USER,
CR_APROV,
CR_GRUPO,
CR_ITGRP,
CR_NIVEL,
CASE WHEN CR_STATUS='01' THEN 'Aguardando nivel anterior' 
WHEN CR_STATUS='02' THEN 'Pendente' 
WHEN CR_STATUS='03' THEN 'Liberado' 
WHEN CR_STATUS='04' THEN 'Bloqueado' 
WHEN CR_STATUS='05' THEN 'Liberado outro usuario'
WHEN CR_STATUS='06' THEN 'Rejeitado' ELSE ' ' END CR_STATUS,
CR_EMISSAO,
CR_TOTAL,
CR_DATALIB,
CR_FLUIG
                      
FROM SCR000

WHERE 
CR_FILIAL BETWEEN @FILIAL_DE@ AND @FILIAL_ATE@ AND CR_EMISSAO BETWEEN @EMISSAO_DE@ AND @EMISSAO_ATE@
AND CR_TIPO BETWEEN @TIPO_DE@ AND @TIPO_ATE@;;
CONBV1;ROTINA DE TITULOS GERAIS;06;20200302;;5;2;;0;;;;2;30;;;1;2;0;;;1;;SELECT DISTINCT E1_FILIAL,  E1_FILORIG, A1_XCLIVIP, A1_XESTRAT, E1_CLIENTE, E1_LOJA, A1_NOME, E1_NFELETR, E1_PREFIXO, E1_NUM, E1_PARCELA, E1_TIPO, E1_EMISSAO, E1_VENCTO, E1_VENCREA, E1_VALOR, E1_IRRF, E1_ISS, E1_INSS, E1_PIS, E1_COFINS, E1_CSLL, E1_VALOR, E1_SALDO, E1_PORTADO, E1_SITUACA, FRV_DESCRI, E1_PEDIDO, E1_BAIXA, E1_ACRESC, E1_HIST,  E1_XPROPEN,  E1_DECRESC,  SE1.R_E_C_N_O_ AS RECNOSE1,  (SELECT E1_SALDO FROM SE1000 SE1IR WHERE SE1IR.E1_FILIAL = SE1.E1_FILIAL AND SE1IR.E1_NUM = SE1.E1_NUM  AND SE1IR.E1_PREFIXO = SE1.E1_PREFIXO AND SE1IR.E1_PARCELA = SE1.E1_PARCELA AND SE1IR.E1_TIPO = 'IR-' AND  SE1IR.E1_CLIENTE = SE1.E1_CLIENTE AND SE1IR.E1_LOJA = SE1.E1_LOJA AND SE1IR.D_E_L_E_T_ = ' ') AS IR,  (SELECT E1_SALDO FROM SE1000 SE1IR WHERE SE1IR.E1_FILIAL = SE1.E1_FILIAL AND SE1IR.E1_NUM = SE1.E1_NUM  AND SE1IR.E1_PREFIXO = SE1.E1_PREFIXO AND SE1IR.E1_PARCELA = SE1.E1_PARCELA AND SE1IR.E1_TIPO = 'CF-' AND  SE1IR.E1_CLIENTE = SE1.E1_CLIENTE AND SE1IR.E1_LOJA = SE1.E1_LOJA AND SE1IR.D_E_L_E_T_ = ' ') AS COFINS,  (SELECT E1_SALDO FROM SE1000 SE1IR WHERE SE1IR.E1_FILIAL = SE1.E1_FILIAL AND SE1IR.E1_NUM = SE1.E1_NUM  AND SE1IR.E1_PREFIXO = SE1.E1_PREFIXO AND SE1IR.E1_PARCELA = SE1.E1_PARCELA AND SE1IR.E1_TIPO = 'PI-' AND  SE1IR.E1_CLIENTE = SE1.E1_CLIENTE AND SE1IR.E1_LOJA = SE1.E1_LOJA AND SE1IR.D_E_L_E_T_ = ' ') AS PIS,  (SELECT E1_SALDO FROM SE1000 SE1IR WHERE SE1IR.E1_FILIAL = SE1.E1_FILIAL AND SE1IR.E1_NUM = SE1.E1_NUM  AND SE1IR.E1_PREFIXO = SE1.E1_PREFIXO AND SE1IR.E1_PARCELA = SE1.E1_PARCELA AND SE1IR.E1_TIPO = 'IN-' AND  SE1IR.E1_CLIENTE = SE1.E1_CLIENTE AND SE1IR.E1_LOJA = SE1.E1_LOJA AND SE1IR.D_E_L_E_T_ = ' ') AS INSS,  (SELECT E1_SALDO FROM SE1000 SE1IR WHERE SE1IR.E1_FILIAL = SE1.E1_FILIAL AND SE1IR.E1_NUM = SE1.E1_NUM  AND SE1IR.E1_PREFIXO = SE1.E1_PREFIXO AND SE1IR.E1_PARCELA = SE1.E1_PARCELA AND SE1IR.E1_TIPO = 'IS-' AND  SE1IR.E1_CLIENTE = SE1.E1_CLIENTE AND SE1IR.E1_LOJA = SE1.E1_LOJA AND SE1IR.D_E_L_E_T_ = ' ') AS ISS,  (SELECT E1_SALDO FROM SE1000 SE1IR WHERE SE1IR.E1_FILIAL = SE1.E1_FILIAL AND SE1IR.E1_NUM = SE1.E1_NUM  AND SE1IR.E1_PREFIXO = SE1.E1_PREFIXO AND SE1IR.E1_PARCELA = SE1.E1_PARCELA AND SE1IR.E1_TIPO = 'CS-' AND  SE1IR.E1_CLIENTE = SE1.E1_CLIENTE AND SE1IR.E1_LOJA = SE1.E1_LOJA AND SE1IR.D_E_L_E_T_ = ' ') AS CSLL,  A1_VEND, A3_NOME, A1_SUPER, ADKSU.ADK_NOME ADKSUP, A1_XMOTVIP, F2_FILIAL, F2_DOC, F2_SERIE, ( SELECT X5_DESCRI FROM SX5000 SX5V WHERE SX5V.X5_FILIAL = '           ' AND SX5V.X5_TABELA = 'Z8' AND SX5V.X5_CHAVE = A1_XMOTVIP AND ROWNUM = 1 AND SX5V.D_E_L_E_T_ = ' ' ) AS MOTVIP, ( SELECT X5_DESCRI FROM SX5000 SX5M WHERE SX5M.X5_FILIAL = '           ' AND SX5M.X5_TABELA = 'Z9' AND SX5M.X5_CHAVE = A1_XMOTEST AND ROWNUM = 1 AND SX5M.D_E_L_E_T_ = ' ' ) AS MOTMON,( SELECT COUNT(ZA8_DATA) FROM ZA8000 ZA8 WHERE ZA8.ZA8_FILIAL  = '           ' AND ZA8.ZA8_CLIENT  = SE1.E1_CLIENTE AND ZA8.ZA8_LOJACL  = SE1.E1_LOJA AND ZA8.D_E_L_E_T_ = ' ') AS PASSAGEM,( SELECT MAX(ZA8_DATA) FROM ZA8000 ZA8 WHERE ZA8.ZA8_FILIAL  = '           ' AND ZA8.ZA8_CLIENT  = SE1.E1_CLIENTE AND ZA8.ZA8_LOJACL  = SE1.E1_LOJA AND ZA8.D_E_L_E_T_ = ' ') AS VENC_MONIT, AI0_SETPUB, (SELECT FWB_OCORR  FROM FWB000 FWB WHERE FWB_IDDOC = FK7_IDDOC AND FWB.R_E_C_N_O_ = (SELECT MAX(FWB1.R_E_C_N_O_)  FROM FWB000 FWB1  WHERE  FWB1.FWB_IDDOC = FK7_IDDOC AND FWB1.FWB_DTOCOR <= '20200318' AND FWB1.D_E_L_E_T_ = ' ') AND FWB.D_E_L_E_T_ = ' ' ) SERASA,
 (SELECT ZQE.ZQE_ATENDE  FROM ZQE000 ZQE
 WHERE ZQE_FILIAL = '           '
 AND ZQE_CODCLI = A1_COD
 AND ZQE_LJCLI = A1_LOJA
 AND ROWNUM = 1
 AND ZQE.D_E_L_E_T_ = ' ') ATENDE,
 (SELECT MIN(ZDP_VENCTO)  FROM ZDP000 ZDP
 WHERE ZDP_FILIAL IN ('00001000100','00001000600','00001000800','00001001000','00001001100','00001001200','00001001700','00001001900','00001002000','00001002200','00001002300','00001002600','00001002700','00001003100','00102000100','00102000400','00102000500','00102000900','00202000100','00202000200','00302000100','00302000200','00302000500','00401000100','00501000100','00801000100','01002000100','01101000100','01401000100','02201000100','02301000100','02301000200','02501000100','02501000200','02501000500','02501000700','02501002000','02501002200')
 AND ZDP_CLIENT = A1_COD
 AND ZDP.D_E_L_E_T_ = ' '
) LINVECTO,
 A1_UNIDVEN, ADKUV.ADK_NOME ADKVEN, AOM.AOM_DESCRI AOM_DESCRI, SBM.BM_XLINREC,SBM.BM_GRUPO,SBM.BM_DESC, SC5.C5_MENNOTA , E1_XPROPEN, AI0_XPROPE, AI0_XDTPRR, (SELECT DISTINCT LISTAGG(C6_XPROPOS,'/' ON OVERFLOW TRUNCATE) WITHIN GROUP (ORDER BY C6_XPROPOS) OVER (PARTITION BY E1_NUM) FROM SC6000 SC6 WHERE C6_FILIAL = E1_FILIAL AND SC6.C6_CLI = SE1.E1_CLIENTE AND SC6.C6_NOTA = SE1.E1_NUM AND SC6.C6_SERIE = SE1.E1_PREFIXO  GROUP BY C6_XPROPOS) AS C6_XPROPOS,  (SELECT PJ2_DESCRI FROM PJ9000 PJ9 LEFT JOIN PJ2000 PJ2 ON PJ2_FILIAL = '           ' AND PJ2_CODIGO = PJ9_CODACA AND PJ2.D_E_L_E_T_ = '' WHERE PJ9.D_E_L_E_T_ = '' AND PJ9_FILTIT = SE1.E1_FILIAL AND PJ9_PREFIX = SE1.E1_PREFIXO AND PJ9_NUMTIT = SE1.E1_NUM AND PJ9_PARCEL = SE1.E1_PARCELA AND PJ9_TIPTIT = SE1.E1_TIPO ORDER BY PJ9_DATA DESC, PJ9_HORA DESC FETCH FIRST 1 ROWS ONLY) AS ULTRC_A , (SELECT PJ4_DESCRI FROM PJ9000 PJ9 LEFT JOIN PJ4000 PJ4 ON PJ4_FILIAL = PJ9_FILIAL AND PJ4_CODREG = PJ9_CODREG AND PJ4.D_E_L_E_T_ = '' WHERE PJ9.D_E_L_E_T_ = '' AND PJ9_FILTIT = SE1.E1_FILIAL AND PJ9_PREFIX = SE1.E1_PREFIXO AND PJ9_NUMTIT = SE1.E1_NUM AND PJ9_PARCEL = SE1.E1_PARCELA AND PJ9_TIPTIT = SE1.E1_TIPO ORDER BY PJ9_DATA DESC, PJ9_HORA DESC FETCH FIRST 1 ROWS ONLY) AS ULTRC_R , (SELECT PJ9_LOTE FROM PJ9000 PJ9  WHERE PJ9.D_E_L_E_T_ = '' AND PJ9_FILTIT = SE1.E1_FILIAL AND PJ9_PREFIX = SE1.E1_PREFIXO AND PJ9_NUMTIT = SE1.E1_NUM AND PJ9_PARCEL = SE1.E1_PARCELA AND PJ9_TIPTIT = SE1.E1_TIPO ORDER BY PJ9_DATA DESC, PJ9_HORA DESC FETCH FIRST 1 ROWS ONLY) AS ULTRC_L  FROM SE1000 SE1
 INNER JOIN SA1000 SA1
 ON A1_FILIAL = '           '
 AND A1_COD = E1_CLIENTE
 AND A1_LOJA = E1_LOJA
 AND SA1.D_E_L_E_T_ = ' '
 LEFT JOIN SC6000 SC6
 ON SC6.C6_FILIAL = E1_FILIAL
 AND SC6.C6_CLI = SE1.E1_CLIENTE
 AND SC6.C6_NOTA = SE1.E1_NUM
 AND SC6.C6_SERIE = SE1.E1_PREFIXO
 LEFT JOIN AI0000 AI0
 ON AI0_FILIAL = '           '
 AND AI0_CODCLI = A1_COD
 AND AI0_LOJA = A1_LOJA
 AND AI0.D_E_L_E_T_ = ' ' LEFT JOIN SA3000 SA3
 ON A3_FILIAL = '           '
 AND A3_COD = A1_VEND
 AND SA3.D_E_L_E_T_ = ' '
 INNER JOIN FRV000 FRV
 ON FRV_FILIAL = '           '
 AND FRV_CODIGO = E1_SITUACA
 AND FRV.D_E_L_E_T_ = ' '
 LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADKSU
 ON ADKSU.ADK_FILIAL = '           '
 AND ADKSU.ADK_COD = A1_SUPER
 AND ADKSU.D_E_L_E_T_ = ' '
 LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADKUV
 ON ADKUV.ADK_FILIAL = '           '
 AND ADKUV.ADK_COD = A1_UNIDVEN
 AND ADKUV.D_E_L_E_T_ = ' '
 LEFT JOIN FK7000 FK7 ON FK7_FILIAL = E1_FILORIG AND FK7_ALIAS = 'SE1' AND FK7_CHAVE = E1_FILIAL || '|' || E1_PREFIXO || '|' || E1_NUM || '|' || E1_PARCELA || '|' || E1_TIPO || '|' || E1_CLIENTE || '|' || E1_LOJA AND FK7.D_E_L_E_T_ = ' ' LEFT JOIN SC5000 SC5 ON SC5.C5_FILIAL = E1_FILIAL  AND SC5.C5_NUM = E1_PEDIDO  AND SC5.D_E_L_E_T_ = ' ' LEFT JOIN SF2000 SF2 ON SF2.F2_FILIAL = E1_FILORIG AND SF2.F2_CLIENTE = E1_CLIENTE AND SF2.F2_LOJA = E1_LOJA AND SF2.F2_DOC = E1_NUM AND SF2.F2_SERIE = E1_PREFIXO AND SF2.D_E_L_E_T_ = ' ' LEFT JOIN SD2000 SD2 ON SD2.D2_FILIAL = F2_FILIAL AND SD2.D2_CLIENTE = F2_CLIENTE AND SD2.D2_LOJA = F2_LOJA AND SD2.D2_DOC = F2_DOC AND SD2.D2_SERIE = F2_SERIE   AND SD2.D_E_L_E_T_ = ' ' AND SD2.D2_ITEM = (SELECT MIN(D2_ITEM) FROM SD2000 WHERE D2_DOC = SF2.F2_DOC AND D2_SERIE = SF2.F2_SERIE AND D2_CLIENTE = SF2.F2_CLIENTE AND D2_LOJA = SF2.F2_LOJA AND D_E_L_E_T_ = ' ') LEFT JOIN SB1000 SB1 ON SB1.B1_COD = D2_COD AND SB1.B1_FILIAL = '           ' AND SB1.D_E_L_E_T_ = ' ' LEFT JOIN SBM000 SBM ON SBM.BM_GRUPO = B1_GRUPO AND SBM.BM_FILIAL = '           ' AND SBM.D_E_L_E_T_ = ' ' LEFT JOIN AOM000 AOM ON AOM.AOM_CODNIV = BM_XLINREC AND AOM.D_E_L_E_T_ = ' ' AND AOM.AOM_CODAGR = '000001'  WHERE E1_FILIAL IN ('00001000100','00001000600','00001000800','00001001000','00001001100','00001001200','00001001700','00001001900','00001002000','00001002200','00001002300','00001002600','00001002700','00001003100','00102000100','00102000400','00102000500','00102000900','00202000100','00202000200','00302000100','00302000200','00302000500','00401000100','00501000100','00801000100','01002000100','01101000100','01401000100','02201000100','02301000100','02301000200','02501000100','02501000200','02501000500','02501000700','02501002000','02501002200')
 AND E1_SALDO <> 0  AND E1_PREFIXO BETWEEN '   ' AND 'ZZZ'
 AND E1_NUM BETWEEN '         ' AND 'ZZZZZZZZZ'
 AND E1_CLIENTE BETWEEN '      ' AND 'ZZZZZZ'
 AND E1_LOJA BETWEEN '  ' AND 'ZZ'
 AND E1_EMISSAO BETWEEN '19800101' AND '20491231'
 AND E1_TIPO NOT IN ('AB-','FB-','FC-','FU-','IR-','IN-','IS-','PI-','CF-','CS-','FE-','IV-') AND E1_VENCREA BETWEEN '19800101' AND '20491231'
 AND E1_TIPO IN ('BOL','CC','CH','DP','FT','MIG','NDC','NF','RA           ') AND A1_XCLIVIP IN ('1','2','3','4','5','6','7','8','9','B','C','E','F','G','P','T','U','V')
 AND SE1.D_E_L_E_T_ = ' '
 ORDER BY E1_CLIENTE, E1_LOJA, E1_FILORIG, E1_VENCREA;;
CONFVI;CONFERENCIA DE VIAGENS - ASSISTENTE EXECUTIVA;06;20180702;;3;2;;0;;;;2;31;;;1;2;0;;;1;;SELECT 
FLF_STATUS,
FLF_FILIAL,
FLF_PRESTA,
FLF_TIPO,
FLF_PARTIC,
RD0_NOME,
FLF_EMISSA,
FLF_DTINI,
FLF_DTFIM,
FLF_NACION,
FLF_CC,
FLF_DTCONF,
FO7_PREFIX,
FO7_TITULO, 
FO7_CLIFOR,
E1_EMISSAO,
E1_VENCTO,
E1_VENCREA,
E1_BAIXA,
E1_VALLIQ,
E1_MOEDA,
E2_EMISSAO,
E2_VENCTO,
E2_VENCREA,
E2_BAIXA,
E2_VALLIQ,
E2_MOEDA

FROM FLF000 FLF

JOIN RD0000 RD0 ON RD0_CODIGO = FLF_PARTIC

LEFT JOIN FO7000B FO7 ON FO7_FILIAL = FLF_FILIAL
AND FO7_PRESTA = FLF_PRESTA
AND FO7_PARTIC = FLF_PARTIC

LEFT JOIN SE1000 SE1 ON E1_FILIAL = FO7_FILIAL
AND FO7_PREFIX = E1_PREFIXO
AND FO7_TITULO = E1_NUM 
AND FO7_CLIFOR = E1_CLIENTE
AND SE1.D_E_L_E_T_ = ' '

LEFT JOIN SE2000 SE2 ON E2_FILIAL = FO7_FILIAL
AND FO7_PREFIX = E2_PREFIXO
AND FO7_TITULO = E2_NUM
AND FO7_CLIFOR = E2_FORNECE
AND SE2.D_E_L_E_T_ = ' '

WHERE FLF_PARTIC IN (@PARTIC@)
AND FLF_STATUS <= '7'
AND FLF.D_E_L_E_T_ = ' ';;
CRM001;CONTAS X SEGMENTOS;73;20180711;;1204;2;;0;;;;2;32;;;1;2;0;;;1;;SELECT * FROM (SELECT DISTINCT
'CLIENTE' AS ENTIDADE
,CASE
WHEN A1_XSITCLI = '1' THEN 'ATIVO'
WHEN A1_XSITCLI <> '1' THEN 'INATIVO'
END AS A1_XSITCLI
,A1_COD
,A1_LOJA
,A1_NOME
,A1_CGC
,A1_END
,A1_XNEND
,A1_CEP
,A1_BAIRRO
,A1_DDD
,A1_TEL
,A1_MUN
,A1_EST
,A1_PAIS
,YA_DESCR
,A1_CNAE
,CC3_DESC
,A1_CODSEG
,AOV.AOV_DESSEG AS DESSEG
,A1_XCODSUB
,AOV2.AOV_DESSEG AS DESSUB
,A1_VEND
,SA31.A3_NOME AS NOMEEAR
,A1_XGAR AS CODGSN
,SA32.A3_NOME AS NOMEGSN
,SA31.A3_UNIDAD AS UNIDAD
,ADK_NOME

FROM SA1000 SA1

LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' ' 
AND SA31.A3_COD = A1_VEND 
AND SA31.D_E_L_E_T_ = ' '

LEFT JOIN ADK000 ADK ON ADK_FILIAL = ' ' 
AND ADK_COD = A3_UNIDAD
AND ADK.D_E_L_E_T_ = ' '

LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' ' 
AND SA32.A3_COD = A1_XGAR 
AND SA32.D_E_L_E_T_ = ' '

LEFT JOIN SYA000 SYA ON YA_FILIAL = ' ' 
AND YA_CODGI = A1_PAIS 
AND SYA.D_E_L_E_T_ = ' '

LEFT JOIN CC3000 CC3 ON CC3_FILIAL = ' ' 
AND CC3_COD = A1_CNAE 
AND CC3.D_E_L_E_T_ = ' '

LEFT JOIN AOV000 AOV ON AOV_FILIAL = ' ' 
AND AOV_CODSEG = A1_CODSEG 
AND AOV_PAI = ' ' 
AND AOV.D_E_L_E_T_ = ' '

LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' ' 
AND AOV2.AOV_CODSEG = A1_XCODSUB 
AND AOV2.AOV_PAI = A1_CODSEG 
AND AOV2.D_E_L_E_T_ = ' '

WHERE A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' '
AND A1_VEND BETWEEN  @I_VEND@ AND @F_VEND@
AND SA31.A3_UNIDAD BETWEEN @I_UNID@ AND @F_UNID@

UNION ALL

SELECT DISTINCT
'PROSPECT' AS ENTIDADE
,'N/D' AS A1_XSITCLI
,US_COD
,US_LOJA
,US_NOME
,US_CGC
,US_END
,'N/D' AS A1_XNEND
,US_CEP
,US_BAIRRO
,US_DDD
,US_TEL
,US_MUN
,US_EST
,US_PAIS
,YA_DESCR
,US_CNAE
,CC3_DESC
,US_CODSEG
,AOV.AOV_DESSEG AS DESSEG
,US_XCODSUB
,AOV2.AOV_DESSEG AS DESSUB
,US_VEND
,SA31.A3_NOME AS NOMEEAR
,US_XGAR AS CODGSN    
,SA32.A3_NOME AS NOMEGSN
,SA31.A3_UNIDAD AS UNIDAD
,ADK_NOME

FROM SUS000 SUS

LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' ' 
AND SA31.A3_COD = US_VEND 
AND SA31.D_E_L_E_T_ = ' '

LEFT JOIN ADK000 ADK ON ADK_FILIAL = ' ' 
AND ADK_COD = SA31.A3_UNIDAD
AND ADK.D_E_L_E_T_ = ' '

LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' ' 
AND SA32.A3_COD = US_XGAR 
AND SA32.D_E_L_E_T_ = ' '

LEFT JOIN SYA000 SYA ON YA_FILIAL = ' ' 
AND YA_CODGI = US_PAIS 
AND SYA.D_E_L_E_T_ = ' '

LEFT JOIN CC3000 CC3 ON CC3_FILIAL = ' ' 
AND CC3_COD = US_CNAE 
AND CC3.D_E_L_E_T_ = ' '

LEFT JOIN AOV000 AOV ON AOV_FILIAL = ' ' 
AND AOV_CODSEG = US_CODSEG 
AND AOV_PAI = ' ' 
AND AOV.D_E_L_E_T_ = ' '

LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' ' 
AND AOV2.AOV_CODSEG = US_XCODSUB 
AND AOV2.AOV_PAI = US_CODSEG 
AND AOV2.D_E_L_E_T_ = ' '

WHERE US_FILIAL = ' ' 
AND SUS.D_E_L_E_T_ = ' '
AND NOT EXISTS (SELECT A1_COD FROM SA1000 SA1 WHERE A1_FILIAL= ' ' AND A1_CGC = US_CGC AND SA1.D_E_L_E_T_=' ')
AND US_VEND BETWEEN @I_VEND@ AND @F_VEND@
AND SA31.A3_UNIDAD BETWEEN @I_UNID@ AND @F_UNID@

UNION ALL

SELECT DISTINCT
'SUSPECT' AS ENTIDADE
,'N/D' AS A1_XSITCLI
,ACH_CODIGO
,ACH_LOJA
,ACH_RAZAO
,ACH_CGC
,ACH_END
,'N/D' AS A1_XNEND
,ACH_CEP
,ACH_BAIRRO
,ACH_DDD
,ACH_TEL
,ACH_CIDADE
,ACH_EST
,ACH_PAIS
,YA_DESCR
,ACH_CNAE
,CC3_DESC
,ACH_CODSEG
,AOV.AOV_DESSEG AS DESSEG
,ACH_XCODSS
,AOV2.AOV_DESSEG AS DESSUB
,ACH_VEND
,SA31.A3_NOME AS NOMEEAR
,ACH_XGAR AS CODGSN
,SA32.A3_NOME AS NOMEGSN
,SA31.A3_UNIDAD AS UNIDAD
,ADK_NOME

FROM ACH000 SACH

LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' ' 
AND SA31.A3_COD = ACH_VEND 
AND SA31.D_E_L_E_T_ = ' '

LEFT JOIN ADK000 ADK ON ADK_FILIAL = ' ' 
AND ADK_COD = SA31.A3_UNIDAD
AND ADK.D_E_L_E_T_ = ' '

LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' ' 
AND SA32.A3_COD = ACH_XGAR 
AND SA32.D_E_L_E_T_ = ' '

LEFT JOIN SYA000 SYA ON YA_FILIAL = ' ' 
AND YA_CODGI = ACH_PAIS 
AND SYA.D_E_L_E_T_ = ' '

LEFT JOIN CC3000 CC3 ON CC3_FILIAL = ' ' 
AND CC3_COD = ACH_CNAE 
AND CC3.D_E_L_E_T_ = ' '

LEFT JOIN AOV000 AOV ON AOV_FILIAL = ' ' 
AND AOV_CODSEG = ACH_CODSEG 
AND AOV_PAI = ' ' 
AND AOV.D_E_L_E_T_ = ' '

LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' ' 
AND AOV2.AOV_CODSEG = ACH_XCODSS
AND AOV2.AOV_PAI = ACH_CODSEG 
AND AOV2.D_E_L_E_T_ = ' '

WHERE ACH_FILIAL = ' ' 
AND SACH.D_E_L_E_T_ = ' '
AND NOT EXISTS (SELECT A1_COD FROM SA1000 SA1 WHERE A1_FILIAL= ' ' AND A1_CGC = ACH_CGC AND SA1.D_E_L_E_T_=' ')
AND NOT EXISTS (SELECT US_COD FROM SUS000 SUS WHERE US_FILIAL= ' ' AND US_CGC = ACH_CGC AND SUS.D_E_L_E_T_=' ')
AND ACH_VEND BETWEEN @I_VEND@ AND @F_VEND@
AND SA31.A3_UNIDAD BETWEEN @I_UNID@ AND @F_UNID@) TABELA

WHERE <ADVPL>IF(_ENTIDA='1',"ENTIDADE ='CLIENTE'",IF(_ENTIDA = '2',"ENTIDADE ='PROSPECT'",IF(_ENTIDA = '3',"ENTIDADE ='SUSPECT'","ENTIDADE <> ' '")))</ADVPL>;Relatório de contas x segmentos;
CRM002;RELATÓRIO DE SEGMENTOS;73;20180720;;3;2;;0;;;;2;33;;;1;2;0;;;1;;SELECT DISTINCT
AOV_CODSEG
,AOV_DESSEG
,CASE
WHEN AOV_PRINC = '1' THEN 'SIM'
WHEN AOV_PRINC <> '1' THEN 'NÃO'
END AS AOV_PRINC
,AOV_PAI
,CASE 
WHEN AOV_MSBLQL <> '2' THEN 'BLOQUEADO'
WHEN AOV_MSBLQL = '2' THEN 'ATIVO'
END AS AOV_MSBLQL

FROM AOV000 AOV

WHERE AOV_FILIAL = ' ' AND AOV.D_E_L_E_T_ = ' ';Relatório de segmentos;
CRM003;OPORTUNIDADES X AGRUPADOR;73;20180727;;29;2;;0;;;;2;34;;;1;2;0;;;1;;SELECT DISTINCT
'CLIENTE' AS ENTIDADE
,AD1_CODCLI AS AD1_CODCLI
,A1_NOME
,ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS STAT_PROP
,ADY_OPORTU
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTA'
WHEN AD1_STATUS = '2' THEN 'PERDIDA'
WHEN AD1_STATUS = '9' THEN 'GANHA'
END AS AD1_STATUS
,AD1_DATA
,AD1_DTPFIM
,AD1_RCINIC
,AD1_XVLDSA
,AD1_STAGE
,ADJ_CODNIV
,AOM_DESCRI
,A1_VEND
,A3_NOME
,A1_CODMEMB
,ADK_NOME

FROM AD1000 AD1

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' ' 
AND A1_COD = AD1_CODCLI

INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' ' 
AND ADJ.D_E_L_E_T_ = ' ' 
AND ADJ_NROPOR = AD1_NROPOR
AND ADJ_REVISA = AD1_REVISA

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' ' 
AND AOM.D_E_L_E_T_ = ' ' 
AND AOM_CODAGR = ADJ_CODAGR
AND AOM_CODNIV = ADJ_CODNIV

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' 
AND SA3.D_E_L_E_T_ = ' ' 
AND A3_COD = A1_VEND

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' ' 
AND ADK_COD = A1_CODMEMB

LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' ' 
AND ADY_OPORTU = AD1_NROPOR
AND ADY_REVISA = AD1_REVISA

WHERE AD1_FILIAL = ' ' 
AND AD1.D_E_L_E_T_ = ' ' 
AND ADJ_CODNIV BETWEEN @I_COD_NIV@ AND @F_COD_NIV@
AND AD1_DATA BETWEEN @I_AD1_DATA@ AND @F_AD1_DATA@
AND AD1_STATUS <ADVPL>If(_STATUS = "1", "=", "<>")</ADVPL> '1'

UNION ALL

SELECT DISTINCT
'PROSPECT' AS ENTIDADE
,AD1_PROSPE  AS AD1_CODCLI
,US_NOME
,ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS STAT_PROP
,ADY_OPORTU
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTA'
WHEN AD1_STATUS = '2' THEN 'PERDIDA'
WHEN AD1_STATUS = '9' THEN 'GANHA'
END AS AD1_STATUS
,AD1_DATA
,AD1_DTPFIM
,AD1_RCINIC
,AD1_XVLDSA
,AD1_STAGE
,ADJ_CODNIV
,AOM_DESCRI
,US_VEND
,A3_NOME
,US_CODMEMB
,ADK_NOME

FROM AD1000 AD1

INNER JOIN SUS000 SUS ON US_FILIAL = ' ' 
AND SUS.D_E_L_E_T_ = ' ' 
AND US_COD = AD1_PROSPE

INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' ' 
AND ADJ.D_E_L_E_T_ = ' ' 
AND ADJ_NROPOR = AD1_NROPOR
AND ADJ_REVISA = AD1_REVISA

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' ' 
AND AOM.D_E_L_E_T_ = ' ' 
AND AOM_CODAGR = ADJ_CODAGR
AND AOM_CODNIV = ADJ_CODNIV

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' 
AND SA3.D_E_L_E_T_ = ' ' 
AND A3_COD = US_VEND

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' ' 
AND ADK_COD = US_CODMEMB

LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' ' 
AND ADY_OPORTU = AD1_NROPOR
AND ADY_REVISA = AD1_REVISA

WHERE AD1_FILIAL = ' ' 
AND AD1.D_E_L_E_T_ = ' '
AND US_STATUS <> '6'
AND ADJ_CODNIV BETWEEN @I_COD_NIV@ AND @F_COD_NIV@
AND AD1_DATA BETWEEN @I_AD1_DATA@ AND @F_AD1_DATA@
AND AD1_STATUS <ADVPL>If(_STATUS = "1", "=", "<>")</ADVPL> '1';;Relatório extraído através da informação de agrupador de vendas
CRM004;CONTRATOS - TSL105;73;20180809;;2;2;;0;;;;2;35;;;1;2;0;;;1;;SELECT DISTINCT
A1_COD
,A1_NOME
,A1_CGC
,CNB_PRODUT
,CNB_DESCRI
,A1_CODMEMB
,ADK_NOME
,CASE
WHEN CNB_SITUAC = 'A' THEN 'ATIVO'
WHEN CNB_SITUAC = 'C' THEN 'CANCELADO'
WHEN CNB_SITUAC = 'G' THEN 'GRATUITO'
WHEN CNB_SITUAC = 'M' THEN 'MANUAL'
WHEN CNB_SITUAC = 'P' THEN 'PENDENTE'
WHEN CNB_SITUAC = 'S' THEN 'SUSPENSO'
END AS CNB_SITUAC
,CNB_PROPOS
,ADY_XMODAL
,AOM_DESCRI
FROM SA1000 SA1
INNER JOIN CN9000 CN9 ON CN9_FILIAL = ' '
AND CN9_NUMERO = CONCAT('CON',A1_COD)
AND CN9_SITUAC = '05'
AND CN9.D_E_L_E_T_ = ' '
INNER JOIN CNB000 CNB ON CNB_FILIAL = ' '
AND CNB_CONTRA = CN9_NUMERO
AND CNB_REVISA = CN9_REVISA
AND CNB.D_E_L_E_T_ = ' '
INNER JOIN ADY000 ADY ON ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_PROPOS = CNB_PROPOS
INNER JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = '000001'
AND AOM_CODNIV = ADY_XMODAL
INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = A1_CODMEMB
WHERE CNB_FILIAL = ' '
AND SUBSTR(A1_COD,1,1) = 'T'
AND ADY_XMODAL IN ('0076','0077','0078','0079','0080','0266','0084','0085','0263')
AND CNB.D_E_L_E_T_ = ' '
AND A1_CODMEMB = 'TSL105';;Relatório de contrato da TSL105
CRM005;PROPOSTAS INTERA;73;20180919;;21;2;;0;;;;2;36;;;1;2;0;;;1;;SELECT DISTINCT
ADY_PROPOS
,ADY_DATA
,ADY_OPORTU
,ADY_XMODAL
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS STAT_PROP
,CASE
WHEN ADY_XTPINT = '1' THEN 'Novos'  
WHEN ADY_XTPINT = '2' THEN 'Base'
WHEN ADY_XTPINT = '3' THEN 'Migração' 
WHEN ADY_XTPINT = '4' THEN 'Base Migração' 
END AS TIPO
,ADY_DTUPL
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_QTDVEN
,ADZ_PRCVEN
,ADZ_TOTAL
,ZAV_METRIC
,ADZ_XVLINT
,ADZ_XINCRC
,ADZ_XVCTTT
,ADZ_XVCTRJ
,AOV_1.AOV_DESSEG AS SEG_TOTVS
,AOV_2.AOV_DESSEG AS SEG_INTERA
,A3_UNIDAD
,ADK_NOME
,ADY_CODIGO
,A1_NOME NOME_CLI
,A1_CGC
,A3_COD
,A3_NOME
,ADZ_XCOMPE
,CASE
WHEN ADZ_FOLDER = '1' THEN 'Produtos'
WHEN ADZ_FOLDER <> '1' THEN 'Acessorios'
END AS ADZ_FOLDER
,'CLIENTE' AS ENTIDADE

FROM ADY000 ADY
	 
INNER JOIN AD1000 AD1   
ON AD1_FILIAL = ' ' 
AND AD1_NROPOR = ADY_OPORTU  
AND AD1_REVISA = ADY_REVISA  
AND AD1.D_E_L_E_T_ = ' ' 

INNER JOIN ADZ000 ADZ  
ON ADZ_FILIAL = ' ' 
AND ADZ_PROPOS = ADY_PROPOS  
AND ADZ_REVISA = ADY_PREVIS
AND ADZ.D_E_L_E_T_ = ' '  

INNER JOIN SB1000 SB1  
ON B1_FILIAL = ' ' 
AND B1_COD = ADZ_PRODUT   
AND SB1.D_E_L_E_T_ = ' '  

INNER JOIN SA1000 SA1   
ON A1_FILIAL = ' ' 
AND A1_COD = ADY_CODIGO   
AND A1_LOJA = ADY_LOJA   
AND SA1.D_E_L_E_T_ = ' ' 

INNER JOIN AI0000 AI0
ON AI0_FILIAL = ' ' 
AND AI0_CODCLI = A1_COD   
AND AI0_LOJA = A1_LOJA   
AND AI0.D_E_L_E_T_ = ' '     

INNER JOIN SA3000 SA3  
ON A3_FILIAL = ' ' 
AND A3_COD = AD1_VEND    
AND SA3.D_E_L_E_T_ = ' '  

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK  
ON ADK_FILIAL = ' ' 
AND ADK_COD = A3_UNIDAD  
AND ADK.D_E_L_E_T_ = ' '

LEFT JOIN AOV000 AOV_1   
ON AOV_1.AOV_FILIAL = ' ' 
AND AOV_1.AOV_CODSEG = A1_CODSEG
AND AOV_1.AOV_PAI = ' ' 
AND AOV_1.D_E_L_E_T_ = ' ' 

LEFT JOIN AOV000 AOV_2
ON AOV_2.AOV_FILIAL = ' ' 
AND AOV_2.AOV_CODSEG = AI0_XSEGIN
AND AOV_2.D_E_L_E_T_ = ' ' 

LEFT JOIN ZAV000 ZAV ON ZAV_FILIAL = ' ' 
AND ZAV.D_E_L_E_T_ = ' '
AND ZAV_CODIGO = ADY_PROPOS
AND ZAV_VERSAO = ADY_PREVIS

WHERE ADY.D_E_L_E_T_ = ' '
AND ADY_FILIAL = ' ' 
AND ADY_XMODAL IN ('0168','0169','0181','0188','0304','0337')
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@

UNION ALL

SELECT DISTINCT
ADY_PROPOS
,ADY_DATA
,ADY_OPORTU
,ADY_XMODAL
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS STAT_PROP
,CASE
WHEN ADY_XTPINT = '1' THEN 'Novos'  
WHEN ADY_XTPINT = '2' THEN 'Base'
WHEN ADY_XTPINT = '3' THEN 'Migração' 
WHEN ADY_XTPINT = '4' THEN 'Base Migração' 
END AS TIPO
,ADY_DTUPL
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_QTDVEN
,ADZ_PRCVEN
,ADZ_TOTAL
,ZAV_METRIC
,ADZ_XVLINT
,ADZ_XINCRC
,ADZ_XVCTTT
,ADZ_XVCTRJ
,AOV_1.AOV_DESSEG AS SEG_TOTVS
,AOV_2.AOV_DESSEG AS SEG_INTERA
,A3_UNIDAD
,ADK_NOME
,ADY_CODIGO
,US_NOME NOME_CLI
,US_CGC
,A3_COD
,A3_NOME
,ADZ_XCOMPE
,CASE
WHEN ADZ_FOLDER = '1' THEN 'Produtos'
WHEN ADZ_FOLDER <> '1' THEN 'Acessorios'
END AS ADZ_FOLDER
,'PROSPECT' AS ENTIDADE

FROM ADY000 ADY
	 
INNER JOIN AD1000 AD1   
ON AD1_FILIAL = ' ' 
AND AD1_NROPOR = ADY_OPORTU  
AND AD1_REVISA = ADY_REVISA  
AND AD1.D_E_L_E_T_ = ' ' 

INNER JOIN ADZ000 ADZ  
ON ADZ_FILIAL = ' ' 
AND ADZ_PROPOS = ADY_PROPOS  
AND ADZ_REVISA = ADY_PREVIS
AND ADZ.D_E_L_E_T_ = ' '  

INNER JOIN SB1000 SB1  
ON B1_FILIAL = ' ' 
AND B1_COD = ADZ_PRODUT   
AND SB1.D_E_L_E_T_ = ' '  

INNER JOIN SUS000 SUS   
ON US_FILIAL = ' ' 
AND US_COD = ADY_CODIGO   
AND US_LOJA = ADY_LOJA   
AND SUS.D_E_L_E_T_ = ' ' 

INNER JOIN SA3000 SA3  
ON A3_FILIAL = ' ' 
AND A3_COD = AD1_VEND    
AND SA3.D_E_L_E_T_ = ' '  

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK  
ON ADK_FILIAL = ' ' 
AND ADK_COD = A3_UNIDAD  
AND ADK.D_E_L_E_T_ = ' '

LEFT JOIN AOV000 AOV_1   
ON AOV_1.AOV_FILIAL = ' ' 
AND AOV_1.AOV_CODSEG = US_CODSEG
AND AOV_1.AOV_PAI = ' ' 
AND AOV_1.D_E_L_E_T_ = ' ' 

LEFT JOIN AOV000 AOV_2
ON AOV_2.AOV_FILIAL = ' ' 
AND AOV_2.AOV_CODSEG = US_XSEGINT
AND AOV_2.D_E_L_E_T_ = ' ' 

LEFT JOIN ZAV000 ZAV ON ZAV_FILIAL = ' ' 
AND ZAV.D_E_L_E_T_ = ' '
AND ZAV_CODIGO = ADY_PROPOS
AND ZAV_VERSAO = ADY_PREVIS

WHERE ADY.D_E_L_E_T_ = ' '
AND ADY_FILIAL = ' ' 
AND ADY_XMODAL IN ('0168','0169','0181','0188','0304','0337')
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@;;
CRM006;ACESSOS AO CONSULTA PERSONALIZADA;73;20180925;;1;2;;0;;;;2;37;;;1;2;0;;;1;;SELECT DISTINCT
PQ8_ID
,PQ1_NOME
,PQ8_GRUSER
,PQ8_GRNOME
,PQ8_USER
,PQ8_USNOME

FROM PQ8000 PQ8

INNER JOIN PQ1000 PQ1 ON PQ1_FILIAL = ' ' 
AND PQ1.D_E_L_E_T_ = ' '
AND PQ8_ID = PQ1_ID

WHERE PQ8_FILIAL = ' ' 
AND PQ8.D_E_L_E_T_ = ' ';;
CRM007;RELATÓRIO DE CLIENTES;73;20181011;;24;2;;0;;;;2;38;;;1;2;0;;;1;;SELECT DISTINCT
A1_COD
,A1_CGC
,A1_NOME
,A1_MUN
,A1_CNAE
,CC3_DESC
,A1_CODSEG
,AOV1.AOV_DESSEG AS DESSEG
,A1_XCODSUB
,AOV2.AOV_DESSEG AS DESSUB
,A1_VEND
,SA31.A3_NOME AS NOMEESN
,AZS2.AZS_VEND
,SA32.A3_NOME AS NOMEGSN
,A1_CODMEMB
,ADK_NOME
,CASE
WHEN A1_XSITCLI = '1' THEN 'ATIVO'
WHEN A1_XSITCLI <> '1' THEN 'INATIVO'
END AS A1_XSITCLI
,AI0_XNFUNC 
,TO_CHAR(AI0_XFATAN) AS FAT 

FROM SA1000 SA1

LEFT JOIN CC3000 CC3 ON CC3_FILIAL = ' ' 
AND CC3.D_E_L_E_T_ = ' ' 
AND CC3_COD = A1_CNAE

LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' ' 
AND AOV1.D_E_L_E_T_ = ' ' 
AND AOV1.AOV_CODSEG = A1_CODSEG
AND AOV_PAI = ' '

LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' ' 
AND AOV2.D_E_L_E_T_ = ' ' 
AND AOV2.AOV_CODSEG = A1_XCODSUB
AND AOV2.AOV_PAI = A1_CODSEG

LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' ' 
AND SA31.D_E_L_E_T_ = ' ' 
AND SA31.A3_COD = A1_VEND

LEFT JOIN AZS000 AZS1 ON AZS1.AZS_FILIAL = ' ' 
AND AZS1.D_E_L_E_T_ = ' ' 
AND AZS1.AZS_VEND = A1_VEND

LEFT JOIN AZS000 AZS2 ON AZS2.AZS_FILIAL = ' '
AND AZS2.D_E_L_E_T_ = ' ' 
AND AZS2.AZS_VEND = A3_XGAR
AND AZS2.AZS_IDESTN <> ' ' 

LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' ' 
AND SA32.D_E_L_E_T_ = ' ' 
AND SA32.A3_COD = AZS2.AZS_VEND

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' ' 
AND ADK_COD = A1_CODMEMB

INNER JOIN AI0000 AI0 ON AI0_FILIAL = ' ' 
AND AI0.D_E_L_E_T_ = ' ' 
AND AI0_CODCLI = A1_COD

WHERE A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' '
AND A1_VEND BETWEEN @I_VEND@ AND @F_VEND@
AND AZS2.AZS_VEND BETWEEN @I_GAR@ AND @F_GAR@
AND A1_CNAE BETWEEN @I_CNAE@ AND @F_CNAE@
AND A1_CODSEG BETWEEN @I_CODSEG@ AND @F_CODSEG@
AND A1_XCODSUB BETWEEN @I_CODSUB@ AND @F_CODSUB@
AND A1_CODMEMB BETWEEN @I_CODMEMB@ AND @F_CODMEMB@
AND A1_XSITCLI IN <ADVPL> IF(_SITUA = '1', " ('1')", IF(_SITUA = '2', " (' ','2')",  " (' ','1','2')"))  </ADVPL>;;
CRM008;PREV. DE VENDA;73;20181101;;11;2;;0;;;;2;39;;;1;2;0;;;1;;SELECT DISTINCT
'CLIENTE' AS ENTIDADE
,AD1_NROPOR
,AD1_DESCRI
,AD1_DATA
,AD1_DTPFIM
,AD1_DTFIM
,AD1_RCINIC
,AD1_XVLDSA
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTO'
WHEN AD1_STATUS = '9' THEN 'GANHA'
WHEN AD1_STATUS = '2' THEN 'PERDIDA'
END AS AD1_STATUS
,ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS ADY_STATUS
,A1_COD
,A1_NOME
,A1_CGC
,A1_CODSEG
,AOV1.AOV_DESSEG AS DESSEG
,A1_XCODSUB
,AOV2.AOV_DESSEG AS DESSUB
,A1_VEND
,SA31.A3_NOME AS NOMEESN
,A1_XGAR
,SA32.A3_NOME AS NOMEGAR
,A1_CODMEMB
,ADK_NOME
,CASE
WHEN AD1_FEELIN = '1' THEN '30%'
WHEN AD1_FEELIN = '2' THEN '60%'
WHEN AD1_FEELIN = '3' THEN '90%'
END AS AD1_FEELIN
,AC2_DESCRI
,'000112' AS ADJ_CODAGR
,ADJ_CODNIV
,AOM_DESCRI
,AD1_FCS
,ZX51.ZX5_DESCRI AS DESC_FCS
,AD1_FCI
,ZX52.ZX5_DESCRI AS DESC_FCI
FROM SA1000 SA1
INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND AD1_CODCLI = A1_COD
INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' '
AND ADJ.D_E_L_E_T_ = ' '
AND ADJ_NROPOR = AD1_NROPOR
AND ADJ_REVISA = AD1_REVISA
AND ADJ_CODAGR = '000112'
INNER JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = ADJ_CODAGR
AND AOM_CODNIV = ADJ_CODNIV
LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_OPORTU = AD1_NROPOR
AND ADY_REVISA = AD1_REVISA
INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = A1_CODMEMB
LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' '
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = A1_CODSEG
AND AOV1.AOV_PAI = ' '
LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' '
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = A1_XCODSUB
AND AOV2.AOV_PAI = A1_CODSEG
LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' '
AND SA31.D_E_L_E_T_ = ' '
AND SA31.A3_COD = A1_VEND
LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' '
AND SA32.D_E_L_E_T_ = ' '
AND SA32.A3_COD = A1_XGAR
LEFT JOIN ZX5000 ZX51 ON ZX51.ZX5_FILIAL = ' '
AND ZX51.D_E_L_E_T_ = ' '
AND ZX51.ZX5_TABELA = 'CRM001'
AND ZX51.ZX5_CHAVE = AD1_FCS
LEFT JOIN ZX5000 ZX52 ON ZX52.ZX5_FILIAL = ' '
AND ZX52.D_E_L_E_T_ = ' '
AND ZX52.ZX5_TABELA = 'CRM003'
AND ZX52.ZX5_CHAVE = AD1_FCI
LEFT JOIN AC2000 AC2 ON AC2_FILIAL = ' '
AND AC2.D_E_L_E_T_ = ' '
AND AC2_PROVEN = '000002'
AND AC2_STAGE = AD1_STAGE
WHERE A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_CODMEMB BETWEEN @I_UNID@ AND @F_UNID@
AND A1_VEND BETWEEN @I_VEND@ AND @F_VEND@
AND AD1_DTPFIM BETWEEN @I_DTPFIM@ AND @F_DTPFIM@

UNION ALL

SELECT DISTINCT
'PROSPECT' AS ENTIDADE
,AD1_NROPOR
,AD1_DESCRI
,AD1_DATA
,AD1_DTPFIM
,AD1_DTFIM
,AD1_RCINIC
,AD1_XVLDSA
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTO'
WHEN AD1_STATUS = '9' THEN 'GANHA'
WHEN AD1_STATUS = '2' THEN 'PERDIDA'
END AS AD1_STATUS
,ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS ADY_STATUS
,US_COD
,US_NOME
,US_CGC
,US_CODSEG
,AOV1.AOV_DESSEG AS DESSEG
,US_XCODSUB
,AOV2.AOV_DESSEG AS DESSUB
,US_VEND
,SA31.A3_NOME AS NOMEESN
,US_XGAR
,SA32.A3_NOME AS NOMEGAR
,US_CODMEMB
,ADK_NOME
,CASE
WHEN AD1_FEELIN = '1' THEN '30%'
WHEN AD1_FEELIN = '2' THEN '60%'
WHEN AD1_FEELIN = '3' THEN '90%'
END AS AD1_FEELIN
,AC2_DESCRI
,'000112' AS ADJ_CODAGR
,ADJ_CODNIV
,AOM_DESCRI
,AD1_FCS
,ZX51.ZX5_DESCRI AS DESC_FCS
,AD1_FCI
,ZX52.ZX5_DESCRI AS DESC_FCI
FROM SUS000 SUS
INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND AD1_PROSPE = US_COD
INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' '
AND ADJ.D_E_L_E_T_ = ' '
AND ADJ_NROPOR = AD1_NROPOR
AND ADJ_REVISA = AD1_REVISA
AND ADJ_CODAGR = '000112'
INNER JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = ADJ_CODAGR
AND AOM_CODNIV = ADJ_CODNIV
LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_OPORTU = AD1_NROPOR
AND ADY_REVISA = AD1_REVISA
INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = US_CODMEMB
LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' '
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = US_CODSEG
AND AOV1.AOV_PAI = ' '
LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' '
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = US_XCODSUB
AND AOV2.AOV_PAI = US_CODSEG
LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' '
AND SA31.D_E_L_E_T_ = ' '
AND SA31.A3_COD = US_VEND
LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' '
AND SA32.D_E_L_E_T_ = ' '
AND SA32.A3_COD = US_XGAR
LEFT JOIN ZX5000 ZX51 ON ZX51.ZX5_FILIAL = ' '
AND ZX51.D_E_L_E_T_ = ' '
AND ZX51.ZX5_TABELA = 'CRM001'
AND ZX51.ZX5_CHAVE = AD1_FCS
LEFT JOIN ZX5000 ZX52 ON ZX52.ZX5_FILIAL = ' '
AND ZX52.D_E_L_E_T_ = ' '
AND ZX52.ZX5_TABELA = 'CRM003'
AND ZX52.ZX5_CHAVE = AD1_FCI
LEFT JOIN AC2000 AC2 ON AC2_FILIAL = ' '
AND AC2.D_E_L_E_T_ = ' '
AND AC2_PROVEN = '000002'
AND AC2_STAGE = AD1_STAGE
WHERE US_FILIAL = ' '
AND SUS.D_E_L_E_T_ = ' '
AND US_STATUS <> '6'
AND US_CODMEMB BETWEEN @I_UNID@ AND @F_UNID@
AND US_VEND BETWEEN @I_VEND@ AND @F_VEND@
AND AD1_DTPFIM BETWEEN @I_DTPFIM@ AND @F_DTPFIM@;;
CRM009;RELATÓRIO ZQK;73;20181109;;23;2;;0;;;;2;40;;;1;2;0;;;1;;SELECT
ZQK_FILIAL
,ZQK_CODZQJ
,ZQK_ITEM
,ZQK_GRUPO
FROM ZQK000 ZQK
WHERE ZQK.D_E_L_E_T_ = ' '
;;
CRM010;CLIENTES GENÉRICOS;73;20181123;;4;2;;0;;;;2;41;;;1;2;0;;;1;;SELECT DISTINCT 
A1_COD
,A1_LOJA
,A1_PESSOA
,A1_NOME
,A1_MSBLQL
,A1_CGC
,A1_INSCR
,A1_INSCRM
,A1_XCLIVIP
,A1_X_XHDLR
,A1_XHDSEMP
,A1_TIPO
,A1_PAIS
,A1_XUPMSHP
,YA_DESCR AS A1_PAISDES
,A1_CODPAIS
,A1_CNAE
,A1_CODSEG
,AOV1.AOV_DESSEG AS A1_DESSEG
,A1_XCODSUB
,A1_XESTRAT
,A1_XMOTEST
,A1_XDTESTR
,A1_NREDUZ
,A1_CEP
,A1_END
,A1_XNEND
,A1_COMPLEM
,A1_BAIRRO
,A1_MUN
,A1_EST
,A1_ESTADO
,A1_COD_MUN
,A1_CODSIAF
,A1_IBGE
,A1_DDD
,A1_DDI
,A1_TEL
,A1_FAX
,A1_ENDCOB
,A1_ENDENT
,A1_CONTATO
,A1_EMAIL
,A1_XNENDE
,A1_HPAGE
,A1_XCMPLE
,A1_VEND
,A1_BCO1
,A1_BCO2
,A1_BCO3
,A1_BCO4
,A1_BCO5
,A1_RECISS
,A1_INCISS 
,A1_MUNC
,A1_GRPVEN
,A1_CODMUNE
,A1_SIMPLES
,A1_CDRDES
,A1_SIMPNAC
,A1_HRCAD
,A1_SUPER
,A1_RECIRRF
,A1_ALIQIR
,A1_CEPC
,A1_BAIRROC
,A1_ESTC
,A1_BAIRROE
,A1_CEPE
,A1_MUNE
,A1_ESTE
,A1_TPESSOA
,A1_TIPOCLI
,A1_RECINSS
,A1_RECCOFI
,A1_RECCSLL
,A1_RECPIS
,A1_UNIDVEN
,A1_USADDA
,A1_CODTER
,ADK2.ADK_NOME AS A1_NOMTER
,A1_CODMEMB
,ADK1.ADK_NOME AS A1_DSCMEMB
,A1_XSITCLI
,A1_XGAR
,A1_MINIRF
,A1_DTCAD
,A1_XLIBSEN
,A1_XDTLMSE
,A1_XCODMS
,A1_XCODLG
,A1_XCODRM
,A1_XEMAILF

FROM SA1000 SA1

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK1 ON ADK1.ADK_FILIAL = ' ' 
AND ADK1.D_E_L_E_T_ = ' ' 
AND ADK1.ADK_COD = A1_CODMEMB

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK2 ON ADK2.ADK_FILIAL = ' ' 
AND ADK2.D_E_L_E_T_ = ' ' 
AND ADK2.ADK_COD = A1_CODTER

LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' ' 
AND AOV1.D_E_L_E_T_ = ' ' 
AND AOV1.AOV_CODSEG = A1_CODSEG
AND AOV1.AOV_PAI = ' '

LEFT JOIN SYA000 SYA ON YA_FILIAL = ' ' 
AND SYA.D_E_L_E_T_ = ' ' 
AND YA_CODGI = A1_PAIS

WHERE A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' '
;;
CRM011;CLIENTES GENÉRICOS RESUMIDO;73;20181206;;6;2;;0;;;;2;42;;;1;2;0;;;1;;SELECT DISTINCT
A1_COD
,A1_PESSOA
,A1_NOME
,A1_MSBLQL
,A1_CGC
,A1_INSCR
,A1_INSCRM
,A1_PAIS
,A1_CNAE
,A1_CODSEG
,A1_XCODSUB
,A1_NREDUZ
,A1_XEMAILF
FROM SA1000 SA1
WHERE A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
;;
CRM012;PROPOSTAS PBU;73;20190104;;7;2;;0;;;;2;43;;;1;2;0;;;1;;SELECT DISTINCT
ADY_PROPOS
,ADY_DATA
,ADY_DTUPL
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS ADY_STATUS
,PBU.PBU_CONTRA CONTRATO
,PBU.PBU_PROPOS PROPOSTA
,PBU.PBU_VERPRO VERPRO
,CASE PBU.PBU_DOCENT
WHEN 'S' THEN 'SIM'
WHEN 'N' THEN 'NAO'
END PBU_DOCENT
,PBU_DTDOC
,PBU_DTDIGI
,CASE PBU.PBU_PRPTER
WHEN 'S' THEN 'SIM'
WHEN 'N' THEN 'NAO'
END PBU_PRPTER
,AD1_VEND
,A3_NOME
FROM ADY000 ADY
INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND AD1_NROPOR = ADY_OPORTU
AND AD1_REVISA = ADY_REVISA
LEFT JOIN PBU000 PBU ON PBU_FILIAL = ' '
AND PBU.D_E_L_E_T_ = ' '
AND PBU_PROPOS = ADY_PROPOS
AND PBU_VERPRO = ADY_PREVIS
LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = AD1_VEND
WHERE ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ((ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@) OR (ADY_DTUPL BETWEEN @I_DATA@ AND @F_DATA@));;
CRM013;PROPOSTAS HOSPITALITY;73;20190118;;5;2;;0;;;;2;44;;;1;2;0;;;1;;SELECT DISTINCT
ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS ADY_STATUS
,ADY_DTFAT 
,ADY_OPORTU
,AD1_DESCRI
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTA'
WHEN AD1_STATUS = '2' THEN 'PERDIDA'
WHEN AD1_STATUS = '9' THEN 'GANHA'
END AS AD1_STATUS
,ADY_DATA
,'CLIENTE' AS ENTIDADE
,ADY_CODIGO
,A1_NOME
,AD1_VEND
,A3_NOME
,ADY_XDIARE
,ADY_XEMPSF
,ADY_XFILSF
,ADY_XSEGME
,AOV_DESSEG
,A1_CODMEMB
,ADK_NOME
,ADY_XMODAL
,AOM_DESCRI
,CASE
WHEN ADY_XSTATW = '0' THEN 'Nao possui WF'
WHEN ADY_XSTATW = '1' THEN 'Aprovacao Pendente'
WHEN ADY_XSTATW = '2' THEN 'Aprovado'
WHEN ADY_XSTATW = '3' THEN 'Reprovado'
END AS ADY_XSTATW
,ADY_DTUPL
,ADY_XVALPR
,ADY_XVALAC
,ADY_XVALSA
,CASE
WHEN ADY_XSAAS = 'S' THEN 'SIM'
WHEN ADY_XSAAS = 'N' THEN 'NAO'
END AS ADY_XSAAS
,CASE
WHEN ADY_XTPVEN = '1' THEN 'Aluguel de Software'
WHEN ADY_XTPVEN = '2' THEN 'Venda Tradicional'
WHEN ADY_XTPVEN = '3' THEN 'Corporativo'
WHEN ADY_XTPVEN = '4' THEN 'Migracao'
WHEN ADY_XTPVEN = '5' THEN 'Troca de Licenca'
WHEN ADY_XTPVEN = '6' THEN 'Renovacao'
WHEN ADY_XTPVEN = '7' THEN 'Totvs Store'
WHEN ADY_XTPVEN = '8' THEN 'Intera'
WHEN ADY_XTPVEN = '9' THEN 'Intera Ilimitado'
END AS ADY_XTPVEN

FROM ADY000 ADY

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' ' 
AND A1_COD = ADY_CODIGO

INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' ' 
AND AD1.D_E_L_E_T_ = ' ' 
AND AD1_NROPOR = ADY_OPORTU
AND AD1_REVISA = ADY_PREVIS

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' ' 
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = ADY_XMODAL

LEFT JOIN AOV000 AOV ON AOV_FILIAL = ' ' 
AND AOV.D_E_L_E_T_ = ' '
AND AOV_CODSEG = ADY_XSEGME

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = A1_CODMEMB

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' 
AND SA3.D_E_L_E_T_ = ' ' 
AND A3_COD = AD1_VEND

WHERE ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' '
AND ADY_XSEGME = '000016'
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@;;
CRM014;PREVISÃO DE VENDAS TSE004;73;20190123;;18;2;;0;;;;2;45;;;1;2;0;;;1;;SELECT DISTINCT
AD1_NROPOR
,AD1_DESCRI
,AD1_DATA
,A1_VEND
,SA31.A3_NOME AS NOMEESN
,A1_CODMEMB
,ADK_NOME
,AD1_DTPFIM
,AD1_DTFIM
,'CLIENTE' AS ENTIDADE
,AD1_CODCLI AS CODCONT
,A1_NOME
,AD1_STAGE
,AC2_DESCRI
,AD1_FCS
,ZX51.ZX5_DESCRI AS DESC_FCS
,AD1_FCI
,ZX52.ZX5_DESCRI AS DESC_FCI
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTA'
WHEN AD1_STATUS = '2' THEN 'PERDIDA'
WHEN AD1_STATUS = '9' THEN 'GANHA'
END AS AD1_STATUS
,AD1_RCINIC
,AD1_RCREAL
,AD1_XVLDSA
,ADJ_CODNIV
,AOM_DESCRI
,AD2_VEND
,SA32.A3_NOME AS NOMETIME
,AD2_PERC
,AD2_CODCAR
,SUM1.UM_DESC AS DESCCARGO
,AD2_CODPAP
,SUM2.UM_DESC AS DESCPAP
,A1_CODSEG
,AOV1.AOV_DESSEG AS DESSEG
,A1_XCODSUB
,AOV2.AOV_DESSEG AS DESSUB
FROM AD1000 AD1
INNER JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_COD = AD1_CODCLI
INNER JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' '
AND SA31.D_E_L_E_T_ = ' '
AND SA31.A3_COD = A1_VEND
INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = A1_CODMEMB
INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' '
AND ADJ.D_E_L_E_T_ = ' '
AND ADJ_NROPOR = AD1_NROPOR
AND ADJ_REVISA = AD1_REVISA
INNER JOIN AD2000 AD2 ON AD2_FILIAL = ' '
AND AD2.D_E_L_E_T_ = ' '
AND AD2_NROPOR = AD1_NROPOR
AND AD2_REVISA = AD1_REVISA
LEFT JOIN AC2000 AC2 ON AC2_FILIAL = ' '
AND AC2.D_E_L_E_T_ = ' '
AND AC2_PROVEN = '000002'
AND AC2_STAGE = AD1_STAGE
LEFT JOIN ZX5000 ZX51 ON ZX51.ZX5_FILIAL = ' '
AND ZX51.D_E_L_E_T_ = ' '
AND ZX51.ZX5_TABELA = 'CRM001'
AND ZX51.ZX5_CHAVE = AD1_FCS
LEFT JOIN ZX5000 ZX52 ON ZX52.ZX5_FILIAL = ' '
AND ZX52.D_E_L_E_T_ = ' '
AND ZX52.ZX5_TABELA = 'CRM003'
AND ZX52.ZX5_CHAVE = AD1_FCI
LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = ADJ_CODNIV
LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' '
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = A1_CODSEG
AND AOV1.AOV_PAI = ' '
LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' '
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = A1_XCODSUB
AND AOV2.AOV_PAI = A1_CODSEG
LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' '
AND SA32.D_E_L_E_T_ = ' '
AND SA32.A3_COD = AD2_VEND
LEFT JOIN SUM000 SUM1 ON SUM1.UM_FILIAL = ' '
AND SUM1.D_E_L_E_T_ = ' '
AND SUM1.UM_CARGO = AD2_CODCAR
LEFT JOIN SUM000 SUM2 ON SUM2.UM_FILIAL = ' '
AND SUM2.D_E_L_E_T_ = ' '
AND SUM2.UM_CARGO = AD2_CODPAP
WHERE AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND SA31.A3_UNIDAD = 'TSE004'
AND AD1_DTPFIM BETWEEN @I_DATA@ AND @F_DATA@

UNION ALL

SELECT DISTINCT
AD1_NROPOR
,AD1_DESCRI
,AD1_DATA
,US_VEND
,SA31.A3_NOME AS NOMEESN
,US_CODMEMB
,ADK_NOME
,AD1_DTPFIM
,AD1_DTFIM
,'PROSPECT' AS ENTIDADE
,AD1_PROSPE AS CODCONT
,US_NOME
,AD1_STAGE
,AC2_DESCRI
,AD1_FCS
,ZX51.ZX5_DESCRI AS DESC_FCS
,AD1_FCI
,ZX52.ZX5_DESCRI AS DESC_FCI
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTA'
WHEN AD1_STATUS = '2' THEN 'PERDIDA'
WHEN AD1_STATUS = '9' THEN 'GANHA'
END AS AD1_STATUS
,AD1_RCINIC
,AD1_RCREAL
,AD1_XVLDSA
,ADJ_CODNIV
,AOM_DESCRI
,AD2_VEND
,SA32.A3_NOME AS NOMETIME
,AD2_PERC
,AD2_CODCAR
,SUM1.UM_DESC AS DESCCARGO
,AD2_CODPAP
,SUM2.UM_DESC AS DESCPAP
,US_CODSEG
,AOV1.AOV_DESSEG AS DESSEG
,US_XCODSUB
,AOV2.AOV_DESSEG AS DESSUB
FROM AD1000 AD1
INNER JOIN SUS000 SUS ON US_FILIAL = ' '
AND SUS.D_E_L_E_T_ = ' '
AND US_COD = AD1_PROSPE
INNER JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' '
AND SA31.D_E_L_E_T_ = ' '
AND SA31.A3_COD = US_VEND
INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = US_CODMEMB
INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' '
AND ADJ.D_E_L_E_T_ = ' '
AND ADJ_NROPOR = AD1_NROPOR
AND ADJ_REVISA = AD1_REVISA
INNER JOIN AD2000 AD2 ON AD2_FILIAL = ' '
AND AD2.D_E_L_E_T_ = ' '
AND AD2_NROPOR = AD1_NROPOR
AND AD2_REVISA = AD1_REVISA
LEFT JOIN AC2000 AC2 ON AC2_FILIAL = ' '
AND AC2.D_E_L_E_T_ = ' '
AND AC2_PROVEN = '000002'
AND AC2_STAGE = AD1_STAGE
LEFT JOIN ZX5000 ZX51 ON ZX51.ZX5_FILIAL = ' '
AND ZX51.D_E_L_E_T_ = ' '
AND ZX51.ZX5_TABELA = 'CRM001'
AND ZX51.ZX5_CHAVE = AD1_FCS
LEFT JOIN ZX5000 ZX52 ON ZX52.ZX5_FILIAL = ' '
AND ZX52.D_E_L_E_T_ = ' '
AND ZX52.ZX5_TABELA = 'CRM003'
AND ZX52.ZX5_CHAVE = AD1_FCI
LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = ADJ_CODNIV
LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' '
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = US_CODSEG
AND AOV1.AOV_PAI = ' '
LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' '
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = US_XCODSUB
AND AOV2.AOV_PAI = US_CODSEG
LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' '
AND SA32.D_E_L_E_T_ = ' '
AND SA32.A3_COD = AD2_VEND
LEFT JOIN SUM000 SUM1 ON SUM1.UM_FILIAL = ' '
AND SUM1.D_E_L_E_T_ = ' '
AND SUM1.UM_CARGO = AD2_CODCAR
LEFT JOIN SUM000 SUM2 ON SUM2.UM_FILIAL = ' '
AND SUM2.D_E_L_E_T_ = ' '
AND SUM2.UM_CARGO = AD2_CODPAP
WHERE AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND SA31.A3_UNIDAD = 'TSE004'
AND US_STATUS <> '6'
AND AD1_DTPFIM BETWEEN @I_DATA@ AND @F_DATA@
;;
CRM015;PROPOSTAS - DESCONTOS ERP, FLUIG, DOODDATA;73;20190201;;3;2;;0;;;;2;46;;;1;2;0;;;1;;SELECT DISTINCT
A1_COD
,A1_NOME
,A1_CODSEG
,AOV_DESSEG
,ADK_NOME
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_PRCTAB
,ADZ_QTDVEN
,ADZ_DESCON
,ADZ_TOTAL
,ADZ_XPDEST
,ADZ_XVDEST
,ADZ_XVLTMP
,ADZ_XMESDT
,AD1_NROPOR
,CASE
WHEN ADZ_XSITUA ='F' THEN 'FATURADO'
WHEN ADZ_XSITUA ='G' THEN 'GRATUITO'
END AS ADZ_XSITUA
,ADY_XMODAL
,AOM1.AOM_DESCRI DESC_NIV
,AD1_DATA
,ADY_PROPOS
,CASE
WHEN ADY_STATUS ='K' THEN 'NF GERADA'
END AS ADY_STATUS

FROM AD1000 AD1
INNER JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND A1_COD = AD1_CODCLI
AND SA1.D_E_L_E_T_ = ' '
INNER JOIN ADY000 ADY ON ADY_FILIAL = ' '
AND ADY_OPORTU = AD1_NROPOR
AND ADY_REVISA = AD1_REVISA
AND ADY.D_E_L_E_T_ = ' '
INNER JOIN ADZ000 ADZ
ON ADZ_FILIAL = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS
AND ADZ.D_E_L_E_T_ = ' '
INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK.D_E_L_E_T_ = ' '
AND ADK_FILIAL = ' '
AND ADK_COD = A1_CODMEMB
LEFT JOIN AOM000 AOM1 ON AOM1.AOM_FILIAL = ' '
AND AOM1.AOM_CODAGR = '000112'
AND AOM1.AOM_CODNIV = ADY_XMODAL
AND AOM1.D_E_L_E_T_ = ' '
LEFT JOIN AOV000 AOV ON AOV_FILIAL = ' '
AND AOV_CODSEG = A1_CODSEG
AND AOV_PAI = ' '
AND SA1.D_E_L_E_T_= ' '
WHERE AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND ADY_STATUS = 'K'
AND AD1_DATA BETWEEN @I_DATA@ AND @F_DATA@
AND ADY_XMODAL IN ('0076 ','0077','0078','0079','0266','0084','0085','0086','0263','0033','0034','0168','0169','0337','0343','0342','0272','0304');;
CRM016;PROSPECTS  SAUDE / EDUCACIONAL;73;20190211;;18;2;;0;;;;2;47;;;1;2;0;;;1;;SELECT DISTINCT

'PROSPECT' AS ENTIDADE
,US_COD AS COD_CLI
,US_NOME AS NOME_CLI
,US_NREDUZ AS N_FANTASIA
,US_CGC
,US_MUN
,US_EST
,US_CNAE
,CC3_DESC
,US_CODSEG
,AOV1.AOV_DESSEG AS DESSEG
,US_XCODSUB
,AOV2.AOV_DESSEG AS DESSUB
,A3_UNIDAD AS COD_UND
,ADK1.ADK_NOME AS NOME_UND
,US_CODTER
,ADK2.ADK_NOME AS NOME_TER
,US_VEND AS COD_EAR
,A3_NOME AS NOME_EAR

FROM SUS000 SUS

LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' '
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = US_CODSEG
AND AOV1.AOV_PAI = ' '

LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' '
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = US_XCODSUB
AND AOV2.AOV_PAI = US_CODSEG

LEFT JOIN CC3000 CC3 ON CC3_FILIAL = ' '
AND CC3.D_E_L_E_T_ = ' '
AND CC3_COD = US_CNAE

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = US_VEND

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK1 ON ADK1.ADK_FILIAL = ' '
AND ADK1.D_E_L_E_T_ = ' '
AND ADK1.ADK_COD = A3_UNIDAD

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK2 ON ADK2.ADK_FILIAL = ' '
AND ADK2.D_E_L_E_T_ = ' '
AND ADK2.ADK_COD = US_CODTER

WHERE US_FILIAL = ' '
AND SUS.D_E_L_E_T_ = ' '
AND NOT EXISTS (SELECT A1_COD FROM SA1000 SA1 WHERE A1_FILIAL= ' ' AND A1_CGC = US_CGC AND SA1.D_E_L_E_T_=' ')
AND US_CODSEG IN ('000004','000003');;
CRM017;EXC. TERRIT. CLIENTES TSE401;73;20190211;;20;2;;0;;;;2;48;;;1;2;0;;;1;;SELECT DISTINCT
A1_COD
,A1_NOME
,A1_CGC
,A1_VEND
,A3_NOME
,A3_UNIDAD
,ADK1.ADK_NOME AS N_UNID
,A1_XTERRI
,ADK2.ADK_NOME AS N_ETERRI1
,ZS6_EXCETR
,ADK3.ADK_NOME AS N_ETERRI2
,CASE
WHEN ZS6_TIPOCM = '1' THEN 'Recorrentes'
WHEN ZS6_TIPOCM = '2' THEN 'Todos'
WHEN ZS6_TIPOCM = '3' THEN 'Todos Cli Novo'
END AS ZS6_TIPOCM
,ZS6_VIGDE
,ZS6_VIGATE

FROM SA1000 SA1

INNER JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = A1_VEND

INNER JOIN AZS000 AZS ON AZS_FILIAL = ' '
AND AZS.D_E_L_E_T_ = ' '
AND AZS_VEND = A3_COD

INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK1 ON ADK1.ADK_FILIAL = ' '
AND ADK1.D_E_L_E_T_ = ' '
AND ADK1.ADK_COD = AZS_CODUND

LEFT JOIN ZS6000 ZS6 ON ZS6_FILIAL = ' '
AND ZS6.D_E_L_E_T_ = ' '
AND ZS6_CODCLI = A1_COD

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK2 ON ADK2.ADK_FILIAL = ' '
AND ADK2.D_E_L_E_T_ = ' '
AND ADK2.ADK_COD = A1_XTERRI

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK3 ON ADK3.ADK_FILIAL = ' '
AND ADK3.D_E_L_E_T_ = ' '
AND ADK3.ADK_COD = ZS6_EXCETR

WHERE A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND AZS_CODUND = 'TSE401';;
CRM018;MODELOS DE SERVIÇOS;73;20190221;;2;2;;0;;;;2;49;;;1;2;0;;;1;;SELECT DISTINCT
Z7_CODIGO
,Z7_DESCRI
,Z7_CATEG
,AOM_DESCRI DESC_NIV
,AF1_ORCAME
,AF1_DESCRI
,AF51.AF5_DESCRI AS EDT1
,AF52.AF5_DESCRI AS EDT2
,AF53.AF5_DESCRI AS EDT3
,AF2_TAREFA
,AF2_DESCRI
,AF3_PRODUT
,B1_DESC
,AF3_QUANT
,AF3_FATOR
,B1_PRV1
,AF1_XMDIMP
,AG1_DESCRI NOME_MOD

FROM SZ7000X SZ7

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' ' 
AND AOM_CODAGR = '000112' 
AND AOM_CODNIV = Z7_CATEG 
AND AOM.D_E_L_E_T_ = ' '

LEFT JOIN AF1000 AF1 ON AF1_FILIAL = ' ' 
AND AF1_XGRUPO = Z7_CODIGO 
AND AF1.D_E_L_E_T_ = ' '

LEFT JOIN AF5000 AF51 ON AF51.AF5_FILIAL = ' ' 
AND AF51.AF5_EDTPAI = AF1_ORCAME
AND AF51.AF5_VERSAO = AF1_VERSAO
AND AF51.AF5_NIVEL = '002' 
AND AF51.D_E_L_E_T_ = ' '

LEFT JOIN AF5000 AF52 ON AF52.AF5_FILIAL = ' ' 
AND AF52.AF5_ORCAME = AF1_ORCAME
AND AF52.AF5_VERSAO = AF1_VERSAO
AND AF52.AF5_EDTPAI = AF51.AF5_EDT 
AND (AF52.AF5_NIVEL = '002' OR AF52.AF5_NIVEL = '003' OR AF52.AF5_NIVEL = '004') 
AND AF52.D_E_L_E_T_ = ' '

LEFT JOIN AF5000 AF53 ON AF53.AF5_FILIAL = ' ' 
AND AF53.AF5_ORCAME = AF1_ORCAME 
AND AF53.AF5_VERSAO = AF1_VERSAO
AND AF53.AF5_EDTPAI = AF52.AF5_EDT 
AND (AF53.AF5_NIVEL = '004' OR AF53.AF5_NIVEL = '005') 
AND AF53.D_E_L_E_T_ = ' '

LEFT JOIN AF2000 AF2 ON AF2_FILIAL = ' ' 
AND AF2_ORCAME = AF1_ORCAME 
AND AF1_VERSAO = AF1_VERSAO
AND (((AF2_EDTPAI = AF51.AF5_EDT OR AF2_EDTPAI = AF52.AF5_EDT OR AF2_EDTPAI = AF53.AF5_EDT) 
AND (AF2_NIVEL = '002' OR AF2_NIVEL = '003' or AF2_NIVEL = '004' or AF2_NIVEL = '005')) OR AF2_NIVEL = '002') 
AND AF2.D_E_L_E_T_ = ' '

LEFT JOIN AF3000 AF3 ON AF3_FILIAL = ' ' 
AND AF3_ORCAME = AF1_ORCAME
AND AF3_VERSAO = AF1_VERSAO 
AND AF3_TAREFA = AF2_TAREFA 
AND AF3.D_E_L_E_T_ = ' '

LEFT JOIN SB1000 SB1 ON B1_FILIAL = ' ' 
AND B1_COD = AF3_PRODUT 
AND SB1.D_E_L_E_T_ = ' '

LEFT JOIN AG1000 AG1 ON AG1_FILIAL = ' ' 
AND AG1_CODIGO = AF1_XMDIMP 
AND AG1.D_E_L_E_T_ = ' '

WHERE Z7_FILIAL = ' ' 
AND SZ7.D_E_L_E_T_ = ' '
AND Z7_CATEG BETWEEN @I_CODIGO@ AND @F_CODIGO@;;
CRM019;ANALISE DE SMS FATURADO POR LINHA DE RECEITA E PRO;73;20190225;;4;2;;0;;;;2;50;;;1;2;0;;;1;;SELECT DISTINCT
A1_COD
,A1_NOME
,A1_CGC
,A1_VEND
,A3_NOME
,AZS_CODUND
,ADK_NOME
,CNB_PROPOS
,ADY_XMODAL
,CASE
WHEN ADY_XTPVEN = '1' THEN 'Aluguel de Software'
WHEN ADY_XTPVEN = '2' THEN 'Venda Tradicional'
WHEN ADY_XTPVEN = '3' THEN 'Corporativo'
WHEN ADY_XTPVEN = '4' THEN 'Migracao'
WHEN ADY_XTPVEN = '5' THEN 'Troca de Licenca'
WHEN ADY_XTPVEN = '6' THEN 'Renovacao'
WHEN ADY_XTPVEN = '7' THEN 'Totvs Store'
WHEN ADY_XTPVEN = '8' THEN 'Intera'
WHEN ADY_XTPVEN = '9' THEN 'Intera Ilimitado'
END AS DESCXTPVEN
,AOM1.AOM_DESCRI AS DESCNIV
,CNA_PICPAD
,AOM2.AOM_DESCRI AS DESCPICPAD
,CNB_NUMERO
,CNB_ITEM
,CNB_PRODUT
,CNB_DESCRI
,CNB_QUANT
,CNB_VLTOT
,CASE
WHEN CNB_SITUAC = 'A' THEN 'ATIVO'
WHEN CNB_SITUAC = 'S' THEN 'SUSPENSO'
WHEN CNB_SITUAC = 'C' THEN 'CANCELADO'
WHEN CNB_SITUAC = 'G' THEN 'GRATUITO'
WHEN CNB_SITUAC = 'P' THEN 'PENDENTE'
WHEN CNB_SITUAC = 'M' THEN 'MANUAL'
END AS SITUACAO
,CNB_XCOMPE
,PH4_CMPINI
,PH4_CMPFIM
FROM SA1000 SA1
INNER JOIN CN9000 CN9 ON CN9_FILIAL = ' '
AND CN9.D_E_L_E_T_ = ' '
AND CN9_NUMERO = CONCAT('CON',A1_COD)
AND CN9_SITUAC = '05'
AND CN9_ESPCTR = '2'
AND CN9_REVATU = ' '
INNER JOIN CNA000 CNA ON CNA_FILIAL = ' '
AND CNA.D_E_L_E_T_ = ' '
AND CNA_CONTRA = CN9_NUMERO
AND CNA_REVISA = CN9_REVISA
INNER JOIN CNB000 CNB ON CNB_FILIAL = ' '
AND CNB.D_E_L_E_T_ = ' '
AND CNB_CONTRA = CNA_CONTRA
AND CNB_REVISA = CNA_REVISA
AND CNB_NUMERO = CNA_NUMERO
INNER JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = A1_VEND
INNER JOIN AZS000 AZS ON AZS_FILIAL = ' '
AND AZS.D_E_L_E_T_ = ' '
AND AZS_VEND = A1_VEND
INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = AZS_CODUND
LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_PROPOS = CNB_PROPOS
AND ADY_PREVIS = CNB_PROREV
LEFT JOIN AOM000 AOM1 ON AOM1.AOM_FILIAL = ' '
AND AOM1.D_E_L_E_T_ = ' '
AND AOM1.AOM_CODAGR = '000112'
AND AOM1.AOM_CODNIV = ADY_XMODAL
LEFT JOIN AOM000 AOM2 ON AOM2.AOM_FILIAL = ' '
AND AOM2.D_E_L_E_T_ = ' '
AND AOM2.AOM_CODAGR = '000001'
AND AOM2.AOM_CODNIV = CNA_PICPAD
LEFT JOIN PH4000 PH4 ON PH4_FILIAL = ' '
AND PH4.D_E_L_E_T_ = ' '
AND PH4_CONTRA = CNB_CONTRA
AND PH4_REVISA = CNB_REVISA
AND PH4_NUMERO = CNB_NUMERO
AND PH4_ITEM = CNB_ITEM
WHERE A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND AZS_CODUND = 'TSE400'
AND CNB_SITUAC <> 'C'
AND (AOM2.AOM_DESCRI LIKE '%SAAS%' OR AOM2.AOM_DESCRI LIKE '%SMS%')
ORDER BY A1_COD, CNB_NUMERO, CNB_ITEM
;;
CRM020;LOG DE EXCEÇÕES;73;20190401;;2;2;;0;;;;2;51;;;1;2;0;;;1;;SELECT PNT_ALIAS,
				PNT_CHAVE,
				PNT_CODUSR,
				PNT_NMUSER,
				PNT_HORA,
				PNT_DATA,
				PNT_EMUSER,
				PNT_REVISA,
				PO4_DESCRI,
				PNT_PRODUT,
				ZX5_DESCRI, 
PNT.R_E_C_N_O_ AS PNTRECNO
		FROM PNT000 PNT

		LEFT JOIN PO4000 PO4
		ON PO4_FILIAL = ' '
		AND PO4_CODIGO = PNT_REVISA
		AND PO4.D_E_L_E_T_ = ' ' 

		LEFT JOIN ZX5000 ZX5 
		ON ZX5_FILIAL = ' ' 
		AND ZX5_TABELA = 'CATEXC'
		AND ZX5_CHAVE = PNT_PRODUT
		AND ZX5.D_E_L_E_T_ = ' ' 

		WHERE PNT_FILIAL= ' ' 
		AND PNT_ALIAS='EXC'
		AND PNT_DATA BETWEEN @I_DATA@ AND @F_DATA@
		AND PNT.D_E_L_E_T_ = ' ';;
CRM021;PREV. VENDAS. AGRUPADORES;73;20190509;;7;2;;0;;;;2;52;;;1;2;0;;;1;;SELECT DISTINCT
'CLIENTE' AS ENTIDADE
,AD1_NROPOR
,AD1_DESCRI
,AD1_DATA
,AD1_DTPFIM
,AD1_DTFIM
,AD1_RCINIC
,AD1_XVLDSA
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTO'
WHEN AD1_STATUS = '9' THEN 'GANHA'
WHEN AD1_STATUS = '2' THEN 'PERDIDA'
END AS AD1_STATUS
,ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS ADY_STATUS
,A1_COD
,A1_NOME
,A1_CGC
,A1_CODSEG
,AOV1.AOV_DESSEG AS DESSEG
,A1_XCODSUB
,AOV2.AOV_DESSEG AS DESSUB
,A1_VEND
,SA31.A3_NOME AS NOMEESN
,A1_XGAR
,SA32.A3_NOME AS NOMEGAR
,A1_CODMEMB
,ADK_NOME
,CASE
WHEN AD1_FEELIN = '1' THEN '30%'
WHEN AD1_FEELIN = '2' THEN '60%'
WHEN AD1_FEELIN = '3' THEN '90%'
END AS AD1_FEELIN
,AC2_DESCRI
,'000112' AS ADJ_CODAGR
,ADJ_CODNIV
,AOM_DESCRI
,AD1_FCS
,ZX51.ZX5_DESCRI AS DESC_FCS
,AD1_FCI
,ZX52.ZX5_DESCRI AS DESC_FCI
FROM SA1000 SA1
INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND AD1_CODCLI = A1_COD
INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' '
AND ADJ.D_E_L_E_T_ = ' '
AND ADJ_NROPOR = AD1_NROPOR
AND ADJ_REVISA = AD1_REVISA
AND ADJ_CODAGR = '000112'
INNER JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = ADJ_CODAGR
AND AOM_CODNIV = ADJ_CODNIV
LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_OPORTU = AD1_NROPOR
AND ADY_REVISA = AD1_REVISA
INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = A1_CODMEMB
LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' '
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = A1_CODSEG
AND AOV1.AOV_PAI = ' '
LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' '
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = A1_XCODSUB
AND AOV2.AOV_PAI = A1_CODSEG
LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' '
AND SA31.D_E_L_E_T_ = ' '
AND SA31.A3_COD = A1_VEND
LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' '
AND SA32.D_E_L_E_T_ = ' '
AND SA32.A3_COD = A1_XGAR
LEFT JOIN ZX5000 ZX51 ON ZX51.ZX5_FILIAL = ' '
AND ZX51.D_E_L_E_T_ = ' '
AND ZX51.ZX5_TABELA = 'CRM001'
AND ZX51.ZX5_CHAVE = AD1_FCS
LEFT JOIN ZX5000 ZX52 ON ZX52.ZX5_FILIAL = ' '
AND ZX52.D_E_L_E_T_ = ' '
AND ZX52.ZX5_TABELA = 'CRM003'
AND ZX52.ZX5_CHAVE = AD1_FCI
LEFT JOIN AC2000 AC2 ON AC2_FILIAL = ' '
AND AC2.D_E_L_E_T_ = ' '
AND AC2_PROVEN = '000002'
AND AC2_STAGE = AD1_STAGE
WHERE A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND ADY_XMODAL IN ('0076','0084','0085','0086','0192','0198','0208','0209','0210','0258','0263','0275','0354')
AND A1_CODMEMB BETWEEN @I_UNID@ AND @F_UNID@
AND A1_VEND BETWEEN @I_VEND@ AND @F_VEND@
AND AD1_DTPFIM BETWEEN @I_DTPFIM@ AND @F_DTPFIM@

UNION ALL

SELECT DISTINCT
'PROSPECT' AS ENTIDADE
,AD1_NROPOR
,AD1_DESCRI
,AD1_DATA
,AD1_DTPFIM
,AD1_DTFIM
,AD1_RCINIC
,AD1_XVLDSA
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTO'
WHEN AD1_STATUS = '9' THEN 'GANHA'
WHEN AD1_STATUS = '2' THEN 'PERDIDA'
END AS AD1_STATUS
,ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS ADY_STATUS
,US_COD
,US_NOME
,US_CGC
,US_CODSEG
,AOV1.AOV_DESSEG AS DESSEG
,US_XCODSUB
,AOV2.AOV_DESSEG AS DESSUB
,US_VEND
,SA31.A3_NOME AS NOMEESN
,US_XGAR
,SA32.A3_NOME AS NOMEGAR
,US_CODMEMB
,ADK_NOME
,CASE
WHEN AD1_FEELIN = '1' THEN '30%'
WHEN AD1_FEELIN = '2' THEN '60%'
WHEN AD1_FEELIN = '3' THEN '90%'
END AS AD1_FEELIN
,AC2_DESCRI
,'000112' AS ADJ_CODAGR
,ADJ_CODNIV
,AOM_DESCRI
,AD1_FCS
,ZX51.ZX5_DESCRI AS DESC_FCS
,AD1_FCI
,ZX52.ZX5_DESCRI AS DESC_FCI
FROM SUS000 SUS
INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND AD1_PROSPE = US_COD
INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' '
AND ADJ.D_E_L_E_T_ = ' '
AND ADJ_NROPOR = AD1_NROPOR
AND ADJ_REVISA = AD1_REVISA
AND ADJ_CODAGR = '000112'
INNER JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = ADJ_CODAGR
AND AOM_CODNIV = ADJ_CODNIV
LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_OPORTU = AD1_NROPOR
AND ADY_REVISA = AD1_REVISA
INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = US_CODMEMB
LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' '
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = US_CODSEG
AND AOV1.AOV_PAI = ' '
LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' '
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = US_XCODSUB
AND AOV2.AOV_PAI = US_CODSEG
LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' '
AND SA31.D_E_L_E_T_ = ' '
AND SA31.A3_COD = US_VEND
LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' '
AND SA32.D_E_L_E_T_ = ' '
AND SA32.A3_COD = US_XGAR
LEFT JOIN ZX5000 ZX51 ON ZX51.ZX5_FILIAL = ' '
AND ZX51.D_E_L_E_T_ = ' '
AND ZX51.ZX5_TABELA = 'CRM001'
AND ZX51.ZX5_CHAVE = AD1_FCS
LEFT JOIN ZX5000 ZX52 ON ZX52.ZX5_FILIAL = ' '
AND ZX52.D_E_L_E_T_ = ' '
AND ZX52.ZX5_TABELA = 'CRM003'
AND ZX52.ZX5_CHAVE = AD1_FCI
LEFT JOIN AC2000 AC2 ON AC2_FILIAL = ' '
AND AC2.D_E_L_E_T_ = ' '
AND AC2_PROVEN = '000002'
AND AC2_STAGE = AD1_STAGE
WHERE US_FILIAL = ' '
AND SUS.D_E_L_E_T_ = ' '
AND US_STATUS <> '6'
AND ADY_XMODAL IN ('0076','0084','0085','0086','0192','0198','0208','0209','0210','0258','0263','0275','0354')
AND US_CODMEMB BETWEEN @I_UNID@ AND @F_UNID@
AND US_VEND BETWEEN @I_VEND@ AND @F_VEND@
AND AD1_DTPFIM BETWEEN @I_DTPFIM@ AND @F_DTPFIM@;;
CRM022;PROPOSTAS POR PRODUTOS;73;20190509;;15;2;;0;;;;2;53;;;1;2;0;;;1;;SELECT DISTINCT
ADY_PROPOS
,ADY_DATA
,ADY_OPORTU
,ADY_XMODAL
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS STAT_PROP
,CASE
WHEN ADY_XTPINT = '1' THEN 'Novos'  
WHEN ADY_XTPINT = '2' THEN 'Base'
WHEN ADY_XTPINT = '3' THEN 'Migração' 
WHEN ADY_XTPINT = '4' THEN 'Base Migração' 
END AS TIPO
,ADY_DTUPL
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_QTDVEN
,ADZ_PRCVEN
,ADZ_TOTAL
,ZAV_METRIC
,ADZ_XVLINT
,ADZ_XINCRC
,ADZ_XVCTTT
,ADZ_XVCTRJ
,AOV_1.AOV_DESSEG AS SEG_TOTVS
,AOV_2.AOV_DESSEG AS SEG_INTERA
,A3_UNIDAD
,ADK_NOME
,ADY_CODIGO
,A1_NOME NOME_CLI
,A1_CGC
,A3_COD
,A3_NOME
,ADZ_XCOMPE
,CASE
WHEN ADZ_FOLDER = '1' THEN 'Produtos'
WHEN ADZ_FOLDER <> '1' THEN 'Acessorios'
END AS ADZ_FOLDER
,'CLIENTE' AS ENTIDADE

FROM ADY000 ADY
	 
INNER JOIN AD1000 AD1   
ON AD1_FILIAL = ' ' 
AND AD1_NROPOR = ADY_OPORTU  
AND AD1_REVISA = ADY_REVISA  
AND AD1.D_E_L_E_T_ = ' ' 

INNER JOIN ADZ000 ADZ  
ON ADZ_FILIAL = ' ' 
AND ADZ_PROPOS = ADY_PROPOS  
AND ADZ_REVISA = ADY_PREVIS
AND ADZ.D_E_L_E_T_ = ' '  

INNER JOIN SB1000 SB1  
ON B1_FILIAL = ' ' 
AND B1_COD = ADZ_PRODUT   
AND SB1.D_E_L_E_T_ = ' '  

INNER JOIN SA1000 SA1   
ON A1_FILIAL = ' ' 
AND A1_COD = ADY_CODIGO   
AND A1_LOJA = ADY_LOJA   
AND SA1.D_E_L_E_T_ = ' ' 

INNER JOIN AI0000 AI0
ON AI0_FILIAL = ' ' 
AND AI0_CODCLI = A1_COD   
AND AI0_LOJA = A1_LOJA   
AND AI0.D_E_L_E_T_ = ' '     

INNER JOIN SA3000 SA3  
ON A3_FILIAL = ' ' 
AND A3_COD = AD1_VEND    
AND SA3.D_E_L_E_T_ = ' '  

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK  
ON ADK_FILIAL = ' ' 
AND ADK_COD = A3_UNIDAD  
AND ADK.D_E_L_E_T_ = ' '

LEFT JOIN AOV000 AOV_1   
ON AOV_1.AOV_FILIAL = ' ' 
AND AOV_1.AOV_CODSEG = A1_CODSEG
AND AOV_1.AOV_PAI = ' ' 
AND AOV_1.D_E_L_E_T_ = ' ' 

LEFT JOIN AOV000 AOV_2
ON AOV_2.AOV_FILIAL = ' ' 
AND AOV_2.AOV_CODSEG = AI0_XSEGIN
AND AOV_2.D_E_L_E_T_ = ' ' 

LEFT JOIN ZAV000 ZAV ON ZAV_FILIAL = ' ' 
AND ZAV.D_E_L_E_T_ = ' '
AND ZAV_CODIGO = ADY_PROPOS
AND ZAV_VERSAO = ADY_PREVIS

WHERE ADY.D_E_L_E_T_ = ' '
AND ADY_FILIAL = ' ' 
AND ADZ_PRODUT IN ('71A33B5129','71A33B5130','71A33B5131','71A33B5132','71A33B5133','71A33B5142','71A33B5001','71A33B5002','71A33B5003','71A33B5004','71A33B5005','71A33B5006','71A33B5007','71A33B5008','71A33B5009','71A33B5010','71A33B5011','71A33B5012','71A33B5013','71A33B5014','71A33B5015','71A33B5016','71A33B5097','71A33B5098','71A33B5099','71A33B5100','71A33B5101','71A33B5102','71A33B5103','71A33B5104','71A33B5033','71A33B5034','71A33B5035','71A33B5036','71A33B5037','71A33B5038','71A33B5039','71A33B5040','71A33B5049','71A33B5050','71A33B5051','71A33B5052','71A33B5053','71A33B5054','71A33B5055','71A33B5056','71A33B5057','71A33B5058','71A33B5059','71A33B5060','71A33B5061','71A33B5062','71A33B5063','71A33B5064','71A33B5073','71A33B5074','71A33B5075','71A33B5076','71A33B5077','71A33B5078','71A33B5079','71A33B5080','71A33B5081','71A33B5082','71A33B5083','71A33B5084','71A33B5085','71A33B5086','71A33B5087','71A33B5088','71A33B5025','71A33B5026','71A33B5027','71A33B5028','71A33B5029','71A33B5030','71A33B5031','71A33B5032','71A33B5105','71A33B5106','71A33B5107','71A33B5108','71A33B5109','01A33B5001','01A33B5002','01A33B5003','01A33B5004','01A33B5005','01A33B5006','01A33B5007','01A33B5008','01A33B5009','01A33B5010','01A33B5011','01A33B5012','01A33B5013','01A33B5014','01A33B5015','01A33B5016','01A33B5097','01A33B5098','01A33B5099','01A33B5100','01A33B5101','01A33B5102','01A33B5103','01A33B5104','01A33B5033','01A33B5034','01A33B5035','01A33B5036','01A33B5037','01A33B5038','01A33B5039','01A33B5040','01A33B5049','01A33B5050','01A33B5051','01A33B5052','01A33B5053','01A33B5054','01A33B5055','01A33B5056','01A33B5057','01A33B5058','01A33B5059','01A33B5060','01A33B5061','01A33B5062','01A33B5063','01A33B5064','01A33B5073','01A33B5074','01A33B5075','01A33B5076','01A33B5077','01A33B5078','01A33B5079','01A33B5080','01A33B5081','01A33B5082','01A33B5083','01A33B5084','01A33B5085','01A33B5086','01A33B5087','01A33B5088','01A33B5025','01A33B5026','01A33B5027','01A33B5028','01A33B5029','01A33B5030','01A33B5031','01A33B5032','01A33B5105','01A33B5106','01A33B5107','01A33B5108','01A33B5109')
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@

UNION ALL

SELECT DISTINCT
ADY_PROPOS
,ADY_DATA
,ADY_OPORTU
,ADY_XMODAL
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS STAT_PROP
,CASE
WHEN ADY_XTPINT = '1' THEN 'Novos'  
WHEN ADY_XTPINT = '2' THEN 'Base'
WHEN ADY_XTPINT = '3' THEN 'Migração' 
WHEN ADY_XTPINT = '4' THEN 'Base Migração' 
END AS TIPO
,ADY_DTUPL
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_QTDVEN
,ADZ_PRCVEN
,ADZ_TOTAL
,ZAV_METRIC
,ADZ_XVLINT
,ADZ_XINCRC
,ADZ_XVCTTT
,ADZ_XVCTRJ
,AOV_1.AOV_DESSEG AS SEG_TOTVS
,AOV_2.AOV_DESSEG AS SEG_INTERA
,A3_UNIDAD
,ADK_NOME
,ADY_CODIGO
,US_NOME NOME_CLI
,US_CGC
,A3_COD
,A3_NOME
,ADZ_XCOMPE
,CASE
WHEN ADZ_FOLDER = '1' THEN 'Produtos'
WHEN ADZ_FOLDER <> '1' THEN 'Acessorios'
END AS ADZ_FOLDER
,'PROSPECT' AS ENTIDADE

FROM ADY000 ADY
	 
INNER JOIN AD1000 AD1   
ON AD1_FILIAL = ' ' 
AND AD1_NROPOR = ADY_OPORTU  
AND AD1_REVISA = ADY_REVISA  
AND AD1.D_E_L_E_T_ = ' ' 

INNER JOIN ADZ000 ADZ  
ON ADZ_FILIAL = ' ' 
AND ADZ_PROPOS = ADY_PROPOS  
AND ADZ_REVISA = ADY_PREVIS
AND ADZ.D_E_L_E_T_ = ' '  

INNER JOIN SB1000 SB1  
ON B1_FILIAL = ' ' 
AND B1_COD = ADZ_PRODUT   
AND SB1.D_E_L_E_T_ = ' '  

INNER JOIN SUS000 SUS   
ON US_FILIAL = ' ' 
AND US_COD = ADY_CODIGO   
AND US_LOJA = ADY_LOJA   
AND SUS.D_E_L_E_T_ = ' ' 

INNER JOIN SA3000 SA3  
ON A3_FILIAL = ' ' 
AND A3_COD = AD1_VEND    
AND SA3.D_E_L_E_T_ = ' '  

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK  
ON ADK_FILIAL = ' ' 
AND ADK_COD = A3_UNIDAD  
AND ADK.D_E_L_E_T_ = ' '

LEFT JOIN AOV000 AOV_1   
ON AOV_1.AOV_FILIAL = ' ' 
AND AOV_1.AOV_CODSEG = US_CODSEG
AND AOV_1.AOV_PAI = ' ' 
AND AOV_1.D_E_L_E_T_ = ' ' 

LEFT JOIN AOV000 AOV_2
ON AOV_2.AOV_FILIAL = ' ' 
AND AOV_2.AOV_CODSEG = US_XSEGINT
AND AOV_2.D_E_L_E_T_ = ' ' 

LEFT JOIN ZAV000 ZAV ON ZAV_FILIAL = ' ' 
AND ZAV.D_E_L_E_T_ = ' '
AND ZAV_CODIGO = ADY_PROPOS
AND ZAV_VERSAO = ADY_PREVIS

WHERE ADY.D_E_L_E_T_ = ' '
AND ADY_FILIAL = ' ' 
AND ADZ_PRODUT IN ('71A33B5129','71A33B5130','71A33B5131','71A33B5132','71A33B5133','71A33B5142','71A33B5001','71A33B5002','71A33B5003','71A33B5004','71A33B5005','71A33B5006','71A33B5007','71A33B5008','71A33B5009','71A33B5010','71A33B5011','71A33B5012','71A33B5013','71A33B5014','71A33B5015','71A33B5016','71A33B5097','71A33B5098','71A33B5099','71A33B5100','71A33B5101','71A33B5102','71A33B5103','71A33B5104','71A33B5033','71A33B5034','71A33B5035','71A33B5036','71A33B5037','71A33B5038','71A33B5039','71A33B5040','71A33B5049','71A33B5050','71A33B5051','71A33B5052','71A33B5053','71A33B5054','71A33B5055','71A33B5056','71A33B5057','71A33B5058','71A33B5059','71A33B5060','71A33B5061','71A33B5062','71A33B5063','71A33B5064','71A33B5073','71A33B5074','71A33B5075','71A33B5076','71A33B5077','71A33B5078','71A33B5079','71A33B5080','71A33B5081','71A33B5082','71A33B5083','71A33B5084','71A33B5085','71A33B5086','71A33B5087','71A33B5088','71A33B5025','71A33B5026','71A33B5027','71A33B5028','71A33B5029','71A33B5030','71A33B5031','71A33B5032','71A33B5105','71A33B5106','71A33B5107','71A33B5108','71A33B5109','01A33B5001','01A33B5002','01A33B5003','01A33B5004','01A33B5005','01A33B5006','01A33B5007','01A33B5008','01A33B5009','01A33B5010','01A33B5011','01A33B5012','01A33B5013','01A33B5014','01A33B5015','01A33B5016','01A33B5097','01A33B5098','01A33B5099','01A33B5100','01A33B5101','01A33B5102','01A33B5103','01A33B5104','01A33B5033','01A33B5034','01A33B5035','01A33B5036','01A33B5037','01A33B5038','01A33B5039','01A33B5040','01A33B5049','01A33B5050','01A33B5051','01A33B5052','01A33B5053','01A33B5054','01A33B5055','01A33B5056','01A33B5057','01A33B5058','01A33B5059','01A33B5060','01A33B5061','01A33B5062','01A33B5063','01A33B5064','01A33B5073','01A33B5074','01A33B5075','01A33B5076','01A33B5077','01A33B5078','01A33B5079','01A33B5080','01A33B5081','01A33B5082','01A33B5083','01A33B5084','01A33B5085','01A33B5086','01A33B5087','01A33B5088','01A33B5025','01A33B5026','01A33B5027','01A33B5028','01A33B5029','01A33B5030','01A33B5031','01A33B5032','01A33B5105','01A33B5106','01A33B5107','01A33B5108','01A33B5109')
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@;;
CRM023;BASE PROPOSTAS;73;20190517;;21;2;;0;;;;2;54;;;1;2;0;;;1;;SELECT DISTINCT
ADY_PROPOS
,ADY_DATA
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
END AS STAT_PROP
,SA32.A3_NOME
,ADK_COD
,ADK_NOME
,A1_COD
,A1_NOME
,A1_CNAE
,CC3_DESC
,ADZ_PRODUT
,B1_DESC
,ADZ_PRCTAB
,ADZ_PRCVEN
,ADZ_QTDVEN
,ADZ_TOTAL
,ADZ_DT1VEN
,ZXS_IDFLG
,ZXS_STAFLG
,ZXS_CODAPR
,USR_NOME
,SUBSTR(ZT0_CHAVE,1,6) ZT0_CHAVE

FROM AD1000 AD1

INNER JOIN ADY000 ADY ON ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_OPORTU = AD1_NROPOR
AND ADY_REVISA = AD1_REVISA

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_COD = ADY_CODIGO

INNER JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' '
AND SA32.D_E_L_E_T_ = ' '
AND SA32.A3_COD = A1_VEND

INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = A1_CODMEMB

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS

INNER JOIN SB1000 SB1 ON B1_FILIAL = ' '
AND SB1.D_E_L_E_T_ = ' '
AND B1_COD = ADZ_PRODUT

INNER JOIN ZRM000 ZRM ON ZRM_FILIAL = ' ' 
AND ZRM.D_E_L_E_T_ = ' '
AND ZRM_CHAVE = ADY_PROPOS

LEFT JOIN ZXS000 ZXS ON ZXS_FILIAL = ' '
AND ZXS.ZXS_IDPROC = ZRM.ZRM_IDPROC
AND ZXS.ZXS_TPAPRO <> ' '
AND ZXS.ZXS_ITEM = '01'

LEFT JOIN SYS_USR SYS ON SYS.USR_ID = ZXS.ZXS_CODAPR
AND SYS.D_E_L_E_T_ = ' '

LEFT JOIN ZT0000 ZT0 ON ZT0_FILIAL = ' '
AND ZT0.D_E_L_E_T_ = ' '
AND ZT0.ZT0_IDPROC = ZXS.ZXS_IDPROC
AND ZT0.ZT0_RESP = ZXS.ZXS_CODAPR

LEFT JOIN CC3000 CC3 ON CC3_FILIAL = ' '
AND CC3.D_E_L_E_T_ = ' '
AND CC3_COD = A1_CNAE 

WHERE ADY_FILIAL = ' '
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@
AND ADY.D_E_L_E_T_ = ' ';;
CRM024;CLIENTES SAUDE / EDUCACIONAL;73;20190701;;30;2;;0;;;;2;55;;;1;2;0;;;1;;SELECT DISTINCT
'CLIENTE' AS ENTIDADE
,A1_COD AS COD_CLI
,A1_NOME AS NOME_CLI
,A1_NREDUZ AS N_FANTASIA
,A1_CGC
,CASE
WHEN A1_PESSOA = 'J' THEN 'JURIDICA'
WHEN A1_PESSOA = 'F' THEN 'FISICA'
WHEN A1_PESSOA = ' ' THEN 'NAO INFORMADO'
END AS PESSOA
,AI0_XFATAN
,TO_CHAR(AI0_XNFUNC) AS AI0_XNFUNC
,A1_MUN
,A1_EST
,A1_CNAE
,CC3_DESC
,A1_CODSEG
,AOV1.AOV_DESSEG AS DESSEG
,A1_XCODSUB
,AOV2.AOV_DESSEG AS DESSUB
,CASE
WHEN A1_XSITCLI = '1' THEN 'ATIVO'
WHEN A1_XSITCLI = '2' THEN 'INATIVO'
END AS A1_XSITCLI
,A3_UNIDAD AS COD_UND
,ADK1.ADK_NOME AS NOME_UND
,A1_CODTER
,ADK2.ADK_NOME AS NOME_TER
,A1_VEND AS COD_EAR
,A3_NOME AS NOME_EAR
,A1_PRICOM
,CNB_PROPOS AS PROPOSTA
,CNB_ITEM AS ITEM
,CNB_PRODUT AS COD_PROD
,CNB_DESCRI AS DESC_PROD
,CNB_QUANT AS QTDE
,CNB_VLUNIT AS VL_UNIT
,CASE
	WHEN CNB_CONDIC = '00' THEN 'Mensal'
	WHEN CNB_CONDIC = '01' THEN 'Bimestral'
	WHEN CNB_CONDIC = '02' THEN 'Trimestral'
	WHEN CNB_CONDIC = '03' THEN 'Quadrimestral'
	WHEN CNB_CONDIC = '05' THEN 'Semestral'
	WHEN CNB_CONDIC = '11' THEN 'Anual'
	WHEN CNB_CONDIC = '12' THEN 'Bianual'
END AS CNB_CONDIC
,CASE
WHEN CNB_SITUAC = 'A' THEN 'ATIVO'
WHEN CNB_SITUAC = 'S' THEN 'SUSPENSO'
WHEN CNB_SITUAC = 'C' THEN 'CANCELADO'
WHEN CNB_SITUAC = 'G' THEN 'GRATUITO'
WHEN CNB_SITUAC = 'P' THEN 'PENDENTE'
WHEN CNB_SITUAC = 'M' THEN 'MANUAL'
END AS SITUACAO
,ADY_XMODAL
,AOM_DESCRI
,AD1_DTASSI

FROM SA1000 SA1

INNER JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' '
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = A1_CODSEG
AND AOV1.AOV_PAI = ' '

LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' '
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = A1_XCODSUB
AND AOV2.AOV_PAI = A1_CODSEG

LEFT JOIN AI0000 AI0 ON AI0_FILIAL = ' '
AND AI0.D_E_L_E_T_ = ' '
AND AI0_CODCLI = A1_COD

LEFT JOIN CC3000 CC3 ON CC3_FILIAL = ' '
AND CC3.D_E_L_E_T_ = ' '
AND CC3_COD = A1_CNAE

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = A1_VEND

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK1 ON ADK1.ADK_FILIAL = ' '
AND ADK1.D_E_L_E_T_ = ' '
AND ADK1.ADK_COD = A3_UNIDAD

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK2 ON ADK2.ADK_FILIAL = ' '
AND ADK2.D_E_L_E_T_ = ' '
AND ADK2.ADK_COD = A1_CODTER

LEFT JOIN CN9000 CN9 ON CN9_FILIAL = ' '
AND CN9.D_E_L_E_T_ = ' '
AND CN9_NUMERO = CONCAT('CON',A1_COD)
AND CN9_SITUAC = '05'
AND CN9_ESPCTR = '2'
AND CN9_REVATU = ' '

LEFT JOIN CNB000 CNB ON CNB_FILIAL = ' '
AND CNB.D_E_L_E_T_ = ' '
AND CNB_CONTRA = CN9_NUMERO
AND CN9_REVISA = CNB_REVISA
AND CNB_TIPREC = '1'

LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_PROPOS = CNB_PROPOS
AND ADY_PREVIS = CNB_PROREV

LEFT JOIN AD1000 AD1 ON AD1_FILIAL = ' ' 
AND AD1.D_E_L_E_T_ = ' ' 
AND AD1_NROPOR = ADY_OPORTU
AND AD1_REVISA = ADY_REVISA

LEFT JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS

LEFT JOIN SB1000 SB1 ON B1_FILIAL = ' '
AND SB1.D_E_L_E_T_ = ' '
AND B1_COD = CNB_PRODUT

LEFT JOIN SBM000 SBM ON BM_FILIAL = ' '
AND SBM.D_E_L_E_T_ = ' '
AND BM_GRUPO = B1_GRUPO
AND SUBSTR(BM_PICPAD,1,2) = '03'

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = ADY_XMODAL

WHERE A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_CODSEG IN ('000004','000003','000010','000005','000009','000013');;
CRM025;SUSPECTS SAUDE / EDUCACIONAL;73;20190701;;4;2;;0;;;;2;56;;;1;2;0;;;1;;SELECT DISTINCT
'SUSPECT' AS ENTIDADE
,ACH_CODIGO AS COD_CLI
,ACH_RAZAO AS NOME_CLI
,ACH_NFANT AS N_FANTASIA
,ACH_CGC
,CASE
WHEN ACH_PESSOA = 'J' THEN 'JURIDICA'
WHEN ACH_PESSOA = 'F' THEN 'FISICA'
WHEN ACH_PESSOA = ' ' THEN 'NAO INFORMADO'
END AS PESSOA
,ACH_FATANU
,CASE
WHEN ACH_QTFUNC = '0' THEN 'MENOR QUE 50'
WHEN ACH_QTFUNC = '1' THEN '51 A 200'
WHEN ACH_QTFUNC = '2' THEN '201 A 500'
WHEN ACH_QTFUNC = '3' THEN '501 A 1000'
WHEN ACH_QTFUNC = '4' THEN '1001 A 5000'
WHEN ACH_QTFUNC = '5' THEN 'MAIOR QUE 5000'
WHEN ACH_QTFUNC = ' ' THEN 'NAO INFORMADO'
END AS ACH_QTFUNC
,ACH_CIDADE
,ACH_EST
,ACH_CNAE
,CC3_DESC
,ACH_CODSEG
,AOV1.AOV_DESSEG AS AOV_DESSEG
,ACH_XCODSS
,AOV2.AOV_DESSEG AS DESSUB
,A3_UNIDAD AS COD_UND
,ADK1.ADK_NOME AS NOME_UND
,ACH_CODTER
,ADK2.ADK_NOME AS NOME_TER
,ACH_VEND AS COD_EAR
,A3_NOME AS NOME_EAR
,ADY_PROPOS AS PROPOSTA
,ADZ_ITEM AS ITEM
,ADZ_PRODUT AS COD_PROD
,ADZ_DESCRI AS DESC_PROD
,ADZ_QTDVEN AS QTDE
,ADZ_PRCVEN AS VL_UNIT
,'N/D' AS SITUACAO
,ADJ_CODNIV
,AOM_DESCRI

FROM ACH000 ACH

INNER JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' '
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = ACH_CODSEG
AND AOV1.AOV_PAI = ' '

LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' '
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = ACH_XCODSS
AND AOV2.AOV_PAI = ACH_CODSEG

LEFT JOIN CC3000 CC3 ON CC3_FILIAL = ' '
AND CC3.D_E_L_E_T_ = ' '
AND CC3_COD = ACH_CNAE

LEFT JOIN CNA000 CNA ON CNA_FILIAL = ' '
AND CNA.D_E_L_E_T_ = ' '
AND CNA_CLIENT = ACH_CODIGO

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = ACH_VEND

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK1 ON ADK1.ADK_FILIAL = ' '
AND ADK1.D_E_L_E_T_ = ' '
AND ADK1.ADK_COD = A3_UNIDAD

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK2 ON ADK2.ADK_FILIAL = ' '
AND ADK2.D_E_L_E_T_ = ' '
AND ADK2.ADK_COD = ACH_CODTER

LEFT JOIN CN9000 CN9 ON CN9_FILIAL = ' '
AND CN9.D_E_L_E_T_ = ' '
AND CN9_NUMERO = CNA_CONTRA
AND CN9_REVISA = CNA_REVISA
AND CN9_SITUAC = '05'
AND CN9_ESPCTR = '2'
AND CN9_REVATU = ' '

LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_CODIGO = ACH_CODIGO

LEFT JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS

LEFT JOIN SB1000 SB1 ON B1_FILIAL = ' '
AND SB1.D_E_L_E_T_ = ' '
AND B1_COD = ADZ_PRODUT

LEFT JOIN SBM000 SBM ON BM_FILIAL = ' '
AND SBM.D_E_L_E_T_ = ' '
AND BM_GRUPO = B1_GRUPO
AND SUBSTR(BM_PICPAD,1,2) = '03'
AND BM_XGRPREC = '1'

LEFT JOIN ADJ000 ADJ ON ADJ_FILIAL = ' '
AND ADJ.D_E_L_E_T_ = ' '
AND ADJ_NROPOR = ADY_OPORTU
AND ADJ_REVISA = ADY_REVISA

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = ADJ_CODNIV

WHERE ACH_FILIAL = ' '
AND ACH.D_E_L_E_T_ = ' '
AND ACH_CODSEG IN ('000004','000003')
AND ACH_STATUS <> '6';;
CRM026;AGRUPADOR X GRUPO MODELO X ORCAMENTO;73;20190809;;2;2;;0;;;;2;57;;;1;2;0;;;1;;SELECT
Z7_CODIGO
,Z7_DESCRI
,Z7_CATEG
,AOM_DESCRI
,AF1_XGRUPO
,AF1_ORCAME
,AF1_DESCRI

FROM SZ7000X SZ7

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = Z7_CATEG
AND AOM.D_E_L_E_T_ = ' '

LEFT JOIN AF1000 AF1 ON AF1_FILIAL = ' '
AND AF1_XGRUPO = Z7_CODIGO
AND AF1.D_E_L_E_T_ = ' '


WHERE Z7_FILIAL = ' '
AND Z7_CATEG IN ('0002','0051','0054','0055','0061','0062','0063','0064','0065','0066','0067','0253','0277','0068','0185','0187','0216','0252','0052','0069','0070','0071','0072','0073','0074','0053','0075')
AND SZ7.D_E_L_E_T_= ' ';;#6115664
CRM027;CONSULTA PROPOSTA SEM WF;73;20191003;;7;2;;0;;;;2;58;;;1;2;0;;;1;;SELECT

ADY_PROPOS,
ADY_OPORTU,
	CASE
		WHEN ADY_XSTATW = '0' THEN 'Nao possui WF'
	END AS ADY_XSTATW,
ADY_XIDPRC,
ADY_CODIGO,
A1_VEND,
A3_NOME

FROM ADY000 ADY

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_COD = ADY_CODIGO

INNER JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = A1_VEND

WHERE ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_XSTATW = '0'
AND ADY_PROPOS BETWEEN @I_PROPOS@ AND @F_PROPOS@;;
CRM028;SERVIÇOS 0054 0055;73;20191211;;1;2;;0;;;;2;59;;;1;2;0;;;1;;SELECT

ADY_PROPOS,
SUBSTR(ADY_DATA,7,2) || '/' || SUBSTR(ADY_DATA,5,2) || '/' || SUBSTR(ADY_DATA, 1,4) ADY_DATA,
	CASE
		WHEN ADY_STATUS = 'A' THEN 'ABERTO'
		WHEN ADY_STATUS = 'B' THEN 'FECHADA'
		WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
		WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
		WHEN ADY_STATUS = 'E' THEN 'APROVADA'
		WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
		WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
		WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
		WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
		WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
		WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
		WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
		WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
	END AS ADY_STATUS,
ADY_XMLUCR,
ADZ_ITEM,
ADZ_PRODUT,
ADZ_DESCRI,
ADZ_TOTAL,
ADZ_DESCON,
ADZ_VALDES,
AD1_NROPOR,
	CASE
		WHEN AD1_STATUS = '1' THEN 'ABERTO'
		WHEN AD1_STATUS = '2' THEN 'PERDIDO'
		WHEN AD1_STATUS = '3' THEN 'SUSPENSO'
		WHEN AD1_STATUS = '9' THEN 'GANHA'
	END AS AD1_STATUS,
ADY_XUNSRV,
PE1_DESCRI,
ADY_CODIGO,
A1_NOME,
A1_CODMEMB,
ADK_NOME

FROM ADY000 ADY

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS

INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND AD1_NROPOR = ADY_OPORTU

INNER JOIN PE1000 PE1 ON PE1_FILIAL = ' '
AND PE1.D_E_L_E_T_ = ' '
AND PE1_CODIGO = ADY_XUNSRV

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_COD = ADY_CODIGO

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = A1_CODMEMB

WHERE ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_XMODAL IN ('0054', '0055')
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@;;
CRM029;OPORTUNIDADES CLIENTES SAUDE;73;20191230;;36;2;;0;;;;2;60;;;1;2;0;;;1;;<ADVPL>IF(_ENTIDA = "2","SELECT 'CLIENTE' AS ENTIDADE, AD1_NROPOR, AD1_DESCRI, ADJ_CODNIV, AOM_DESCRI, AD1_STAGE, AD1_DTASSI, AD1_CODCLI, A1_NOME AS NOMECLI, A1_CGC AS A1_CGC, A1_CODMEMB AS UNIDADE, ADK1.ADK_NOME AS UNI_NOME, A1_CODTER AS TERRIT, ADK2.ADK_NOME AS NOM_TERR, A1_MUN AS MUNICIP, A1_EST AS ESTADO, A1_END AS ENDERECO, AD1_VEND, A3_NOME, CASE  WHEN AD1_STATUS = '1' THEN 'ABERTO'  WHEN AD1_STATUS = '2' THEN 'PERDIDO'  WHEN AD1_STATUS = '3' THEN 'SUSPENSO'  WHEN AD1_STATUS = '9' THEN 'GANHA' END AS AD1_STATUS, AD1_DTPFIM, CASE	  WHEN AD1_FEELIN = '1' THEN '30%'  WHEN AD1_FEELIN = '2' THEN '60%'  WHEN AD1_FEELIN = '3' THEN '90%' END AS AD1_FEELIN, AD1_RCINIC, AD1_XVLDSA, AD1_DTINI, AD1_DTFIM, AD1_DATA, AD1_DTPENC, AD1_PRIOR  FROM AD1000 AD1  INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' ' AND ADJ.D_E_L_E_T_ = ' ' AND ADJ_NROPOR = AD1_NROPOR AND ADJ_REVISA = AD1_REVISA  INNER JOIN AOM000 AOM ON AOM_FILIAL = ' ' AND AOM.D_E_L_E_T_ = ' ' AND AOM_CODAGR = '000112' AND AOM_CODNIV = ADJ_CODNIV  INNER JOIN SA1000 SA1 ON A1_FILIAL = ' ' AND SA1.D_E_L_E_T_ = ' ' AND A1_COD = AD1_CODCLI  INNER JOIN ADK000 ADK1 ON ADK1.ADK_FILIAL = ' ' AND ADK1.D_E_L_E_T_ = ' ' AND ADK1.ADK_COD = A1_CODMEMB  INNER JOIN ADK000 ADK2 ON ADK2.ADK_FILIAL = ' ' AND ADK2.D_E_L_E_T_ = ' ' AND ADK2.ADK_COD = A1_CODTER  INNER JOIN SA3000 SA3 ON A3_FILIAL = ' ' AND SA3.D_E_L_E_T_ = ' ' AND A3_COD = AD1_VEND  WHERE AD1_FILIAL = ' ' AND AD1.D_E_L_E_T_ = ' ' AND A1_CODSEG = '000004' AND AD1_DATA BETWEEN @I_DATA@ AND @F_DATA@","SELECT 'PROSPECT' AS ENTIDADE, AD1_NROPOR, AD1_DESCRI, ADJ_CODNIV, AOM_DESCRI, AD1_STAGE, AD1_DTASSI, AD1_CODCLI, US_NOME AS NOMECLI, US_CGC AS A1_CGC, US_CODMEMB AS UNIDADE, ADK1.ADK_NOME AS UNI_NOME, US_CODTER AS TERRIT, ADK2.ADK_NOME AS NOM_TERR, US_MUN AS MUNICIP, US_EST AS ESTADO, US_END AS ENDERECO, AD1_VEND, A3_NOME, CASE  WHEN AD1_STATUS = '1' THEN 'ABERTO'  WHEN AD1_STATUS = '2' THEN 'PERDIDO'  WHEN AD1_STATUS = '3' THEN 'SUSPENSO'  WHEN AD1_STATUS = '9' THEN 'GANHA' END AS AD1_STATUS, AD1_DTPFIM, CASE	  WHEN AD1_FEELIN = '1' THEN '30%'  WHEN AD1_FEELIN = '2' THEN '60%'  WHEN AD1_FEELIN = '3' THEN '90%' END AS AD1_FEELIN, AD1_RCINIC, AD1_XVLDSA, AD1_DTINI, AD1_DTFIM, AD1_DATA, AD1_DTPENC, AD1_PRIOR  FROM AD1000 AD1  INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' ' AND ADJ.D_E_L_E_T_ = ' ' AND ADJ_NROPOR = AD1_NROPOR AND ADJ_REVISA = AD1_REVISA  INNER JOIN AOM000 AOM ON AOM_FILIAL = ' ' AND AOM.D_E_L_E_T_ = ' ' AND AOM_CODAGR = '000112' AND AOM_CODNIV = ADJ_CODNIV  INNER JOIN SUS000 SUS ON US_FILIAL = ' ' AND SUS.D_E_L_E_T_ = ' ' AND US_COD = AD1_PROSPE  INNER JOIN ADK000 ADK1 ON ADK1.ADK_FILIAL = ' ' AND ADK1.D_E_L_E_T_ = ' ' AND ADK1.ADK_COD = US_CODMEMB  INNER JOIN ADK000 ADK2 ON ADK2.ADK_FILIAL = ' ' AND ADK2.D_E_L_E_T_ = ' ' AND ADK2.ADK_COD = US_CODTER  INNER JOIN SA3000 SA3 ON A3_FILIAL = ' ' AND SA3.D_E_L_E_T_ = ' ' AND A3_COD = AD1_VEND  WHERE AD1_FILIAL = ' ' AND AD1.D_E_L_E_T_ = ' ' AND US_CODSEG = '000004' AND AD1_DATA BETWEEN @I_DATA@ AND @F_DATA@ AND NOT EXISTS (SELECT A1_COD FROM SA1000 SA1 WHERE A1_FILIAL= ' ' AND A1_CGC = US_CGC AND SA1.D_E_L_E_T_=' ')")</ADVPL>;;
CRM030;REALIZADO DE VENDAS SEGMENTO DE SAÚDE;73;20200107;;6;2;;0;;;;2;61;;;1;2;0;;;1;;SELECT DISTINCT

ADY_PROPOS,
CASE
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA' 
END AS STATUS,
A1_COD,
A1_CODSEG,
AOV_DESSEG,
A1_CODMEMB,
ADK1.ADK_NOME,
A1_CODTER,
ADK2.ADK_NOME,
ADY_DTUPL,
ADZ_PRODUT,
ADZ_DESCRI,
ADZ_QTDVEN,
ADZ_PRCVEN,
ADZ_TOTAL,
CASE
	WHEN CNB_TIPREC = '1' THEN 'Recorrente'
	WHEN CNB_TIPREC <> '1' THEN 'Pontual'
END AS TpReceita

FROM ADY000 ADY

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_COD = ADY_CODIGO
AND A1_CODSEG = '000004'

INNER JOIN AOV000 AOV ON AOV_FILIAL = ' '
AND AOV.D_E_L_E_T_ = ' '
AND AOV_CODSEG = A1_CODSEG

INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK1 ON ADK1.ADK_FILIAL = ' '
AND ADK1.D_E_L_E_T_ = ' '
AND ADK1.ADK_COD =  A1_CODMEMB

INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK2 ON ADK2.ADK_FILIAL = ' '
AND ADK2.D_E_L_E_T_ = ' '
AND ADK2.ADK_COD = A1_CODTER

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS 

INNER JOIN CN9000 CN9 ON CN9_FILIAL = ' '
AND CN9.D_E_L_E_T_ = ' '
AND CN9_NUMERO = CONCAT('CON',A1_COD)
AND CN9_SITUAC = '05'
AND CN9_REVATU = ' '
AND CN9_ESPCTR = '2'

INNER JOIN CNB000 CNB ON CNB_FILIAL = ' '
AND CNB.D_E_L_E_T_ = ' '
AND CNB_CONTRA = CN9_NUMERO
AND CNB_REVISA = CN9_REVISA

WHERE ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_DATA >= '20190101'
AND ADY_STATUS IN  ('I', 'J', 'K', 'Z')

ORDER BY ADY_PROPOS;;
CRM031;PROPOSTAS PARTICIPATIVO;73;20200131;;2;2;;0;;;;2;62;;;1;2;0;;;1;;SELECT

AD1_NROPOR,
CASE
	WHEN AD1_STATUS = '1' THEN 'ABERTO'
	WHEN AD1_STATUS = '2' THEN 'PERDIDO'
	WHEN AD1_STATUS = '3' THEN 'SUSPENSO'
	WHEN AD1_STATUS = '9' THEN 'GANHA'
END AS STATUS,
ADY_PROPOS,
CASE
	WHEN ADY_STATUS = 'A' THEN 'ABERTO'
	WHEN ADY_STATUS = 'B' THEN 'FECHADA'
	WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
	WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
	WHEN ADY_STATUS = 'E' THEN 'APROVADA'
	WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
	WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
	WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
	WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
	WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
	WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
	WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
	WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
END AS ADY_STATUS,
ADY_CODIGO,
A1_NOME,
A1_CODMEMB,
ADK_NOME,
A1_CODSEG,
AOV_DESSEG,
ADZ_PRODUT,
ADZ_DESCRI,
ADZ_QTDVEN,
ADZ_PRCVEN,
ADZ_TOTAL,
ADY_DTUPL,
ADY_XUNSRV,
ADY_VEND,
A3_NOME

FROM AD1000 AD1

INNER JOIN ADY000 ADY ON ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_OPORTU = AD1_NROPOR

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_COD = ADY_CODIGO

INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = A1_CODMEMB

INNER JOIN AOV000 AOV ON AOV_FILIAL = ' '
AND AOV.D_E_L_E_T_ = ' '
AND AOV_CODSEG = A1_CODSEG

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_PRODUT = '2012101-3'

INNER JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = ADY_VEND

INNER JOIN AD2000 AD2 ON AD2_FILIAL = ' '
AND AD2.D_E_L_E_T_ = ' '
AND AD2_NROPOR = AD1_NROPOR
AND AD2_REVISA = AD1_REVISA
AND AD2_VEND IN ('T17375','T11670','T19399')

WHERE AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND ADY_XUNSRV IN ('184',
'081',
'118',
'011',
'074',
'076',
'156')
AND ADY_DTUPL BETWEEN @I_DATA@ AND @F_DATA@;;
CRM032;PROPOSTAS SERVICOS 2020;73;20200213;;11;2;;0;;;;2;63;;;1;2;0;;;1;;SELECT

ADY_PROPOS,
ADY_STATUS,
ADZ_PRODUT,
ADZ_DESCRI,
ADZ_TOTAL,
ADY_XMODAL,
AOM_DESCRI,
ADY_DTUPL,
AD1_NROPOR,
AD1_VEND,
A3_NOME AS ESN,
CASE
	WHEN AD1_STATUS = '1' THEN 'ABERTO'
	WHEN AD1_STATUS = '2' THEN 'PERDIDO'
	WHEN AD1_STATUS = '3' THEN 'SUSPENSO'
	WHEN AD1_STATUS = '9' THEN 'GANHA'
END AS AD1_STATUS,
AD2_VEND,
AD2_CODPAP,
UM_DESC

FROM ADY000 ADY

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = '  '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS

INNER JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = ADY_XMODAL

INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND AD1_NROPOR = ADY_OPORTU
AND AD1_REVISA = ADY_REVISA

INNER JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = AD1_VEND

INNER JOIN AD2000 AD2 ON AD2_FILIAL = ' '
AND AD2.D_E_L_E_T_ = ' '
AND AD2_NROPOR = ADY_OPORTU
AND AD2_REVISA = ADY_REVISA

INNER JOIN SUM000 SUM1 ON SUM1.UM_FILIAL = ' '
AND SUM1.D_E_L_E_T_ = ' '
AND SUM1.UM_CARGO = AD2_CODPAP

WHERE ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_STATUS IN ('I','J','K','Z','Y')
AND ADY_XMODAL IN ('0051','0054','0055','0061','0062','0063','0064','0065','0066','0067','0253','0277','0385','0068','0185','0187','0216','0252','0394','0052','0069','0070','0071','0072','0073','0074','0053','0378')
AND ADY_DTUPL BETWEEN @I_DATA@ AND @F_DATA@;;
CRM033;TIME DE VENDAS CRM032;73;20200214;;1;2;;0;;;;2;64;;;1;2;0;;;1;;SELECT

ADY_PROPOS,
ADY_OPORTU,
AD2_VEND,
A3_NOME

FROM ADY000 ADY

INNER JOIN AD2000 AD2 ON AD2_FILIAL = ' '
AND AD2.D_E_L_E_T_ = ' '
AND AD2_NROPOR = ADY_OPORTU
AND AD2_REVISA = ADY_REVISA

INNER JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = AD2_VEND

WHERE ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_XMODAL IN ('0051','0054','0055','0061','0062','0063','0064','0065','0066','0067','0253','0277','0385','0068','0185','0187','0216','0252','0394','0052','0069','0070','0071','0072','0073','0074','0053','0378')
AND ADY_DTUPL BETWEEN @I_DATA@ AND @F_DATA@;;
CRM034;MAPEAMENTO DE PROPOSTAS;73;20200312;;160;2;;0;;;;2;65;;;1;2;0;;;1;;SELECT DISTINCT
ADY_OPORTU
,AD2_VEND AS VENTIME
,SA31.A3_NOME AS NOMETIME
,AD2_CODPAP
,UM_DESC
,AD2_PERC
,AD2_UNIDAD
,ADK3.ADK_NOME AS UNDTIME
,ADY_PROPOS
,CASE
	WHEN ADY_STATUS = 'A' THEN 'ABERTO'
	WHEN ADY_STATUS = 'B' THEN 'FECHADA'
	WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
	WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
	WHEN ADY_STATUS = 'E' THEN 'APROVADA'
	WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
	WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
	WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
	WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
	WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
	WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
	WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
	WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
END AS ADY_STATUS
,DA0_DESCRI
,AOM_DESCRI AS MODAL
,CASE
	WHEN ADY_XTPVEN = '1' THEN '1 - Aluguel de Software'
	WHEN ADY_XTPVEN = '2' THEN '2 - Venda Tradicional'
	WHEN ADY_XTPVEN = '3' THEN '3 - Corporativo'
	WHEN ADY_XTPVEN = '4' THEN '4 - Migracao'
	WHEN ADY_XTPVEN = '5' THEN '5 - Troca de Licenca'
	WHEN ADY_XTPVEN = '6' THEN '6 - Renovacao'
	WHEN ADY_XTPVEN = '7' THEN '7 - Totvs Store'
	WHEN ADY_XTPVEN = '8' THEN '8 - Intera'
	WHEN ADY_XTPVEN = '9' THEN '9 - Intera Ilimitado'
END AS ADY_XTPVEN
,ADY_DTUPL
,ADZ_ITEM
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_CONDPG
,ADZ_DT1VEN
,ADZ_QTDVEN
,ADZ_PRCTAB
,ADZ_PRCVEN
,ADZ_TOTAL
,CASE
	WHEN ADZ_XSITUA = 'F' THEN 'FATURAR'
	WHEN ADZ_XSITUA = 'G' THEN 'GRATUITO'
	WHEN ADZ_XSITUA = 'N' THEN 'NUNCA FATURAR HW'
	WHEN ADZ_XSITUA = 'S' THEN 'SOB CONSUMO'
END AS ADZ_XSITUA
,ADZ_DESCON
,ADZ_XPDEST
,ADZ_XMESDT
,ADZ_XVLTMP
,ADZ_XTPCAR
,ADY_CODIGO
,A1_NOME
,A1_VEND
,SA32.A3_NOME AS NOMEDONO
,A1_CODMEMB
,ADK1.ADK_NOME AS NOMEUNID
,ADK1.ADK_XSUPER AS UNIDRESP
,ADK2.ADK_NOME AS NOMURESP
,ADZ_XCOMPE
,ADZ_XDTVIG
,ADY_XTPINT
,ADZ_XDELTR
,A1_CNAE
,CC3_DESC
,A1_CODSEG
,AOV1.AOV_DESSEG AS DESSEG
,A1_XCODSUB
,AOV2.AOV_DESSEG AS DESSUB

FROM ADY000 ADY

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS

INNER JOIN AD2000 AD2 ON AD2_FILIAL = ' '
AND AD2.D_E_L_E_T_ = ' '
AND AD2_NROPOR = ADY_OPORTU
AND AD2_REVISA = ADY_REVISA

LEFT JOIN SUM000 SUM1 ON SUM1.UM_FILIAL = ' '
AND SUM1.D_E_L_E_T_ = ' '
AND SUM1.UM_CARGO = AD2_CODPAP

LEFT JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_COD = ADY_CODIGO

LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' '
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = A1_CODSEG

LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' '
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = A1_XCODSUB

LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' ' 
AND SA31.D_E_L_E_T_ = ' ' 
AND SA31.A3_COD = AD2_VEND

LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' ' 
AND SA32.D_E_L_E_T_ = ' ' 
AND SA32.A3_COD = A1_VEND

LEFT JOIN ADK000 ADK1 ON ADK1.ADK_FILIAL = ' ' 
AND ADK1.D_E_L_E_T_ = ' ' 
AND ADK1.ADK_COD = A1_CODMEMB

LEFT JOIN ADK000 ADK2 ON ADK2.ADK_FILIAL = ' ' 
AND ADK2.D_E_L_E_T_ = ' ' 
AND ADK2.ADK_COD = ADK1.ADK_XSUPER

LEFT JOIN ADK000 ADK3 ON ADK3.ADK_FILIAL = ' ' 
AND ADK3.D_E_L_E_T_ = ' ' 
AND ADK3.ADK_COD = AD2_UNIDAD

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' ' 
AND AOM.D_E_L_E_T_ = ' ' 
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = ADY_XMODAL

LEFT JOIN DA0000 DA0 ON DA0_FILIAL = ' ' 
AND DA0.D_E_L_E_T_ = ' ' 
AND DA0_CODTAB = ADY_TABELA

LEFT JOIN CC3000 CC3 ON CC3_FILIAL = ' ' 
AND CC3.D_E_L_E_T_ = ' ' 
AND CC3_COD = A1_CNAE

WHERE ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_ENTIDA = '1'
AND ADY_STATUS IN ('I','J','K','Z')
AND AD2_XVERCM = (SELECT MAX(AD2_XVERCM) AS AD2_XVERCM
					FROM AD2000 AD2
					WHERE AD2_FILIAL = ' ' 
					AND AD2.D_E_L_E_T_ = ' ' 
					AND AD2_NROPOR = ADY_OPORTU
					AND AD2_REVISA = ADY_REVISA)
AND ADY_DTUPL BETWEEN @I_DATA@ AND @F_DATA@
<ADVPL>If(_TIME = "1", "AND AD2_CODPAP = '000003'","")</ADVPL>;;
CRM035;PROPOSTAS SERVIÇOS MELHORIA CONTINUA 0064;73;20200316;;11;2;;0;;;;2;66;;;1;2;0;;;1;;SELECT DISTINCT

A1_COD,
A1_NOME,
A1_CODSEG,
AOV_DESSEG,
A1_VEND,
A3_NOME,
ADY_OPORTU,
ADY_PROPOS,
USR_CODIGO,
ADY_DATA,
ADZ_DESCRI,
CASE
	WHEN ADZ_XTPFAT = '1' THEN 'Mensal'
	WHEN ADZ_XTPFAT = '2' THEN 'Bimestral'
	WHEN ADZ_XTPFAT = '3' THEN 'Trimestral'
	WHEN ADZ_XTPFAT = '4' THEN 'Quadrimestral'
	WHEN ADZ_XTPFAT = '5' THEN 'Semestral'
	WHEN ADZ_XTPFAT = '6' THEN 'Anual'
	WHEN ADZ_XTPFAT = '7' THEN 'Sob Consumo'
END AS ADZ_XTPFAT,
CASE
	WHEN ADY_STATUS = 'A' THEN 'ABERTO'
	WHEN ADY_STATUS = 'B' THEN 'FECHADA'
	WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
	WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
	WHEN ADY_STATUS = 'E' THEN 'APROVADA'
	WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
	WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
	WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
	WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
	WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
	WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
	WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
	WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
END AS ADY_STATUS

FROM SA1000 SA1

INNER JOIN AOV000 AOV ON AOV_FILIAL = ' '
AND AOV.D_E_L_E_T_ = ' '
AND AOV_CODSEG = A1_CODSEG

INNER JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = A1_VEND

INNER JOIN ADY000 ADY ON ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_CODIGO = A1_COD
AND ADY_XMODAL = '0064'
AND ADY_DATA >= '20190701'

INNER JOIN SYS_USR SYS ON USR_ID = ADY_USREMI

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS
AND ADZ_PRODUT IN ('1M13301034','1M13301033','1M13301035')

WHERE A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' ';;
CRM036;MAPEAMENTO DE PROPOSTAS;73;20200331;;18;2;;0;;;;2;67;;;1;2;0;;;1;;SELECT

ADY_PROPOS,
ADZ_PRODUT,
ADZ_DESCRI,
ADZ_CONDPG,
ADZ_QTDVEN,
ADZ_PRCTAB,
ADZ_PRCVEN,
ADZ_TOTAL,
ADZ_XSITUA,
ADZ_DESCON,
ADZ_VALDES,
ADZ_XPDEST,
ADZ_XVDEST,
ADZ_XMESDT,
ADZ_XVLTMP,
ADY_STATUS,
ADY_DTUPL,
ADY_DATA,
ADY_OPORTU,
ADY_VEND,
A3_NOME,
A3_CARGO,
A3_UNIDAD,
ADK_NOME,
ADY_CODIGO,
A1_NOME,
A1_CNAE,
CC3_DESC,
A1_CODSEG,
AOV_DESSEG

FROM ADY000 ADY

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS

INNER JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = ADY_VEND
AND A3_CARGO IN ('000003','000004','000459')

INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = A3_UNIDAD

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_COD = ADY_CODIGO

INNER JOIN CC3000 CC3 ON CC3_FILIAL = ' '
AND CC3.D_E_L_E_T_ = ' '
AND CC3_COD = A1_CNAE

INNER JOIN AOV000 AOV ON AOV_FILIAL = ' '
AND AOV.D_E_L_E_T_ = ' '
AND AOV_CODSEG = A1_CODSEG

WHERE ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@;;
CRM037;PROPOSTA SERVICOS MELHORIA CONTINUA 0069;73;20200413;;4;2;;0;;;;2;68;;;1;2;0;;;1;;SELECT DISTINCT

A1_COD,
A1_NOME,
A1_CODSEG,
AOV_DESSEG,
A1_VEND,
A3_NOME,
AD1_NROPOR,
ADY_PROPOS,
ADZ_PRODUT,
ADZ_DESCRI,
ADZ_TOTAL,
USR_CODIGO,
ADY_DATA,
CASE
	WHEN ADY_STATUS = 'A' THEN 'ABERTO'
	WHEN ADY_STATUS = 'B' THEN 'FECHADA'
	WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
	WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
	WHEN ADY_STATUS = 'E' THEN 'APROVADA'
	WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
	WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
	WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
	WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
	WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
	WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
	WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
	WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
END AS ADY_STATUS

FROM SA1000 SA1

INNER JOIN AOV000 AOV ON AOV_FILIAL = ' '
AND AOV.D_E_L_E_T_ = ' '
AND AOV_CODSEG = A1_CODSEG

INNER JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = A1_VEND

INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND AD1_CODCLI = A1_COD

INNER JOIN ADY000 ADY ON ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_OPORTU = AD1_NROPOR
AND ADY_XMODAL = '0069'

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS
AND ADZ_PRODUT IN ('1M13301034','1M13301033','1M13301035')

INNER JOIN SYS_USR SYS ON USR_ID = ADY_USREMI

WHERE A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' ';;
CRM038;USO DE CUPONS;73;20200507;;49;2;;0;;;;2;69;;;1;2;0;;;1;;SELECT

ADY_PROPOS,
ADY_DATA,
ADY_DTUPL,
CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
END AS ADY_STATUS,
ADZ_PRODUT,
ADZ_DESCRI,
ADK_NOME,
ADZ_CONDPG,
ADZ_PRCTAB,
ADZ_PRCVEN,
ADZ_TOTAL,
ADZ_DESCON,
ADZ_VALDES,
ADZ_XPDEST,
ADZ_XVDEST,
ADZ_XVLTMP,
ADZ_XMESDT,
ADY_OPORTU,
ADZ_XCDCUP,
PT4_CUPOM

FROM ADY000 ADY

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS
AND ADZ_XCDCUP <> ' '

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_COD = ADY_CODIGO

INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = A1_CODMEMB

INNER JOIN PT4000A PT4 ON PT4_FILIAL = ' '
AND PT4.D_E_L_E_T_ = ' '
AND PT4_CODIGO = ADZ_XCDCUP

WHERE ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_ENTIDA = '1'
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@

UNION ALL

SELECT

ADY_PROPOS,
ADY_DATA,
ADY_DTUPL,
CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
END AS ADY_STATUS,
ADZ_PRODUT,
ADZ_DESCRI,
ADK_NOME,
ADZ_CONDPG,
ADZ_PRCTAB,
ADZ_PRCVEN,
ADZ_TOTAL,
ADZ_DESCON,
ADZ_VALDES,
ADZ_XPDEST,
ADZ_XVDEST,
ADZ_XVLTMP,
ADZ_XMESDT,
ADY_OPORTU,
ADZ_XCDCUP,
PT4_CUPOM

FROM ADY000 ADY

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS
AND ADZ_XCDCUP <> ' '

INNER JOIN SUS000 SUS ON US_FILIAL = ' '
AND SUS.D_E_L_E_T_ = ' '
AND US_COD = ADY_CODIGO

INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = US_CODMEMB

INNER JOIN PT4000A PT4 ON PT4_FILIAL = ' '
AND PT4.D_E_L_E_T_ = ' '
AND PT4_CODIGO = ADZ_XCDCUP

WHERE ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_ENTIDA = '2'
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@;;
CRM039;PROPOSTAS FECHADAS SERVIÇOS;73;20200602;;15;2;;0;;;;2;70;;;1;2;0;;;1;;SELECT DISTINCT
ADY_PROPOS
,ADY_OPORTU
,AD1_DTFIM
,ADY_XMODAL
,AOM_DESCRI
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_CONDPG
,E4_DESCRI
,ADZ_QTDVEN
,ADZ_PRCVEN
,ADZ_TOTAL

FROM ADY000 ADY

INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND AD1_NROPOR = ADY_OPORTU
AND AD1_REVISA = ADY_REVISA

LEFT JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = ADY_XMODAL

LEFT JOIN SE4000 SE4 ON E4_FILIAL = ' '
AND SE4.D_E_L_E_T_ = ' '
AND E4_CODIGO = ADZ_CONDPG

WHERE ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_XMODAL IN ('0009','0064','0065','0068','0069','0272','0342','0347','0385','0396')
AND AD1_DTFIM BETWEEN @I_DATA@ AND @F_DATA@

ORDER BY ADY_PROPOS;;
CRM040;OPORTUNIDADES PARCEIROS;73;20200929;;0;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
'CLIENTE' AS ENTIDADE
,ADY_OPORTU
,AD1_DATA
,CASE
	WHEN AD1_STATUS = '1' THEN 'ABERTA'
	WHEN AD1_STATUS = '2' THEN 'PERDIDA'
	WHEN AD1_STATUS = '9' THEN 'GANHA'
END AS AD1_STATUS
,ADY_PROPOS
,CASE
	WHEN ADY_STATUS = 'A' THEN 'ABERTO'
	WHEN ADY_STATUS = 'B' THEN 'FECHADA'
	WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
	WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
	WHEN ADY_STATUS = 'E' THEN 'APROVADA'
	WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
	WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
	WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
	WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
	WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
	WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
	WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
	WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
END AS ADY_STATUS
,ADY_CODIGO
,A1_NOME
,A1_CODMEMB
,ADK_NOME

FROM AD1000 AD1

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_COD = AD1_CODCLI

INNER JOIN ADK000 ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' ' 
AND ADK_COD = A1_CODMEMB

LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' ' 
AND ADY_OPORTU = AD1_NROPOR

WHERE ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_ENTIDA = '1'
AND ADK_TIPO = 'P'
AND AD1_DATA BETWEEN @I_DATA@ AND @F_DATA@;;
CRM041;CONTATOS LARGE;73;20201015;;6;2;;0;;;;2;;;;1;2;0;;;1;;SELECT A1_COD
,A1_NOME
,A1_CGC
,U5_CONTAT
,U5_EMAIL
,U5_DDD
,U5_FCOM1
,U5_CELULAR
,COALESCE(UM_DESC,' ') CARGO

FROM SA3000 SA3

INNER JOIN SA1000 SA1 ON A1_FILIAL=' ' AND A1_VEND=A3_COD AND SA1.D_E_L_E_T_=' '
INNER JOIN AC8000 AC8 ON AC8_FILIAL=' ' AND AC8_ENTIDA='SA1' AND AC8_FILENT=A1_FILIAL AND AC8_CODENT=A1_COD||A1_LOJA AND AC8.D_E_L_E_T_=' '
INNER JOIN SU5000 SU5 ON U5_FILIAL=' ' AND U5_CODCONT=AC8_CODCON AND SU5.D_E_L_E_T_=' '
LEFT JOIN SUM000 SUM ON UM_FILIAL=' ' AND UM_CARGO=U5_FUNCAO AND SUM.D_E_L_E_T_=' '

WHERE A3_FILIAL=' '
AND A3_UNIDAD='TSE010'
AND SA3.D_E_L_E_T_=' ';;
CRM042;RELATÓRIO DE ALÇADAS DE APROVAÇÃO;73;20201215;;10;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT	
PDV_CODIGO	
,PDV_DESCRI	
,CASE	
	WHEN ZZD_STATUS = '1' THEN 'ATIVA'
	WHEN ZZD_STATUS <> '1' THEN 'INATIVA'
	ELSE 'SEM REGRA CADASTRADA'
END AS ZZD_STATUS	
,ZL2_ITEM	
,ZL2_DESCRI	
,ZL2_DE	
,ZL2_ATE	
,ZL2_CARGO	
,UM_DESC	
,ZL2_VEND	
,A3_NOME	
,ZL2_USER	
,ZL2_NOMUSR	
	
FROM PDV000 PDV	
	
INNER JOIN ZL2000 ZL2 ON ZL2_FILIAL = ' ' 	
AND ZL2.D_E_L_E_T_ = ' ' 	
AND ZL2_CODIGO = PDV_CODIGO	
AND ZL2_XREVIS = PDV_XREVIS	
	
LEFT JOIN ZZD000 ZZD ON ZZD_FILIAL = ' ' 	 	
AND ZZD_ALCADA = PDV_CODIGO	
	
LEFT JOIN SUM000 SUM ON UM_FILIAL = ' ' 	
AND SUM.D_E_L_E_T_ = ' ' 	
AND UM_CARGO = ZL2_CARGO	
	
LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' 	
AND SA3.D_E_L_E_T_ = ' ' 	
AND A3_COD = ZL2_VEND	
	
WHERE PDV_FILIAL = ' ' 	
AND ZZD.D_E_L_E_T_ <ADVPL>If(_DELETE = "1", "=", "<>")</ADVPL> ' ' 
AND PDV.D_E_L_E_T_ = ' ';;
CRM043;PROPOSTAS DE SERVIÇO - MARGEM DE VENDA;73;20210218;;30;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
ADY_PROPOS 
,ADY_XMODAL
,AOM_DESCRI
,ADY_DATA
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
END AS ADY_STATUS
,ADY_DTUPL
,ADY_XVLRTR
,CASE
WHEN ADY_ENTIDA = '1' THEN 'CLIENTE'
END AS ADY_ENTIDA
,ADY_CODIGO
,A1_NOME AS NOMECONT
,A1_XCLIVIP || ' - ' || ZX5_DESCRI AS A1_XCLIVIP
,A3_UNIDAD
,ADK1.ADK_NOME
,A1_VEND AS VENDEDOR
,SA31.A3_NOME
,A3_EMAIL
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_QTDVEN
,ADZ_PRCVEN
,ADZ_TOTAL
,ADY_XMLUCR
,U5_CONTAT
,U5_FCOM1
,U5_CELULAR
,U5_EMAIL

FROM ADY000 ADY

LEFT JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_COD = ADY_CODIGO

LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' '
AND SA31.D_E_L_E_T_ = ' '
AND SA31.A3_COD = A1_VEND

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = ADY_XMODAL

LEFT JOIN ADK000 ADK1 ON ADK1.ADK_FILIAL = ' '
AND ADK1.D_E_L_E_T_ = ' '
AND ADK1.ADK_COD = SA31.A3_UNIDAD

LEFT JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS

LEFT JOIN ZX5000 ZX5 ON ZX5_FILIAL = ' ' 
AND ZX5.D_E_L_E_T_ = ' ' 
AND ZX5_TABELA = 'TDI001'
AND ZX5_CHAVE = '000002'
AND ZX5_CHAVE2 = A1_XCLIVIP

LEFT JOIN AC8000 AC8 ON AC8_FILIAL = ' ' 
AND AC8.D_E_L_E_T_ = ' ' 
AND AC8_ENTIDA = 'SA1'
AND AC8_CODENT = A1_COD||'00'

LEFT JOIN SU5000 SU5 ON U5_FILIAL = ' ' 
AND SU5.D_E_L_E_T_ = ' ' 
AND U5_CODCONT = AC8_CODCON

WHERE ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_ENTIDA = '1'
AND ADY_XMODAL IN ('0102','0103','0105','0106','0108','0194','0165','0166','0167')
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@;;
CRM044;CLIENTES CALL CENTER;73;20210226;;3;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT 
A1_COD
,A1_CGC
,A1_NOME
,A1_EST
,A1_CODMEMB
,ADK_NOME
,A1_VEND
,A1_XGAR
,A1_DDD
,A1_TEL
,A1_EMAIL 
FROM   SA1000 SA1

LEFT JOIN ADK000 ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' ' 
AND ADK_COD = A1_CODMEMB
 
WHERE  A1_FILIAL = ' ' 
       AND SA1.D_E_L_E_T_ = ' ';;
CRM045;OPORTUNIDADES CRIADAS E ENCERRADAS - NOVOS NEG.;73;20210303;;41;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT	
'PROSPECT' AS ENTIDADE
,ADY_OPORTU	
,CASE	
	WHEN AD1_STATUS = '1' THEN 'ABERTA'
	WHEN AD1_STATUS = '2' THEN 'PERDIDA'
	WHEN AD1_STATUS = '9' THEN 'GANHA'
END AS AD1_STATUS	
,AD2_VEND	
,SA31.A3_NOME 
,AD2_CODPAP	
,UM_DESC	
,CONCAT(AD2_PERC,'%') AS AD2_PERC	
,ADY_PROPOS	
,(SELECT SUM(ADZ_TOTAL) 	
	FROM ADZ000 ADZ
	WHERE ADZ_FILIAL = ' '
	AND ADZ.D_E_L_E_T_ = ' '
	AND ADZ_PROPOS = ADY_PROPOS
	AND ADZ_REVISA = ADY_PREVIS) AS TOTAL
,CASE	
	WHEN ADY_STATUS = 'A' THEN 'ABERTO'
	WHEN ADY_STATUS = 'B' THEN 'FECHADA'
	WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
	WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
	WHEN ADY_STATUS = 'E' THEN 'APROVADA'
	WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
	WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
	WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
	WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
	WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
	WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
	WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
	WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
END AS ADY_STATUS	
	
,ADY_CODIGO	
,US_NOME AS RAZAO	
,US_CGC	 AS CGC
,US_VEND AS CODVEND	
,SA32.A3_NOME AS VENDEDOR 	
,ADY_DATA	
,AD1_DTFIM	
	
FROM ADY000 ADY	
	
LEFT JOIN AD1000 AD1 ON AD1_FILIAL = ' ' 	
AND AD1.D_E_L_E_T_ = ' ' 	
AND AD1_NROPOR = ADY_OPORTU	
AND AD1_REVISA = ADY_REVISA	
	
LEFT JOIN AD2000 AD2 ON AD2_FILIAL = ' ' 	
AND AD2.D_E_L_E_T_ = ' ' 	
AND AD2_NROPOR = AD1_NROPOR	
AND AD2_REVISA = AD1_REVISA	
	
LEFT JOIN SUM000 SUM ON UM_FILIAL = ' ' 	
AND SUM.D_E_L_E_T_ = ' ' 	
AND UM_CARGO = AD2_CODPAP	
	
LEFT JOIN SUS000 SUS ON US_FILIAL = ' ' 	
AND SUS.D_E_L_E_T_ = ' ' 	
AND US_COD = ADY_CODIGO	
	
LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' ' 	
AND SA31.D_E_L_E_T_ = ' ' 	
AND SA31.A3_COD = AD2_VEND	
	
LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' ' 	
AND SA32.D_E_L_E_T_ = ' ' 	
AND SA32.A3_COD = US_VEND	
	
WHERE ADY_FILIAL = ' '	
AND ADY.D_E_L_E_T_ = ' '
AND ADY_ENTIDA = '2' 		
AND AD2_VEND IN ('PC0304','PC0268','T19614','PC0307','PC0309','PC0233','PC0310','PC0311','PC0323','PC0315','T19914','PC0317','T19616','PC0318','PC0313','T21305')
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@

UNION ALL

SELECT DISTINCT	
'CLIENTE' AS ENTIDADE 
,ADY_OPORTU	
,CASE	
	WHEN AD1_STATUS = '1' THEN 'ABERTA'
	WHEN AD1_STATUS = '2' THEN 'PERDIDA'
	WHEN AD1_STATUS = '9' THEN 'GANHA'
END AS AD1_STATUS	
,AD2_VEND	
,SA31.A3_NOME 
,AD2_CODPAP	
,UM_DESC	
,CONCAT(AD2_PERC,'%') AS AD2_PERC	
,ADY_PROPOS	
,(SELECT SUM(ADZ_TOTAL) 	
	FROM ADZ000 ADZ
	WHERE ADZ_FILIAL = ' '
	AND ADZ.D_E_L_E_T_ = ' '
	AND ADZ_PROPOS = ADY_PROPOS
	AND ADZ_REVISA = ADY_PREVIS) AS TOTAL
,CASE	
	WHEN ADY_STATUS = 'A' THEN 'ABERTO'
	WHEN ADY_STATUS = 'B' THEN 'FECHADA'
	WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
	WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
	WHEN ADY_STATUS = 'E' THEN 'APROVADA'
	WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
	WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
	WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
	WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
	WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
	WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
	WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
	WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
END AS ADY_STATUS	
	
,ADY_CODIGO
,A1_NOME AS RAZAO	
,A1_CGC	 AS CGC
,A1_VEND AS CODVEND
,SA32.A3_NOME AS VENDEDOR
,ADY_DATA	
,AD1_DTFIM	
	
FROM ADY000 ADY	
	
LEFT JOIN AD1000 AD1 ON AD1_FILIAL = ' ' 	
AND AD1.D_E_L_E_T_ = ' ' 	
AND AD1_NROPOR = ADY_OPORTU	
AND AD1_REVISA = ADY_REVISA	
	
LEFT JOIN AD2000 AD2 ON AD2_FILIAL = ' ' 	
AND AD2.D_E_L_E_T_ = ' ' 	
AND AD2_NROPOR = AD1_NROPOR	
AND AD2_REVISA = AD1_REVISA	
	
LEFT JOIN SUM000 SUM ON UM_FILIAL = ' ' 	
AND SUM.D_E_L_E_T_ = ' ' 	
AND UM_CARGO = AD2_CODPAP	
	
LEFT JOIN SA1000 SA1 ON A1_FILIAL = ' ' 	
AND SA1.D_E_L_E_T_ = ' ' 	
AND A1_COD = ADY_CODIGO	
	
LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' ' 	
AND SA31.D_E_L_E_T_ = ' ' 	
AND SA31.A3_COD = AD2_VEND	
	
LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' ' 	
AND SA32.D_E_L_E_T_ = ' ' 	
AND SA32.A3_COD = A1_VEND	
	
WHERE ADY_FILIAL = ' '	
AND ADY.D_E_L_E_T_ = ' '
AND ADY_ENTIDA = '1' 		
AND AD2_VEND IN ('PC0304','PC0268','T19614','PC0307','PC0309','PC0233','PC0310','PC0311','PC0323','PC0315','T19914','PC0317','T19616','PC0318','PC0313','T21305')
AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@
;;
CRM046;CONSULTA ID FLUIG;73;20210324;;102;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
ADY_PROPOS
,ADY_CODIGO
,A1_NOME
,ZXS_IDFLG

FROM ADY000 ADY

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' ' 
AND A1_COD = ADY_CODIGO

LEFT JOIN ZRM000 ZRM ON ZRM_FILIAL = ' ' 
AND ZRM.D_E_L_E_T_ = ' ' 
AND ZRM_CHAVE = ADY_PROPOS

LEFT JOIN ZXS000 ZXS ON ZXS_FILIAL = ' ' 
AND ZXS.D_E_L_E_T_ = ' ' 
AND ZXS_IDPROC = ZRM_IDPROC

WHERE ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' ' 
AND ADY_ENTIDA = '1'
AND ADY_CODIGO = @CODCLI@;;
CRM047;TABELA ZUS - SEGMENTOS;73;20210329;;1;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
ZUS_UNIDAD
,ZUS_CODSEG
,ZUS_VIGINI
,ZUS_VIGFIM

FROM ZUS000 ZUS

WHERE
ZUS_FILIAL = ' ' 
AND ZUS.D_E_L_E_T_ = ' ';;
CRM048;TABELA ADK - UNIDADES;73;20210329;;6;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
ADK_COD
,ADK_NOME
,ADK_CNPJ
,ADK_RAZAO
,ADK_TIPO || ' - ' ||ZX5_DESCRI AS ADK_TIPO
,ADK_RESP
,ADK_END
,ADK_BAIRRO
,ADK_MUN
,ADK_EST
,ADK_PAIS
,ADK_CEP
,ADK_DDI
,ADK_DDD
,ADK_TEL
,ADK_TEL2
,ADK_EMAIL
,ADK_XAGN || ' - ' || X5_DESCRI AS ADK_XAGN
,ADK_XPROD
,ADK_XCC
,ADK_XPROPR
,ADK_XTPEXC
,ADK_XRESP2
,ADK_XRESP3
,ADK_XCODAN
,ADK_XTGARE
,ADK_XSUPER
,ADK_XMETA

FROM ADK000 ADK

LEFT JOIN ZX5000 ZX5 ON ZX5_FILIAL = ' ' 
AND ZX5.D_E_L_E_T_ = ' ' 
AND ZX5_TABELA = 'TDI001'
AND ZX5_CHAVE = '000001'
AND ZX5_CHAVE2 = ADK_TIPO

LEFT JOIN SX5000 SX5 ON X5_FILIAL = ' ' 
AND SX5.D_E_L_E_T_ = ' ' 
AND X5_TABELA = 'SN'
AND X5_CHAVE = ADK_XAGN

WHERE ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' ';;
CRM049;TABELA AOY  TERRITORIO;73;20210329;;1;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
AOY_CODTER
,AOY_NMTER
,AOY_DTINIC
,AOY_DTFIM
,AOY_SUBTER
,AOY_TPROD
,AOY_MSBLQL
,AOY_TIPO
,AOY_XSEQRO

FROM AOY000 AOY

WHERE AOY_FILIAL = ' ' 
AND AOY.D_E_L_E_T_ = ' ';;
CRM050;TABELA A09 - MEMBROS;73;20210329;;3;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
A09_CODTER
,A09_TPMBRO
,A09_CODMBR
,A09_DTINIC
,A09_DTFIM
,A09_MSBLQL
,A09_XIDAUT

FROM A09000 A09

WHERE A09_FILIAL = ' ' 
AND A09.D_E_L_E_T_ = ' ';;
CRM051;TABELA AOZ - AGRUPADORES;73;20210329;;1;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
AOZ_CODTER
,AOZ_CODAGR
,AOZ_DTINIC
,AOZ_DTFIM
,AOZ_MSBLQL

FROM AOZ000 AOZ

WHERE AOZ_FILIAL = ' ' 
AND AOZ.D_E_L_E_T_ = ' ';;
CRM052;TABELA A00  NIVEIS DO AGRUPADOR;73;20210329;;1;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
A00_CODTER
,A00_CODAGR
,A00_NIVAGR
,A00_DTINIC
,A00_DTFIM
,A00_OPER
,A00_PONTOS
,A00_MSBLQL
,A00_IDINT

FROM A00000 A00

WHERE A00_FILIAL = ' ' 
AND A00.D_E_L_E_T_ = ' ';;
CRM053;TABELA AZ3 - RODIZIO;73;20210329;;1;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
A00_CODTER
,A00_CODAGR
,A00_NIVAGR
,A00_DTINIC
,A00_DTFIM
,A00_OPER
,A00_PONTOS
,A00_MSBLQL
,A00_IDINT

FROM A00000 A00

WHERE A00_FILIAL = ' ' 
AND A00.D_E_L_E_T_ = ' ';;
CRM054;CRM054 - TABELA AZ6  FILAS DO RODIZIO;73;20210329;;1;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
AZ6_CODROD
,AZ6_CODFLA
,AZ6_SEQFLA
,AZ6_DESCRI
,AZ6_CODRGR
,AZ6_ULTMEM
,AZ6_MSBLQL

FROM AZ6000 AZ6

WHERE AZ6_FILIAL = ' ' 
AND AZ6.D_E_L_E_T_ = ' ';;
CRM055;TABELA AZ7  MEMBROS DA FILA;73;20210329;;1;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
AZ7_CODROD
,AZ7_CODFLA
,AZ7_TPMEM
,AZ7_CODMEM
,AZ7_PESOM
,AZ7_CTCNT
,AZ7_XIDAUT

FROM AZ7000 AZ7

WHERE AZ7_FILIAL = ' ' 
AND AZ7.D_E_L_E_T_ = ' ';;
CRM056;CUPONS DE DESCONTO;73;20210524;;9;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
PT4_CODIGO
,PT4_CUPOM
,PT4_DESCRI
,PT4.PT4_VIGDE
,PT4.PT4_VIGATE
,PT4_USOMAX
,PT4_QTDUSO
,PT4_USOVEN
,CASE
WHEN PT4_TCUPOM = '1' THEN 'Desc. Temp.'
WHEN PT4_TCUPOM = '2' THEN 'Vigência'
WHEN PT4_TCUPOM = '3' THEN 'Desc.T+Vigência'
WHEN PT4_TCUPOM = '4' THEN 'Desconto'
WHEN PT4_TCUPOM = '5' THEN 'Carência'
WHEN PT4_TCUPOM = '6' THEN 'Desc.+Carência'
WHEN PT4_TCUPOM = '7' THEN 'Parcelamento'
WHEN PT4_TCUPOM = '8' THEN 'Desc.+Parcelamento'
WHEN PT4_TCUPOM = '9' THEN 'Carência+Parcelamento'
WHEN PT4_TCUPOM = 'A' THEN 'Desc.+Carência+Parcelamento'
END AS PT4_TCUPOM
,CASE
WHEN PT5_TPFILT = '1' THEN 'Agrupador'
WHEN PT5_TPFILT = '2' THEN 'Produto'
END AS PT5_TPFILT
,PT5_ITEM
,PT5_CHAVE
,PT5_DESCRI

FROM PT4000A PT4
INNER JOIN PT5000 PT5 ON PT5_FILIAL = ' ' 
AND PT5.D_E_L_E_T_ = ' '
AND PT5_CODIGO = PT4_CODIGO

WHERE PT4_FILIAL = ' ' 
AND PT4.D_E_L_E_T_ = ' '
AND PT4_CUPOM = @CUPOM@
OR PT4.PT4_VIGDE BETWEEN @I_DATA@ AND @F_DATA@ 

;;
CRM057;CLIENTES MANUFATURA / CONSTR. PROJETOS;73;20210527;;2;2;;0;;;;2;;;;1;2;0;;;1;;SELECT 
A1_COD
,A1_NOME
,A1_CGC
,A1_CNAE
,CC3_DESC
,A1_CODSEG
,AOV1.AOV_DESSEG  AS DESSEG
,A1_XCODSUB
,AOV2.AOV_DESSEG AS DESSUB
,CASE
	WHEN A1_XPORTE = '1' THEN 'Pequeno'
	WHEN A1_XPORTE = '2' THEN 'Medio'
	WHEN A1_XPORTE = '3' THEN 'Grande'
	WHEN A1_XPORTE = '4' THEN 'Prime'
	WHEN A1_XPORTE = '5' THEN 'Private'
END AS A1_XPORTE
,AI0_XNFUNC
,A1_VEND
,A3_NOME
,SUM(CNB_VLTOT) AS CNB_VLTOT

FROM SA1000 SA1

INNER JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' '
AND AOV1.D_E_L_E_T_ = ' ' 
AND AOV1.AOV_CODSEG = A1_CODSEG
AND AOV1.AOV_PAI = ' '
AND AOV1.AOV_CODSEG IN ('000001','000005')

LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' ' 
AND AOV2.D_E_L_E_T_ = ' ' 
AND AOV2.AOV_CODSEG = A1_XCODSUB
AND AOV2.AOV_PAI = A1_CODSEG

LEFT JOIN CN9000 CN9 ON CN9_FILIAL = ' ' 
AND CN9.D_E_L_E_T_ = ' ' 
AND CN9_NUMERO = CONCAT('CON',A1_COD) 
AND CN9_SITUAC = '05' 
AND CN9_ESPCTR = '2' 
AND CN9_REVATU = ' '

LEFT JOIN CNB000 CNB ON CNB_FILIAL = ' ' 
AND CNB.D_E_L_E_T_ = ' ' 
AND CNB_CONTRA = CN9_NUMERO 
AND CNB_REVISA = CN9_REVISA

LEFT JOIN CC3000 CC3 ON CC3_FILIAL = ' ' 
AND CC3.D_E_L_E_T_ = ' ' 
AND CC3_COD = A1_CNAE

LEFT JOIN AI0000 AI0 ON AI0_FILIAL = ' ' 
AND AI0.D_E_L_E_T_ = ' ' 
AND AI0_CODCLI = A1_COD

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' 
AND SA3.D_E_L_E_T_ = ' ' 
AND A3_COD = A1_VEND

WHERE A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' '   
AND CNB_TIPREC = '1' 
AND CNB_SITUAC IN ('A','G','M','P')

GROUP BY 

A1_COD
,A1_NOME
,A1_CGC
,A1_CNAE
,CC3_DESC
,A1_CODSEG
,AOV1.AOV_DESSEG
,A1_XCODSUB
,AOV2.AOV_DESSEG
,A1_XPORTE
,AI0_XVALFT
,AI0_XNFUNC
,A1_VEND
,A3_NOME;;
CRM058;CONSULTA PRODUTOS TEF;73;20210625;;91;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
ADY_OPORTU
,AD1_DATA
,ADY_PROPOS
,ADY_XMODAL
,AOM_DESCRI
,CASE
	WHEN ADY_STATUS = 'A' THEN 'ABERTO'
	WHEN ADY_STATUS = 'B' THEN 'FECHADA'
	WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
	WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
	WHEN ADY_STATUS = 'E' THEN 'APROVADA'
	WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
	WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
	WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
	WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
	WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
	WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
	WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
	WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
END AS ADY_STATUS
,ADY_DTUPL
,ADY_DTFAT
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_PRCVEN
,ADZ_QTDVEN
,ADZ_TOTAL
,ADZ_XPDEST
,ADZ_XVDEST
,ADZ_XVLTMP
,ADZ_XMESDT
,ADY_CODIGO
,A1_NOME
,A1_CGC
,A1_MUN
,A1_EST
,A1_CODSEG
,AOV_DESSEG
,SA31.A3_UNIDAD AS UNIDADE
,ADK_NOME
,A1_VEND
,SA31.A3_NOME AS NOMEEAR
,SA31.A3_EMAIL AS EMAILEAR
,A1_XGAR
,SA32.A3_NOME AS NOMEGAR
,SA32.A3_EMAIL AS EMAILGAR

FROM ADY000 ADY

INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' ' 
AND AD1.D_E_L_E_T_ = ' ' 
AND AD1_NROPOR = ADY_OPORTU
AND AD1_REVISA = ADY_REVISA

INNER JOIN AOM000 AOM ON AOM_FILIAL = ' ' 
AND AOM.D_E_L_E_T_ = ' ' 
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = ADY_XMODAL

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' ' 
AND ADZ.D_E_L_E_T_ = ' ' 
AND ADZ_PROPOS = ADY_PROPOS 
AND ADZ_REVISA = ADY_PREVIS

LEFT JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' ' 
AND A1_COD = ADY_CODIGO

LEFT JOIN AOV000 AOV ON AOV_FILIAL = ' ' 
AND AOV.D_E_L_E_T_ = ' ' 
AND AOV_CODSEG = A1_CODSEG
AND AOV_PAI = ' ' 

LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' '
AND SA31.D_E_L_E_T_ = ' ' 
AND SA31.A3_COD = A1_VEND

LEFT JOIN ADK000 ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' ' 
AND ADK_COD = SA31.A3_UNIDAD

LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' '
AND SA32.D_E_L_E_T_ = ' ' 
AND SA32.A3_COD = A1_XGAR

WHERE ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' '
AND ADY_ENTIDA = '1'
AND ADY_XMODAL IN ('0367','0379','0381')
AND AD1_DATA BETWEEN @I_DTINI@ AND @I_DTDIM@
AND ADY_DTUPL BETWEEN @I_DTUPI@ AND @I_DTUPF@;;
CRM059;PROPOSTAS GANHAS SERVIÇOS;73;20210716;;7;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
ADY_OPORTU
,AD1_DTASSI
,CASE
	WHEN AD1_STATUS = '1' THEN 'ABERTA'
	WHEN AD1_STATUS = '2' THEN 'PERDIDA'
	WHEN AD1_STATUS = '9' THEN 'GANHA'
END AS AD1_STATUS
,ADY_PROPOS
,ADY_XMODAL
,AOM_DESCRI
,ADY_DATA
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_TOTAL
,ADY_CODIGO
,A1_NOME
,A1_CODSEG
,AOV_DESSEG
,AD2_VEND
,A3_NOME AS NOMETIME
,AD2_CODPAP
,UM_DESC

FROM ADY000 ADY

INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' ' 
AND AD1.D_E_L_E_T_ = ' ' 
AND AD1_NROPOR = ADY_OPORTU
AND AD1_REVISA = ADY_REVISA

INNER JOIN AD2000 AD2 ON AD2_FILIAL = ' ' 
AND AD2.D_E_L_E_T_ = ' ' 
AND AD2_NROPOR = AD1_NROPOR
AND AD2_REVISA = AD1_REVISA

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' ' 
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS

LEFT JOIN SA1000 SA1 ON A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' ' 
AND A1_COD = ADY_CODIGO

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' 
AND SA3.D_E_L_E_T_ = ' ' 
AND A3_COD = AD2_VEND

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' ' 
AND AOM.D_E_L_E_T_ = ' ' 
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = ADY_XMODAL

LEFT JOIN AOV000 AOV ON AOV_FILIAL = ' ' 
AND AOV.D_E_L_E_T_ = ' ' 
AND AOV_CODSEG = A1_CODSEG
AND AOV_PAI = ' ' 

LEFT JOIN SUM000 SUM ON UM_FILIAL = ' ' 
AND SUM.D_E_L_E_T_ = ' ' 
AND UM_CARGO = AD2_CODPAP

WHERE ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' '
AND ADY_ENTIDA = '1'
AND ADY_XMODAL = '0054'
AND AD1_DTASSI BETWEEN @I_DATA@ AND @F_DATA@;;
CRM060;CONSULTA MARGEM DE LUCRO EDUCACIONAL - STORE;73;20210802;;7;2;;0;;;;2;;;;1;2;0;;;1;;Select  PMU_PRPEXT, 
        PMU_DTPRPE,
        Case PMU_STPRPE  
            When '0' Then 'Erro Integracao'
            When '1' Then 'Erro Oportunidade'
            When '2' Then 'Erro Proposta'
            When '3' Then 'Pendente'
            When '4' Then 'Oportunidade Gerada'
            When '5' Then 'Proposta Gerada'
            When '6' Then 'Contrato Gerado'
            When '7' Then 'Medicao Gerada'
            When '8' Then 'Pedido Gerado'
            When '9' Then 'Nota Gerada'
            When 'A' Then 'An?lise Welcome Call'
            When 'B' Then 'Financiamento Bancario Reprovado'
            When 'C' Then 'Aguardando Faturamento Hardware'
            When 'D' Then 'Contrato Cancelado'
            When 'E' Then 'Tentativas para geracao da proposta excedidas'
            When 'F' Then 'Aguardando aprova??o financiamento bancario'
            When 'G' Then 'Pendente leitura de CNAB'
            When 'H' Then 'Aguardando a geracao do Boleto'
            When 'I' Then 'Reprovado Credito'
            When 'J' Then 'Aguardando pagamento do Boleto'
            When 'K' Then 'Erro ao gerar RA'
            When 'L' Then 'Aguardando a proposta assinada'
            When 'M' Then 'Aguardando formulario de financiamento'
            When 'O' Then 'Analise Credito'
            When 'P' Then 'Proposta Perdida'
            When 'R' Then 'Proposta Reprovada'
            When 'S' Then 'Contrato Cancelado. Cobranca nao autorizada'
            When 'W' Then 'Reprovado Welcome Call'
            When 'Z' Then 'Aprovacao Zoneamento Vendas'
            Else 'Desconhecido'
        End As StatusInte,
        A1_COD,
        A1_NOME,
        Case A1_TIPO
            When 'F' Then 'Cons.Final'
            When 'L' Then 'Produtor Rural'
            When 'R' Then 'Revendedor'
            When 'S' Then 'Solid?rio'
            When 'X' Then 'Exportacao'
            When 'M' Then 'Monotributario'
            When 'I' Then 'I'
            When 'N' Then 'N'
            When 'E' Then 'E'
            Else 'Desconhecido'        
        End As TipoCli,
        A3_COD,
        A3_NOME,
        ADK_COD,
        ADK_NOME,
        PMW_PRODUT,
        B1_DESC,
        PMW_QTDVEN,
        PMW_PRCVEN,
        PMW_VALDES,
        PMW_TOTAL - PMW_VALDES AS PMW_TOTAL,
        (PMW_PRCVEN - B5_XCUST) * 100 /PMW_PRCVEN AS PMU_MARGST,
        B5_XCUST
From  PMU000 PMU
Inner Join SA1000 SA1
   On A1_FILIAL = ' '
  And A1_COD = PMU_CLIENT
  And A1_LOJA = PMU_LOJA
  And SA1.D_E_L_E_T_ = ' '
Inner Join SA3000 SA3
   On A3_FILIAL = ' '
  And A3_COD = PMU_VENDED
  And SA3.D_E_L_E_T_ = ' '
 Left Join ADK000 ADK
   On ADK_FILIAL = ' '
  And ADK_COD = A3_UNIDAD
  And ADK.D_E_L_E_T_ = ' '
Inner Join PMW000 PMW
   On PMW_FILIAL = PMU_FILIAL
  And PMW_IDSEQ = PMU_IDSEQ
  And PMW.D_E_L_E_T_ = ' '
Inner Join SB1000 SB1
   On B1_FILIAL = ' '
  And B1_COD = PMW_PRODUT
  And SB1.D_E_L_E_T_ = ' '
Inner Join SB5000 SB5
   On B5_FILIAL = ' '
  And B5_COD = PMW_PRODUT
  And SB5.D_E_L_E_T_ = ' '
Where PMU_FILIAL = ' '
  And PMU_CINTEG = '000008'
  And PMU_SITUAC = '1'
  And PMU_DTPRPE BETWEEN @I_DTINI@ AND @I_DTFIM@
  AND PMU.D_E_L_E_T_ = ' ';;
CRM061;PROPOSTA POR PARTNUMBER;73;20211028;;60;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT 
				ADY_PROPOS,
                ADY_OPORTU,
                AD1_DATA,
                'CLIENTE' AS ENTIDADE,
                ADY_CODIGO,
                A1_CGC AS CGC,
                A1_NOME AS NOMECLI,
                A1_VEND AS VEND,
				SA31.A3_NOME AS NOMEESN,
				A1_XGAR AS XGAR,
				SA32.A3_NOME AS NOMEGSN,
				A1_CODMEMB AS UNID,
				ADK_NOME,
				ADY_DATA,
                ADY_DTUPL,
                CASE
                    WHEN ADY_STATUS = 'A' THEN 'ABERTO'
                    WHEN ADY_STATUS = 'B' THEN 'FECHADA'
                    WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
                    WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
                    WHEN ADY_STATUS = 'E' THEN 'APROVADA'
                    WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
                    WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
                    WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
                    WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
                    WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
                    WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
                    WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
                    WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
                END AS ADY_STATUS,
                ADZ_PRODUT,
                ADZ_DESCRI,
				ADZ_TOTAL,
              	UTL_RAW.CAST_TO_VARCHAR2(DBMS_LOB.SUBSTR(ADY_XMEMNE, 2000,1)) AS NEGOC
				
				
FROM ADY000 ADY

INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND AD1_NROPOR = ADY_OPORTU
AND AD1_REVISA = ADY_REVISA

LEFT JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_COD = ADY_CODIGO

LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' '
	   AND SA31.D_E_L_E_T_ = ' '
	   AND SA31.A3_COD = A1_VEND
	   
LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' '
       AND SA32.D_E_L_E_T_ = ' '
	   AND SA32.A3_COD = A1_XGAR
	   
LEFT JOIN ADK000 ADK ON ADK_FILIAL = ' '
       AND ADK.D_E_L_E_T_ = ' '
	   AND ADK_COD = A1_CODMEMB 

LEFT JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS

WHERE ADY_FILIAL = ' '
  AND ADY.D_E_L_E_T_ = ' '
  AND ADY_ENTIDA = '1'
  AND ADZ_PRODUT = '71A3301293'

UNION ALL

SELECT DISTINCT 
				ADY_PROPOS,
                ADY_OPORTU,
                AD1_DATA,
                'PROSPECT' AS ENTIDADE,
                ADY_CODIGO,
                US_CGC AS CGC,
                US_NOME AS NOMECLI,
                US_VEND AS VEND,
				SA31.A3_NOME AS NOMEESN,
				US_XGAR AS XGAR,
				SA32.A3_NOME AS NOMEGSN,
				US_CODMEMB AS UNID,
				ADK_NOME,
				ADY_DATA,
                ADY_DTUPL,
                CASE
                    WHEN ADY_STATUS = 'A' THEN 'ABERTO'
                    WHEN ADY_STATUS = 'B' THEN 'FECHADA'
                    WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
                    WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
                    WHEN ADY_STATUS = 'E' THEN 'APROVADA'
                    WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
                    WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
                    WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
                    WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
                    WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
                    WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
                    WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
                    WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
                END AS ADY_STATUS,
                ADZ_PRODUT,
                ADZ_DESCRI,
                ADZ_TOTAL,
              	UTL_RAW.CAST_TO_VARCHAR2(DBMS_LOB.SUBSTR(ADY_XMEMNE, 2000,1)) AS NEGOC
				
FROM ADY000 ADY

INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND AD1_NROPOR = ADY_OPORTU
AND AD1_REVISA = ADY_REVISA

LEFT JOIN SUS000 SUS ON US_FILIAL = ' '
AND SUS.D_E_L_E_T_ = ' '
AND US_COD = ADY_CODIGO

LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' '
	   AND SA31.D_E_L_E_T_ = ' '
	   AND SA31.A3_COD = US_VEND
	   
LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' '
       AND SA32.D_E_L_E_T_ = ' '
	   AND SA32.A3_COD = US_XGAR
	   
LEFT JOIN ADK000 ADK ON ADK_FILIAL = ' '
       AND ADK.D_E_L_E_T_ = ' '
	   AND ADK_COD = US_CODMEMB 

LEFT JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS

WHERE ADY_FILIAL = ' '
  AND ADY.D_E_L_E_T_ = ' '
  AND ADY_ENTIDA = '2'
  AND ADZ_PRODUT = '71A3301293'
;;Criação solicitada pelo tkt TSS-26140
CRM062;SITEFAT PROPOSTAS;73;20220307;;18;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
WHEN ADY_STATUS = 'Y' THEN 'PENDENTE EASY SALES'
END AS ADY_STATUS
,ADY_XMODAL
,AOM_DESCRI
,ADY_DTUPL
,ADZ_PRODUT
,ADZ_DESCRI
,PKG_FILFAT
,CASE
WHEN PKG_VALID <> '1' THEN 'SIM'
WHEN PKG_VALID = '2' THEN 'NAO'
END AS PKG_VALID
,ADY_XFILSF
,CASE 
	WHEN ADY_XFILSF = '00001000100' THEN 'TOTVS MATRIZ'
	WHEN ADY_XFILSF = '00001000600' THEN 'TOTVS JOINVILLE'
	WHEN ADY_XFILSF = '00001000800' THEN 'TOTVS RIO - FILIAL'
	WHEN ADY_XFILSF = '00001001000' THEN 'TOTVS ALPHAVILLE'
	WHEN ADY_XFILSF = '00001001100' THEN 'TOTVS PORTO ALEGRE'
	WHEN ADY_XFILSF = '00001001200' THEN 'TOTVS BELO HORIZONTE'
	WHEN ADY_XFILSF = '00001001700' THEN 'TOTVS SANTA CATARINA'
	WHEN ADY_XFILSF = '00001001900' THEN 'TOTVS CAMPINAS'
	WHEN ADY_XFILSF = '00001002000' THEN 'TOTVS BRASILIA - FILIAL'
	WHEN ADY_XFILSF = '00001002100' THEN 'TOTVS ITAIM'
	WHEN ADY_XFILSF = '00001002200' THEN 'TOTVS RECIFE - FILIAL'
	WHEN ADY_XFILSF = '00001002300' THEN 'TOTVS MACAE'
	WHEN ADY_XFILSF = '00001002500' THEN 'TOTVS SOROCABA'
	WHEN ADY_XFILSF = '00001002600' THEN 'TOTVS CAXIAS DO SUL'
	WHEN ADY_XFILSF = '00001002700' THEN 'TOTVS ASSIS - FILIAL'
	WHEN ADY_XFILSF = '00102000100' THEN 'TOTVS SERVICOS - MATRIZ RIO'
	WHEN ADY_XFILSF = '00102000200' THEN 'TOTVS SERVICOS - MACAÉ'
	WHEN ADY_XFILSF = '00102000300' THEN 'TOTVS SERVICOS - RIO'
	WHEN ADY_XFILSF = '00102000400' THEN 'TOTVS SERVICOS - BELO HORIZONTE'
	WHEN ADY_XFILSF = '00102000500' THEN 'TOTVS SERVICOS - RECIFE'
	WHEN ADY_XFILSF = '00102000700' THEN 'TOTVS SERVICOS - CAMPINAS'
	WHEN ADY_XFILSF = '00102000800' THEN 'TOTVS SERVICOS - ALPHAVILLE'
	WHEN ADY_XFILSF = '00102000900' THEN 'TOTVS SERVICOS - SP SERVICOS1631'
	WHEN ADY_XFILSF = '00102001000' THEN 'TOTVS SERVICOS - CAXIAS'
	WHEN ADY_XFILSF = '00102001100' THEN 'TOTVS SERVICOS - SANTA CATARINA'
	WHEN ADY_XFILSF = '00102001200' THEN 'TOTVS SERVICOS - BRASILIA'
	WHEN ADY_XFILSF = '00202000100' THEN 'TOTVS RECIFE - EMPRESA'
	WHEN ADY_XFILSF = '00302000100' THEN 'TOTVS BRASILIA - EMPRESA'
	WHEN ADY_XFILSF = '00302000200' THEN 'TOTVS BRASILIA - FILIAL B.HORIZONTE'
	WHEN ADY_XFILSF = '00302000300' THEN 'TOTVS BRASILIA - FILIAL FORTALEZA'
	WHEN ADY_XFILSF = '00302000500' THEN 'TOTVS BRASILIA - FILIAL GOIANIA'
	WHEN ADY_XFILSF = '00401000100' THEN 'TOTVS TV DIGITAL'
	WHEN ADY_XFILSF = '00501000100' THEN 'TOTVS VENTURE'
	WHEN ADY_XFILSF = '00601000100' THEN 'TOTVS W D'
	WHEN ADY_XFILSF = '00701000100' THEN 'PC INFORMATICA S.A.'
	WHEN ADY_XFILSF = '00701000200' THEN 'PC INFORMATICA S.A.'
	WHEN ADY_XFILSF = '00701000400' THEN 'PC INFORMATICA FORTALEZA'
	WHEN ADY_XFILSF = '00801000100' THEN 'RMS SOFTWARE'
	WHEN ADY_XFILSF = '00901000100' THEN 'VIRTUAL AGE'
	WHEN ADY_XFILSF = '01002000100' THEN 'BPO'
	WHEN ADY_XFILSF = '01101000100' THEN 'CIASHOP'
	WHEN ADY_XFILSF = '01201000100' THEN 'PRX'
	WHEN ADY_XFILSF = '01301000100' THEN 'P2RX SOLUCOES E'
	WHEN ADY_XFILSF = '01401000100' THEN 'NEOLOG CONSULT'
	WHEN ADY_XFILSF = '01602000100' THEN 'CMNET PARTICIPACOES S/A'
	WHEN ADY_XFILSF = '01701000100' THEN 'MISTERCHEF SISTEMAS DE AUTOMACAO LTDA'
	WHEN ADY_XFILSF = '01802000100' THEN 'RJ PARTICIPACOES S/A'
	WHEN ADY_XFILSF = '01903000100' THEN 'BEMATECH S.A'
	WHEN ADY_XFILSF = '02001000100' THEN 'CMNET SOLUCOES EM INFORMATICA E AGENCIA'
	WHEN ADY_XFILSF = '02101000100' THEN 'RJ CONSULTORES INFORMATICA LTDA'
	WHEN ADY_XFILSF = '02201000100' THEN 'KERINA SOFTWARE LTDA'
	WHEN ADY_XFILSF = '02301000100' THEN 'TFS SOLUCOES EM SOFTWARE LTDA'
	WHEN ADY_XFILSF = '93601000100' THEN 'TOTVS GERENCIAL'
	WHEN ADY_XFILSF = '93701000100' THEN 'TOTVS GERENCIAL - ARGENTINA'
	WHEN ADY_XFILSF = '93801000100' THEN 'TOTVS GERENCIAL - MEXICO'
	WHEN ADY_XFILSF = '93901000100' THEN 'TOTVS GERENCIAL - EUA'
	WHEN ADY_XFILSF = '94001000100' THEN 'TOTVS GERENCIAL - DTS ARGENTINA'
	WHEN ADY_XFILSF = '94101000100' THEN 'BEMATECH GERENCIAL - BRASIL'
	WHEN ADY_XFILSF = '94203000100' THEN 'BIC GERENCIAL - BEMATECH USA'
	WHEN ADY_XFILSF = '94303000100' THEN 'BEMATECH GERENCIAL - ASIA'
	WHEN ADY_XFILSF = '02801000100' THEN 'WHEALTH SYSTEMS INFORMATICA'
	WHEN ADY_XFILSF = '02501000200' THEN 'TOTVS LARGE INTERPRISE - SÃO PAULO'
ELSE ' ' END AS DES_UNINEG

FROM ADY000 ADY

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM.D_E_L_E_T_ = ' ' 
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = ADY_XMODAL

LEFT JOIN ADZ000 ADZ ON ADZ_FILIAL = ' ' 
AND ADZ.D_E_L_E_T_ = ' ' 
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS

LEFT JOIN PKG000 PKG ON PKG_FILIAL = ' ' 
AND PKG.D_E_L_E_T_ = ' ' 
AND PKG_CODAGR = '000112'
AND PKG_CODNIV = ADY_XMODAL

WHERE ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' ' 
AND ADY_DTUPL BETWEEN @I_DTUPL@ AND @F_DTUPL@
AND ADY_XUNSRV = ' '
AND ADY_PROPOS BETWEEN @I_PROPOS@ AND @F_PROPOS@
AND ADY_XFILSF BETWEEN  @I_FILFAT@ AND @F_FILFAT@
AND ADY_XMODAL BETWEEN @I_AGRUP@ AND @F_AGRUP@;;
CRM063;LOG DE APLICAÇÃO DE SITEFAT NAS PROPOSTAS;73;20220307;;5;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
PLK_PROPOS
,PLK_DATA
,PLK_HORA
,PLK_CODUSR
,PLK_USER
,PLK_MODULO
,PLK_EMPDEF
,PLK_FILDEF
,PLK_OBS

FROM PLK000 PLK

WHERE PLK_FILIAL = ' ' 
AND PLK.D_E_L_E_T_ = ' '
AND PLK_PROPOS = @PROPOS@;;
CRMTAE;CONSULTA PROCESSOS DO TAE;73;20220210;;20;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
POX_CODIGO
,POR_DESCRI
,CASE
	WHEN POR_ATIVO = '1' THEN 'ATIVO'
	WHEN POR_ATIVO <> '1' THEN 'INATIVO'
END as POR_ATIVO
,POX_CHAVE
,POX_DTCRIA
,POX_HRCRIA
,POX_USCRIA
,USR_CODIGO
,POX_DTENV
,CASE 
	WHEN POX_STATEN = '1' THEN 'PENDENTE'
	WHEN POX_STATEN = '2' THEN 'ENVIADO'
	WHEN POX_STATEN = '3' THEN 'AGUARDANDO PROCESSO'
END AS POX_STATEN
,POX_DTRET
,CASE
	WHEN POX_STATRE = '1' THEN 'OK'
	WHEN POX_STATRE = '2' THEN 'ERRO'
	WHEN POX_STATRE = '3' THEN 'TENTATIVAS EXCEDIDAS'
END AS POX_STATRE
,POX_MSGRET

FROM POX000 POX

INNER JOIN POR000 POR ON POR_FILIAL = ' ' 
AND POR.D_E_L_E_T_ = ' ' 
AND POR_CODIGO = POX_CODIGO

LEFT JOIN SYS_USR USR ON USR.D_E_L_E_T_ = ' ' 
AND USR_ID = POX_USCRIA

WHERE POX_FILIAL = ' ' 
AND POX.D_E_L_E_T_ = ' '
AND POX_CODIGO IN ('000062','000063','000064','000065','000066','000067','000068','000069','000071','000072')
AND SUBSTR(POX_CHAVE,4,6) = @PROPOSTA@;;
CT2;LANCAMENTOS CONTABEIS;34;20200630;;5;2;CT2;0;;;;2;71;;;1;2;0;;;1;;;;
CTB001;FLAG DE APROPRIAÇÃO - PRESTAÇÃO DE CONTAS;34;20180827;;0;2;;0;;;;2;72;;;1;2;0;;;1;;SELECT 
FLF_FILIAL,
FLF_PRESTA,
FLF_PARTIC,
FLF_CC,
FLF_ITECTA,
FLF_CLVL,
FLF_STATUS,
FLF_LA,
FLF.R_E_C_N_O_ AS REC
FROM FLF000 FLF

WHERE FLF_PRESTA = @PRESTACAO@
AND FLF_FILIAL = @FILIAL@
AND FLF_PARTIC = @PARTICIPANTE@
AND FLF.D_E_L_E_T_ = ' '
;;
CTB002;DESPESAS DA PRESTAÇÃO DE CONTA - CTB001;34;20180827;;138;2;FLE;0;;;;2;73;;;1;2;0;;;1;;;;
CTB003;CONSULTA VIAGENS CONTABILIDADE;06;20181003;;2;2;;0;;;;2;74;;;1;2;0;;;1;;SELECT 
FLF_FILIAL,
FLF_PRESTA,
FLF_PARTIC,
FLF_EMISSA,
FLF_NACION,
FLF_STATUS,
FLF_ITECTA,
FLF_CLVL,
FLF_CC,
FLF_XCFP,
FLF_XFRENT,
FLD_FILIAL,
FLD_TITULO,
FLD_FORNEC,
FLD_PREFIX,
FLD_VIAGEM,
E1_FILIAL,
E1_NUM,
E1_PREFIXO,
E1_BAIXA,
E1_CLIENTE,
E2_FILIAL,
E2_NUM,
E2_PREFIXO,
E2_FORNECE,
E2_BAIXA

FROM FLF000 FLF

LEFT JOIN FO7000B FO7 ON FO7_FILIAL = FLF_FILIAL
AND FO7_PRESTA = FLF_PRESTA
AND FO7_PARTIC = FLF_PARTIC
AND FO7.D_E_L_E_T_ = ' ' 

LEFT JOIN FLD000 FLD ON FLF_FILIAL = FLD_FILIAL
AND FLF_PARTIC = FLD_PARTIC
AND FLF_PRESTA = FLD_VIAGEM 
AND FLD.D_E_L_E_T_ = ' '

LEFT JOIN SE1000 SE1 ON E1_FILIAL = FO7_FILIAL
AND E1_PREFIXO = FO7_PREFIX
AND E1_NUM =  FO7_TITULO
AND E1_CLIENTE = FO7_CLIFOR
AND SE1.D_E_L_E_T_ = ' '

LEFT JOIN SE2000 SE2 ON E2_FILIAL = FO7_FILIAL
AND E2_PREFIXO = FO7_PREFIX
AND E2_NUM =  FO7_TITULO
AND E2_FORNECE = FO7_CLIFOR
AND SE2.D_E_L_E_T_ = ' '

WHERE FLF_PRESTA = @VIAGEM@
AND FLF_FILIAL = @FILIAL@ 
AND FLF_PARTIC = @PARTIC@
AND FLF.D_E_L_E_T_ = ' '

GROUP BY FLF_FILIAL,
FLF_PRESTA,
FLF_PARTIC,
FLF_EMISSA,
FLF_NACION,
FLF_STATUS,
FLF_ITECTA,
FLF_CLVL,
FLF_CC,
FLF_XCFP,
FLF_XFRENT,
FLD_FILIAL,
FLD_TITULO,
FLD_FORNEC,
FLD_PREFIX,
FLD_VIAGEM,
E1_FILIAL,
E1_NUM,
E1_PREFIXO,
E1_BAIXA,
E1_CLIENTE,
E2_FILIAL,
E2_NUM,
E2_PREFIXO,
E2_FORNECE,
E2_BAIXA;;
CTB004;ADIANTAMENTO - CTB003;06;20181003;;9;2;;0;;;;2;75;;;1;2;0;;;1;;SELECT FLD.*
FROM <ADVPL>RetSqlName("FLD")</ADVPL> FLD
WHERE FLD_FILIAL = '<ADVPL>mv_par01</ADVPL>'
AND FLD_VIAGEM = '<ADVPL>mv_par03</ADVPL>'
AND FLD_PARTIC = '<ADVPL>mv_par02</ADVPL>'
AND FLD.D_E_L_E_T_ = ' '
;;
CTB005;ADIANTAMENTO FINANCEIRO - CTB003;06;20181003;;6;2;SE2;0;;;;2;76;;;1;2;0;;;1;;;;
CTB006;PAGAMENTO PRESTAÇÃO DE CONTAS - CTB003;06;20181004;;45;2;FO7;0;;;;2;77;;;1;2;0;;;1;;;;
CTB007;CONSULTA SN3;01;20190308;;1;2;;0;;;;2;78;;;1;2;0;;;1;;SELECT
N3_FILIAL ,
N3_CBASE  ,
N3_ITEM   ,
N3_TIPO,
N3_HISTOR ,
N3_CCONTAB,
N3_CUSTBEM,
N3_CDEPREC,
N3_CCDEPR ,
N3_DINDEPR,
N3_FIMDEPR,
N3_VORIG1 ,
N3_TXDEPR1,
N3_VRDMES1,
N3_VRCACM1,
N3_AQUISIC,
N3_DTBAIXA,
N3_CCDESP ,
N3_SUBCDEP,
N3_CLVLDEP

FROM SN3000 SN3

WHERE N3_FILIAL = @FILIAL@
AND SN3.D_E_L_E_T_ = ' ';;
CTK;PRE LANCAMENTO;34;20200701;;1;2;CTK;0;;;;2;79;;;1;2;0;;;1;;;;
CTTPRC;REAJUSTE DE VALORES DE CURSOS;26;20181210;;4;2;;1;OK;;;2;80;;;1;2;0;;;1;;SELECT '  ' AS OK, PDM.PDM_CURSO, PDM.PDM_NOME, PDM.PDM_CODSB1, PDM.PDM_VALOR,  PDM.PDM_MSBLQL, TAB.DA0_CODTAB, TAB.DA0_DESCRI, TAB.DA1_PRCVEN, SB1.B1_COD,    SB1.B1_DESC,  SB1.B1_ATIVO,   TAB.DA1_CODTAB, TAB.DA0_DATDE,  TAB.DA0_DATATE, TAB.DA0_ATIVO,  TAB.DA1_CODPRO,  PDM.R_E_C_N_O_ AS RECNO_PDM 
FROM PDM000 PDM
LEFT JOIN SB1000 SB1 ON SB1.B1_COD = PDM.PDM_CODSB1 AND SB1.D_E_L_E_T_ = ' '
LEFT JOIN (SELECT DA0.DA0_CODTAB,                  DA0.DA0_DESCRI, 
                  MAX(DA0.DA0_DATDE) AS DA0_DATDE, MAX(DA0.DA0_DATATE) AS DA0_DATATE, 
                  MAX(DA0.DA0_ATIVO) AS DA0_ATIVO, DA0.DA0_FILIAL, 
                  DA1.DA1_CODTAB,                  DA1.DA1_CODPRO,
                  MIN(DA1_PRCVEN)    AS DA1_PRCVEN
             FROM DA0000 DA0
             JOIN DA1000 DA1 ON DA1.DA1_CODTAB = DA0.DA0_CODTAB AND 
                                DA1.DA1_FILIAL = DA0.DA0_FILIAL AND  
                                DA1.D_E_L_E_T_ = ' '
            WHERE DA0.DA0_FILIAL = ' ' AND
                         DA0.D_E_L_E_T_ = ' ' 
            GROUP BY DA0.DA0_CODTAB, DA0.DA0_DESCRI, DA0.DA0_FILIAL, DA1.DA1_CODTAB, DA1.DA1_CODPRO
            ORDER BY DA0.DA0_CODTAB) TAB ON PDM.PDM_CODSB1 = TAB.DA1_CODPRO
WHERE PDM.PDM_FILIAL = ' ' AND
      SB1.B1_ATIVO = 'S' AND
      TAB.DA0_CODTAB = 'T17' AND
     PDM.D_E_L_E_T_ = ' ' 
ORDER BY PDM.PDM_NOME
;;Esta consulta personalizada tem como objetivo atualizar os preços de cursos do CTT x tabelas de preços do CRM.
FIN001;CONSULTA ITENS DE NOTAS DE ENTRADAS;06;20181029;;167;2;;0;;;;2;81;;;1;2;0;;;1;;SELECT
SD1.D1_FILIAL ,
SD1.D1_ITEM ,
SC7.C7_NUM ,
CASE SC7.C7_TPPED
WHEN '1' THEN 'Auto'
WHEN '2' THEN 'Cot'
WHEN '3' THEN 'Reg'
WHEN '4' THEN 'Recor'
WHEN '5' THEN 'Contr'
WHEN '6' THEN 'Comis'
WHEN '7' THEN 'Rev'
WHEN '8' THEN 'SI'
WHEN '9' THEN 'HE'
WHEN 'A' THEN 'CPR CTR/COT'
WHEN 'B' THEN 'Cpr Confi'
WHEN 'C' THEN 'Cpr Frota'
WHEN 'D' THEN 'Cpr Direta'
WHEN 'E' THEN 'Cpr TI/Cot'
WHEN 'F' THEN 'Compra Exclusiva'
END TPPEDIDO,
SC7.C7_EMISSAO ,
SD1.D1_FORNECE ,
SA2.A2_NOME ,
SD1.D1_CC ,
SD1.D1_CONTA ,
SD1.D1_ITEMCTA ,
SD1.D1_CLVL ,
SD1.D1_COD ,
SB1.B1_DESC ,
SD1.D1_CONTA ,
SD1.D1_DOC ,
SD1.D1_EMISSAO ,
SD1.D1_TOTAL 

FROM SD1000 SD1

LEFT JOIN SC7000X SC7
ON SD1.D1_FILIAL = SC7.C7_FILIAL 
AND SD1.D1_PEDIDO = SC7.C7_NUM
AND SD1.D1_ITEM = SC7.C7_ITEM
AND SD1.D1_COD = SC7.C7_PRODUTO
AND SC7.D_E_L_E_T_ = ' '

LEFT JOIN SA2000 SA2
ON SD1.D1_FORNECE = SA2.A2_COD
AND SA2.D_E_L_E_T_ = ' '

LEFT JOIN SB1000 SB1
ON SD1.D1_COD = SB1.B1_COD
AND SB1.D_E_L_E_T_ = ' '

WHERE
SD1.D1_EMISSAO BETWEEN @DATA@ AND @DATA2@
AND SD1.D_E_L_E_T_ = ' ';;
FIN002;RELATORIOS COMPROVANTES;06;20190920;;370;2;;0;;;;2;82;;;1;2;0;;;1;;SELECT E2_FILIAL || '-' || SIGA.M0_FILIAL AS FILIAL,
      EA_PREFIXO AS PRF,
      EA_NUM AS NUM_TIT,
	  EA_NUMBOR AS BORDERO,
      EA_PARCELA AS PC,
      E2_NOMFOR AS BENEFIC,
	  SE2.E2_FORMPAG,
	  SE2.E2_FORBCO,
      E2_VENCREA AS VENC_REA,
      E2_VALOR AS VALOR,
      CASE
          WHEN EA_CPVPGT = 1 THEN 'SIM'
          ELSE 'NAO'
      END AS COMPROV,
      E2_NATUREZ AS NATUREZA,
      E2_BAIXA AS BAIXA
FROM SE2000 SE2
INNER JOIN SEA000 SEA ON SUBSTR(SEA.EA_FILIAL, 1, 3) = SUBSTR(SE2.E2_FILIAL, 1, 3)
AND SEA.EA_PREFIXO = SE2.E2_PREFIXO
AND SEA.EA_NUM = SE2.E2_NUM
AND SEA.EA_PARCELA = SE2.E2_PARCELA
AND SEA.EA_NUMBOR = SE2.E2_NUMBOR
AND SEA.EA_TIPO = SE2.E2_TIPO
AND SEA.EA_CPVPGT <> ' '
AND SEA.EA_CART = 'P'
AND SEA.D_E_L_E_T_ = ' '

INNER JOIN SIGAMAT SIGA ON
SIGA.M0_CODFIL = SE2.E2_FILIAL
AND SIGA.D_E_L_E_T_ = ' '

LEFT JOIN SF1000 SF1 ON
SF1.F1_DOC = SE2.E2_NUM 
AND SF1.F1_SERIE = SE2.E2_PREFIXO
AND SF1.F1_FORNECE = SE2.E2_FORNECE
AND SF1.F1_LOJA = SE2.E2_LOJA
AND SF1.F1_FILIAL = SE2.E2_FILIAL
AND SF1.D_E_L_E_T_ = ' '

LEFT JOIN SE4000 SE4 ON
SE4.E4_CODIGO = SF1.F1_COND
AND SE4.D_E_L_E_T_ = ' '

WHERE SE2.E2_FILIAL <> ' '
 AND SEA.EA_CPVPGT = '1'
 AND SE2.E2_VENCREA BETWEEN @MVPAR001@ AND @MVPAR002@
 AND SE2.D_E_L_E_T_ = ' ';;
FIN003;TITULOS A PAGAR (COM CONTA CONTÁBIL);06;20191209;;971;2;;0;;;;2;83;;;1;2;0;;;1;;SELECT 

SE2.E2_FILIAL || '-' || SIGA.M0_FILIAL AS EMPRESA
,SE2.E2_PREFIXO
,SE2.E2_NUM
,SE2.E2_PARCELA
,SE2.E2_TIPO
,SE2.E2_NATUREZ
,SE2.E2_FORMPAG
,SE2.E2_PORTADO
,SE2.E2_FORNECE
,SE2.E2_LOJA
,SE2.E2_NOMFOR
,SE2.E2_EMISSAO
,SE2.E2_VENCTO
,SE2.E2_VENCREA
,SE2.E2_VALOR
,SE2.E2_IRRF
,SE2.E2_HIST
,SE2.E2_SALDO
,SE2.E2_MULTA
,SE2.E2_JUROS
,SE2.E2_VALJUR
,SE2.E2_PORCJUR
,SE2.E2_MOEDA
,SE2.E2_NUMBOR
,SE2.E2_VLCRUZ
,SE2.E2_ACRESC
,SE2.E2_INSS
,SE2.E2_DATALIB
,SE2.E2_APROVA
,SE2.E2_TXMOEDA
,SE2.E2_DECRESC
,SE2.E2_USUALIB
,SE2.E2_CODRET
,SE2.E2_MODSPB
,SE2.E2_CONTAD
,SE2.E2_CODORCA
,SE2.E2_DATACAN
,SE2.E2_FORBCO
,SE2.E2_FORAGE
,SE2.E2_FCTADV
,SE2.E2_TEMDOCS
,SE2.E2_CCUSTO
,SE2.E2_CODAPRO
,SE2.E2_DIACTB
,SE2.E2_NODIA
,SE2.E2_IDDARF
,SE2.E2_ITEMCTA
,SE2.E2_CLVL
,SED.ED_CODIGO
,SED.ED_DESCRIC
,SED.ED_XCCONTA

FROM SE2000 SE2 

INNER JOIN SED000 SED ON 
SED.ED_CODIGO = SE2.E2_NATUREZ 
AND SED.D_E_L_E_T_ = ' '

INNER JOIN SIGAMAT SIGA ON
SIGA.M0_CODFIL = SE2.E2_FILIAL
AND SIGA.D_E_L_E_T_ = ' '

WHERE 

SE2.E2_VENCREA BETWEEN @DATA1@ AND @DATA2@
AND SE2.D_E_L_E_T_ = ' ';;
FIN004;TITULOS A PAGAR (COM CONTA CONTÁBIL) RATEADO;06;20220107;;5;2;;0;;;;2;84;;;1;2;0;;;1;;SELECT 
DISTINCT
SE2.E2_FILIAL || '-' || SIGA.M0_FILIAL AS EMPRESA
,SE2.E2_PREFIXO
,SE2.E2_NUM
,SE2.E2_PARCELA
,SE2.E2_TIPO
,SE2.E2_NATUREZ
,SE2.E2_FORMPAG
,SE2.E2_PORTADO
,SE2.E2_FORNECE
,SE2.E2_LOJA
,SE2.E2_NOMFOR
,SE2.E2_EMISSAO
,SE2.E2_VENCTO
,SE2.E2_VENCREA
,SE2.E2_VALOR * CASE WHEN D1_TOTAL > 0 THEN (D1_TOTAL-D1_VALDESC)/F1_VALBRUT ELSE 1 END E2_VALOR
,SE2.E2_IRRF  * CASE WHEN D1_TOTAL > 0 THEN (D1_TOTAL-D1_VALDESC)/F1_VALBRUT ELSE 1 END E2_IRRF
,SE2.E2_HIST
,SE2.E2_SALDO  * CASE WHEN D1_TOTAL > 0 THEN (D1_TOTAL-D1_VALDESC)/F1_VALBRUT ELSE 1 END E2_SALDO
,SE2.E2_MULTA  * CASE WHEN D1_TOTAL > 0 THEN (D1_TOTAL-D1_VALDESC)/F1_VALBRUT ELSE 1 END E2_MULTA
,SE2.E2_JUROS  * CASE WHEN D1_TOTAL > 0 THEN (D1_TOTAL-D1_VALDESC)/F1_VALBRUT ELSE 1 END E2_JUROS
,SE2.E2_VALJUR  * CASE WHEN D1_TOTAL > 0 THEN (D1_TOTAL-D1_VALDESC)/F1_VALBRUT ELSE 1 END E2_VALJUR
,SE2.E2_PORCJUR  * CASE WHEN D1_TOTAL > 0 THEN (D1_TOTAL-D1_VALDESC)/F1_VALBRUT ELSE 1 END E2_PORCJUR
,SE2.E2_MOEDA
,SE2.E2_NUMBOR
,SE2.E2_VLCRUZ  * CASE WHEN D1_TOTAL > 0 THEN (D1_TOTAL-D1_VALDESC)/F1_VALBRUT ELSE 1 END E2_VLCRUZ
,SE2.E2_ACRESC  * CASE WHEN D1_TOTAL > 0 THEN (D1_TOTAL-D1_VALDESC)/F1_VALBRUT ELSE 1 END E2_ACRESC
,SE2.E2_INSS  * CASE WHEN D1_TOTAL > 0 THEN (D1_TOTAL-D1_VALDESC)/F1_VALBRUT ELSE 1 END E2_INSS
,SE2.E2_DATALIB
,SE2.E2_APROVA
,SE2.E2_TXMOEDA  * CASE WHEN D1_TOTAL > 0 THEN (D1_TOTAL-D1_VALDESC)/F1_VALBRUT ELSE 1 END E2_TXMOEDA
,SE2.E2_DECRESC  * CASE WHEN D1_TOTAL > 0 THEN (D1_TOTAL-D1_VALDESC)/F1_VALBRUT ELSE 1 END E2_DECRESC
,SE2.E2_USUALIB
,SE2.E2_CODRET
,SE2.E2_MODSPB
,SE2.E2_CONTAD
,SE2.E2_CODORCA
,SE2.E2_DATACAN
,SE2.E2_FORBCO
,SE2.E2_FORAGE
,SE2.E2_FCTADV
,SE2.E2_TEMDOCS
,SE2.E2_CCUSTO
,SE2.E2_CODAPRO
,SE2.E2_DIACTB
,SE2.E2_NODIA
,SE2.E2_IDDARF
,SE2.E2_ITEMCTA
,SE2.E2_CLVL
,SED.ED_CODIGO
,SED.ED_DESCRIC
,SED.ED_XCCONTA 
,COALESCE(D1_CONTA,E2_DEBITO) D1_CONTA 
,CTK_DEBITO

FROM SE2000 SE2 

INNER JOIN SED000 SED ON 
SED.ED_CODIGO = SE2.E2_NATUREZ 
AND SED.D_E_L_E_T_ = ' '

INNER JOIN SIGAMAT SIGA ON
SIGA.M0_CODFIL = SE2.E2_FILIAL
AND SIGA.D_E_L_E_T_ = ' '

LEFT JOIN  SF1000 F1 ON
 F1_FILIAL   = E2_FILIAL
 AND F1_DOC   = E2_NUM  
 AND F1_SERIE   = E2_PREFIXO
 AND F1_FORNECE = E2_FORNECE
 AND F1_LOJA    = E2_LOJA      
 AND F1.D_E_L_E_T_= ' '
LEFT JOIN SD1000 D1 ON 
D1_FILIAL	   = F1_FILIAL 
AND D1_DOC	   = F1_DOC 
AND D1_SERIE   = F1_SERIE 
AND D1_FORNECE = F1_FORNECE
AND D1_LOJA    = F1_LOJA    
AND D1.D_E_L_E_T_= ' ' 
LEFT JOIN  CTK000 CTK ON
CTK.CTK_FILIAL = D1.D1_FILIAL  AND 
CTK.CTK_RECORI = D1.R_E_C_N_O_  AND
CTK.CTK_TABORI = 'SD1'  

WHERE 

SE2.E2_VENCREA BETWEEN @DATA1@ AND @DATA2@
AND SE2.D_E_L_E_T_ = ' ';;
GAREST;RELATÓRIO GARANTIA ESTENDIDA;73;20180608;;12;2;;0;;;;2;84;;;1;2;0;;;1;;SELECT DISTINCT
A1_COD
,A1_CGC
,A1_NOME
,A1_CODSEG
,AOV_DESSEG
,A1_VEND
,SA31.A3_NOME AS NOMEEAR
,A1_XGAR
,SA32.A3_NOME AS NOMEGAR
,A1_CODMEMB
,ADK_NOME
,AD1_NROPOR
,SUBSTR(AD1_DATA,7,2) || '/' || SUBSTR(AD1_DATA,5,2) || '/' || SUBSTR(AD1_DATA,1,4) AS AD1_DATA
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTA'
WHEN AD1_STATUS = '2' THEN 'PERDIDA'
WHEN AD1_STATUS = '9' THEN 'GANHA'
END AS AD1_STATUS
,ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS ADY_STATUS
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_TOTAL

FROM SA1000 SA1
INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' '
AND AD1_CODCLI = A1_COD
AND AD1.D_E_L_E_T_ = ' '

INNER JOIN ADY000 ADY ON ADY_FILIAL = ' '
AND ADY_OPORTU = AD1_NROPOR
AND ADY_REVISA = AD1_REVISA

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS
AND ADZ_PRODUT IN ('1111001024','1111001084','1111001154','1111001156','1111001159','1111001160','1111001161','1111001162','1111001163','1111001164','1111001236','1111001237','1111001238','1111001239','1111001240','1111001241')
AND ADZ.D_E_L_E_T_ = ' '

LEFT JOIN AOV000 AOV ON AOV_FILIAL = ' '
AND AOV_CODSEG = A1_CODSEG
AND AOV_PAI = ' '
AND AOV.D_E_L_E_T_ = ' '

LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' '
AND SA31.A3_COD = A1_VEND
AND SA31.D_E_L_E_T_ = ' '

LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' '
AND SA32.A3_COD = A1_XGAR
AND SA32.D_E_L_E_T_ = ' '

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK_COD = A1_CODMEMB
AND ADK.D_E_L_E_T_ = ' '
WHERE A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' ';;Relatório para extração das propostas de garantia estendida.
GCT001;PROPOSTAS ESPUMINHA;69;20181031;;12;2;;0;;;;2;85;;;1;2;0;;;1;;SELECT DISTINCT
ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS STAT_PROP
,ADY_DATA
,ADY_DTUPL
,UTL_RAW.CAST_TO_VARCHAR2(DBMS_LOB.SUBSTR(ADY.ADY_XMEMNE, 2000,1)) AS XMEMNE
,CASE 
WHEN ADY_XTPVEN = '8' THEN 'INTERA'
END AS ADY_XTPVEN
,CASE
WHEN ADZ_XCARIN = '1' THEN 'SIM'
WHEN ADZ_XCARIN <> '1' THEN 'NAO'
END AS ADZ_XCARIN
,ADY_CODIGO
,A1_NOME
						
FROM ADY000 ADY

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_COD = ADY_CODIGO

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' ' 
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS 

WHERE ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' '	
AND ADY_XTPVEN ='8'
AND ADY_STATUS IN ('H','K','I','J')
AND ADZ_XCARIN = '1'
AND ADY_DTUPL BETWEEN @I_DTUPL@ AND @F_DTUPL@;;
GCT002;CONSULTA ZAL;69;20181228;;14;2;;0;;;;2;86;;;1;2;0;;;1;;SELECT DISTINCT
ZAL_CONTRA
,ZAL_REVISA
,ZAL_CLIENT
,A1_XSITCLI
,ZAL_PROPOS
,ZAL_VERSAO
,ZAL_ITPR
,ZAL_DTCRIA
,ZAL_ANOREF
,ZAL_TPCNPJ
,ZAL_CGCPRI
,ZAL_CGCAGR
,ZAL_NOMAGR
,ZAL_PRET
,ZAL_PRAR
,ZAL_STATUS
,ZAL_MTRINI
,ZAL_MTRREA
,ZAL_MTRINF
,ZAL_DTMINF
,ZAL_MTRDIP
,ZAL_DTDIPJ
,ZAL_DOCENT
,ZAL_OBSERV
,ZAL_ORIGEM
,ZAL_TRIBUT
,ZAL_DTCONT
,ZAL_PRCDU
,ZAL_DTDOC
,ZAL_TXREAJ
,ZAL_ANOREA
,ZAL_DTEXAG
,ZAL_REAJ
,ZAL_SEGMEN
,ZAL_INDICE
,ZAL_CONDIC
,ZAL_FTMULT
,ZAL_PREVIS
,ZAL_CEI
,ZAL_CNIS
,ZAL_CAFIR
,ZAL_CODIGO
,ZAL_DTINFR
,ZAL_MTINFR
,ZAL_MTDIFR
,ZAL_MTRESP
,ZAL_MTRDEC
,ZAL_DTMESP
,ZAL_PASESP
,ZAL_METECF
,ZAL_AUDIT

FROM ZAL000X ZAL

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' ' 
AND A1_COD = ZAL_CLIENT

WHERE ZAL_FILIAL = ' ' 
AND ZAL.D_E_L_E_T_ = ' '
AND ZAL_ANOREF BETWEEN @I_ANOREF@ AND @F_ANOREF@
AND A1_XSITCLI IN <ADVPL> IF(_SITUA = '1', " ('1')", IF(_SITUA = '2', " (' ','2')",  " (' ','1','2')"))  </ADVPL>;;
GCT003;AVALIAÇÃO MÉTRICAS DO CORPORATIVO;69;20190128;;38;2;;0;;;;2;87;;;1;2;0;;;1;;SELECT DISTINCT
ZTS_CODCLI
,ZTS_PROPOS
,DA1_CODTAB
,DA1_CODPRO
,B1_DESC
,CASE
WHEN DA1_ATIVO = '1' THEN 'ATIVO'
WHEN DA1_ATIVO <> '1' THEN 'INATIVO'
END AS DA1_ATIVO
,DA1_DATVIG
,DA1_XCATPR
,DA1_XSEGME
,DA1_XMETRI

FROM ZTS000 ZTS

INNER JOIN ADY000 ADY ON ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' ' 
AND ADY_PROPOS = ZTS_PROPOS

INNER JOIN ZAV000 ZAV ON ZAV_FILIAL = ' ' 
AND ZAV.D_E_L_E_T_ = ' '
AND ZAV_CODIGO = ZTS_PROPOS
AND ZAV_VERSAO = ADY_PREVIS

LEFT JOIN ADZ000 ADZ ON ADZ_FILIAL = ' ' 
AND ADZ.D_E_L_E_T_ = ' ' 
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS

LEFT JOIN DA1000 DA1 ON DA1_FILIAL = ' ' 
AND DA1.D_E_L_E_T_ = ' ' 
AND DA1_CODTAB = ADY_TABELA
AND DA1_CODPRO = ADZ_PRODUT
AND ZAV_SEGMEN = DA1_XSEGME
AND ZAV_CATEG = DA1_XCATPR

LEFT JOIN SB1000 SB1 ON B1_FILIAL = ' ' 
AND SB1.D_E_L_E_T_ = ' ' 
AND B1_COD = DA1_CODPRO

WHERE ZTS_FILIAL = ' ' 
AND ZTS.D_E_L_E_T_ = ' '
AND ZTS_CODCLI = @CLIENTE@;;
GCT004;RELATÓRIO DE MEDIÇÕES;69;20190523;;70;2;;0;;;;2;88;;;1;2;0;;;1;;SELECT DISTINCT
CND_FILIAL
,CND_NUMMED
,CND_CONTRA
,CND_REVISA
,CND_COMPET
,CND_FORNEC
,CND_LJFORN
,CND_XCLIEN
,CND_LOJACL
,CND_VLTOT
,CND_TOTADT
,CASE
	WHEN CND_MOEDA = '1' THEN 'REAL'
	WHEN CND_MOEDA = '2' THEN 'DOLAR'
	WHEN CND_MOEDA = '3' THEN 'UFIR'
	WHEN CND_MOEDA = '4' THEN 'EURO'
	WHEN CND_MOEDA = '5' THEN 'DOLAR TURISMO'
	WHEN CND_MOEDA = '6' THEN 'PESO MEXICANO'
	WHEN CND_MOEDA = '7' THEN 'PESO ARGENTINO'
END AS CND_MOEDA
,CND_DTINIC
,CND_DTFIM
,CND_VLMEAC
,CND_VLSALD
,CND_DTVENC
,CND_DATAFI
,CASE
	WHEN CND_ZERO = '1' THEN 'SIM'
	WHEN CND_ZERO <> '1' THEN 'NAO'
END AS CND_ZERO
,CND_CONDPG
,CND_VLCONT
,CND_VLADIT
,CND_VLREAJ
,CND_NUMERO
,CND_MEDRET
,CASE
	WHEN CND_RETIFI = '1' THEN 'SIM'
	WHEN CND_RETIFI <> '1' THEN 'NAO'
END AS CND_RETIFI
,CND_FLREAJ
,CND_VLPREV
,CND_DESCME
,CND_PEDIDO
,CND_RESID
,CND_SERVIC
,CND_FILMED
,CND_ULTMED
,CND_RECMED
,CND_VLMULT
,CND_VLBONI
,CND_VLLIQD
,CND_XUSEGI
,CND_XIDPSA
,CND_XNRPSA

FROM CND000 CND

WHERE CND.D_E_L_E_T_ = ' ' 
AND CND_FILIAL BETWEEN @I_FILIAL@ AND @F_FILIAL@
AND CND_CONTRA BETWEEN @I_CONTRA@ AND @F_CONTRA@
AND SUBSTR(CND_COMPET,4,4)||SUBSTR(CND_COMPET,1,2) BETWEEN <ADVPL>"'" + RIGHT(_I_COMPET,4) + LEFT(_I_COMPET,2) + "'"</ADVPL> 
AND <ADVPL>"'" + RIGHT(_F_COMPET,4) + LEFT(_F_COMPET,2)+ "'"</ADVPL>
AND CND_PEDIDO BETWEEN @I_PEDIDO@ AND @F_PEDIDO@
AND CND_NUMMED BETWEEN @I_NUMMED@ AND @F_NUMMED@
;;
GCT005;CONSULTA FAT PROPOSTAS;69;20190613;;56;2;;0;;;;2;89;;;1;2;0;;;1;;SELECT
CASE WHEN ADY_XFILSF = '00001000100 ' THEN 'TOTVS MATRIZ'
WHEN ADY_XFILSF = '00001000600 ' THEN 'TOTVS JOINVILLE'
WHEN ADY_XFILSF = '00001000800 ' THEN 'TOTVS RIO - FILIAL'
WHEN ADY_XFILSF = '00001001000 ' THEN 'TOTVS ALPHAVILLE'
WHEN ADY_XFILSF = '00001001100 ' THEN 'TOTVS PORTO ALEGRE'
WHEN ADY_XFILSF = '00001001200 ' THEN 'TOTVS BELO HORIZONTE'
WHEN ADY_XFILSF = '00001001700 ' THEN 'TOTVS SANTA CATARINA'
WHEN ADY_XFILSF = '00001001900 ' THEN 'TOTVS CAMPINAS'
WHEN ADY_XFILSF = '00001002000 ' THEN 'TOTVS BRASILIA - FILIAL'
WHEN ADY_XFILSF = '00001002100 ' THEN 'TOTVS ITAIM'
WHEN ADY_XFILSF = '00001002200 ' THEN 'TOTVS RECIFE - FILIAL'
WHEN ADY_XFILSF = '00001002300 ' THEN 'TOTVS MACAE'
WHEN ADY_XFILSF = '00001002500 ' THEN 'TOTVS SOROCABA'
WHEN ADY_XFILSF = '00001002600 ' THEN 'TOTVS CAXIAS DO SUL'
WHEN ADY_XFILSF = '00001002700 ' THEN 'TOTVS ASSIS - FILIAL'
WHEN ADY_XFILSF = '00102000100 ' THEN 'TOTVS SERVICOS - MATRIZ RIO'
WHEN ADY_XFILSF = '00102000200 ' THEN 'TOTVS SERVICOS - MACAÉ'
WHEN ADY_XFILSF = '00102000300 ' THEN 'TOTVS SERVICOS - RIO'
WHEN ADY_XFILSF = '00102000400 ' THEN 'TOTVS SERVICOS - BELO HORIZONTE'
WHEN ADY_XFILSF = '00102000500 ' THEN 'TOTVS SERVICOS - RECIFE'
WHEN ADY_XFILSF = '00102000700 ' THEN 'TOTVS SERVICOS - CAMPINAS'
WHEN ADY_XFILSF = '00102000800 ' THEN 'TOTVS SERVICOS - ALPHAVILLE'
WHEN ADY_XFILSF = '00102000900 ' THEN 'TOTVS SERVICOS - SP SERVICOS1631'
WHEN ADY_XFILSF = '00102001000 ' THEN 'TOTVS SERVICOS - CAXIAS'
WHEN ADY_XFILSF = '00102001100 ' THEN 'TOTVS SERVICOS - SANTA CATARINA'
WHEN ADY_XFILSF = '00102001200 ' THEN 'TOTVS SERVICOS - BRASILIA'
WHEN ADY_XFILSF = '00202000100 ' THEN 'TOTVS RECIFE - EMPRESA'
WHEN ADY_XFILSF = '00302000100 ' THEN 'TOTVS BRASILIA - EMPRESA'
WHEN ADY_XFILSF = '00302000200 ' THEN 'TOTVS BRASILIA - FILIAL B.HORIZONTE'
WHEN ADY_XFILSF = '00302000300 ' THEN 'TOTVS BRASILIA - FILIAL FORTALEZA'
WHEN ADY_XFILSF = '00302000500 ' THEN 'TOTVS BRASILIA - FILIAL GOIANIA'
WHEN ADY_XFILSF = '00401000100 ' THEN 'TOTVS TV DIGITAL'
WHEN ADY_XFILSF = '00501000100 ' THEN 'TOTVS VENTURE'
WHEN ADY_XFILSF = '00601000100 ' THEN 'TOTVS W D'
WHEN ADY_XFILSF = '00701000100 ' THEN 'PC INFORMATICA S.A.'
WHEN ADY_XFILSF = '00701000200 ' THEN 'PC INFORMATICA S.A.'
WHEN ADY_XFILSF = '00701000400 ' THEN 'PC INFORMATICA FORTALEZA'
WHEN ADY_XFILSF = '00801000100 ' THEN 'RMS SOFTWARE'
WHEN ADY_XFILSF = '00901000100 ' THEN 'VIRTUAL AGE'
WHEN ADY_XFILSF = '01002000100 ' THEN 'BPO'
WHEN ADY_XFILSF = '01101000100 ' THEN 'CIASHOP'
WHEN ADY_XFILSF = '01201000100 ' THEN 'PRX'
WHEN ADY_XFILSF = '01301000100 ' THEN 'P2RX SOLUCOES E'
WHEN ADY_XFILSF = '01401000100 ' THEN 'NEOLOG CONSULT'
WHEN ADY_XFILSF = '01602000100 ' THEN 'CMNET PARTICIPACOES S/A'
WHEN ADY_XFILSF = '01701000100 ' THEN 'MISTERCHEF SISTEMAS DE AUTOMACAO LTDA'
WHEN ADY_XFILSF = '01802000100 ' THEN 'RJ PARTICIPACOES S/A'
WHEN ADY_XFILSF = '01903000100 ' THEN 'BEMATECH S.A'
WHEN ADY_XFILSF = '02001000100 ' THEN 'CMNET SOLUCOES EM INFORMATICA E AGENCIA'
WHEN ADY_XFILSF = '02101000100 ' THEN 'RJ CONSULTORES INFORMATICA LTDA'
WHEN ADY_XFILSF = '02201000100 ' THEN 'KERINA SOFTWARE LTDA'
WHEN ADY_XFILSF = '02301000100 ' THEN 'TFS SOLUCOES EM SOFTWARE LTDA'
WHEN ADY_XFILSF = '93601000100 ' THEN 'TOTVS GERENCIAL'
WHEN ADY_XFILSF = '93701000100 ' THEN 'TOTVS GERENCIAL - ARGENTINA'
WHEN ADY_XFILSF = '93801000100 ' THEN 'TOTVS GERENCIAL - MEXICO'
WHEN ADY_XFILSF = '93901000100 ' THEN 'TOTVS GERENCIAL - EUA'
WHEN ADY_XFILSF = '94001000100 ' THEN 'TOTVS GERENCIAL - DTS ARGENTINA'
WHEN ADY_XFILSF = '94101000100 ' THEN 'BEMATECH GERENCIAL - BRASIL'
WHEN ADY_XFILSF = '94203000100 ' THEN 'BIC GERENCIAL - BEMATECH USA'
WHEN ADY_XFILSF = '94303000100 ' THEN 'BEMATECH GERENCIAL - ASIA'
ELSE 'FILIAL NÃO ENCONTRADA'
END AS ADY_XFILSF
,ADY_CODIGO
,ADY_PROPOS
,CASE 				
	WHEN ady_status = 'A' THEN 'ABERTO' 				
	WHEN ady_status = 'B' THEN 'FECHADA' 				
	WHEN ady_status = 'C' THEN 'CANCELADA' 				
	WHEN ady_status = 'D' THEN 'REPROVADA' 				
	WHEN ady_status = 'E' THEN 'APROVADA' 				
	WHEN ady_status = 'F' THEN 'BLOQUEADA' 				
	WHEN ady_status = 'G' THEN 'UPLOAD PENDENTE' 				
	WHEN ady_status = 'H' THEN 'AGUARDANDO ANALISE' 				
	WHEN ady_status = 'I' THEN 'CONTRATO GERADO' 				
	WHEN ady_status = 'J' THEN 'PEDIDO DE VENDA GERADO' 				
	WHEN ady_status = 'K' THEN 'NF GERADA' 				
	WHEN ady_status = 'Z' THEN 'FATURADA ADQUIRIDA' 				
	WHEN ady_status = 'Y' THEN 'PENDENTE EASY SALES' 				
END AS ADY_STATUS
,ADY_DTUPL
,ADZ_PRODUT
,ADZ_DESCRI
,AOM_DESCRI
,CASE
WHEN ADZ_XSITUA = 'F' THEN 'FATURAR'
WHEN ADZ_XSITUA = 'G' THEN 'GRATUITO'
WHEN ADZ_XSITUA = 'N' THEN 'NUNCA FATURAR HW'
WHEN ADZ_XSITUA = 'S' THEN 'SOB CONSUMO'
END AS ADZ_XSITUA
,ADZ_PRCVEN
,ADZ_TOTAL
,ADZ_XCOMPE
,C6_NUM
,C6_NOTA

FROM ADY000 ADY

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' ' 
AND ADZ.D_E_L_E_T_ = ' ' 
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS

LEFT JOIN SC6000 SC6 ON SC6.D_E_L_E_T_ = ' ' 
AND C6_XPROPOS = ADZ_PROPOS
AND C6_PRODUTO = ADZ_PRODUT

LEFT JOIN SB1000 SB1 ON B1_FILIAL = ' ' 
AND SB1.D_E_L_E_T_ = ' ' 
AND B1_COD = ADZ_PRODUT

LEFT JOIN SBM000 SBM ON BM_FILIAL = ' ' 
AND SBM.D_E_L_E_T_ = ' ' 
AND BM_GRUPO = B1_GRUPO

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' ' 
AND AOM.D_E_L_E_T_ = ' ' 
AND AOM_CODAGR = '000001'
AND AOM_CODNIV = BM_XLINREC

WHERE ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' '
AND ady_dtupl BETWEEN @I_DATA2@ AND @F_DATA2@
<ADVPL> IF(_OPC = "1","AND SUBSTR(BM_XLINREC,1,2) NOT IN ('05','08','12') ",IF(_OPC = "2","AND SUBSTR(BM_XLINREC,1,2) IN ('05','08','12')"," " ))</ADVPL>
AND ADY_CODIGO BETWEEN @I_CLI@ AND @F_CLI@
AND ADY_STATUS = 'K'
AND ady_xfilsf BETWEEN @I_FILIAL@ AND @F_FILIAL@;;
GCT006;CLIENTES X VEND X UNIDADE;69;20200512;;13;2;;0;;;;2;90;;;1;2;0;;;1;;SELECT DISTINCT
A1_COD
,A1_NOME
,A1_VEND
,A3_NOME
,A1_CODMEMB
,ADK_NOME

FROM SA1000 SA1

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' 
AND SA3.D_E_L_E_T_ = ' ' 
AND A3_COD = A1_VEND

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' ' 
AND ADK_COD = A1_CODMEMB

WHERE A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' ';;
GCVPEN;PENDENCIAS CRONOGRAMA;69;20201005;;23;2;;0;;;;2;;;;1;2;0;;;2;1;select count(*) as TOTAL FROM (  SELECT * FROM GCVPEN WHERE D_E_L_E_T_ = ' '  ) 
;;
GENCLI;RELATÓRIO DE CLIENTES;05;20211222;;2;2;;0;;;;2;;;;1;2;0;;;1;;SELECT DISTINCT
A1_COD
,A1_NOME
,A1_CGC
,A1_DDD
,A1_TEL
,A1_XEMAILF

FROM SA1000 SA1

WHERE A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' ';;
INTPMU;MONITORAMENTO DA INTEGRACAO DE PROPOSTAS;73;20200610;;23;2;;0;;;;2;91;;;1;2;0;;;1;2;SELECT PMU_FILIAL, PMU_CINTEG, PMU_IDSEQ, PMU_PROPOS, PMU_PRPEXT, PMU_DTPRPE, PMU_HRPRPE, PMU_STPRPE, X5_DESCRI, PMU_CLIENT, PMU_CNPCLI, 
       PMU_VENDED, PMU_TABPRC,
	   extract(day from 24 * 60 * (to_timestamp('<ADVPL>Dtos(dDataBase) + " " + Time()</ADVPL>', 'YYYY-MM-DD HH24:MI:SS') - to_timestamp(PMU_DTPRPE || ' ' || PMU_HRPRPE, 'YYYY-MM-DD HH24:MI:SS'))) as MINUTOS
  FROM <ADVPL>RetSqlName('PMU')</ADVPL> PMU
  LEFT JOIN <ADVPL>RetSqlName('SX5')</ADVPL> SX5 ON X5_FILIAL = ' ' AND X5_TABELA = 'ZL' AND X5_CHAVE = PMU_STPRPE AND SX5.D_E_L_E_T_ = ' '   
 WHERE PMU_FILIAL = '<ADVPL>xFilial('PMU')</ADVPL>' AND PMU_SITUAC = '1' AND PMU_CINTEG = @PMU_CINTEG@ AND PMU_STPRPE IN ('1', '2', '3', '4', 'E')
   AND PMU_DTPRPE BETWEEN @I_PMU_DTPRPE@ AND @F_PMU_DTPRPE@ 
   AND extract(day from 24 * 60 * (to_timestamp('<ADVPL>Dtos(dDataBase) + " " + Time()</ADVPL>', 'YYYY-MM-DD HH24:MI:SS') - to_timestamp(PMU_DTPRPE || ' ' || PMU_HRPRPE, 'YYYY-MM-DD HH24:MI:SS'))) > @DIF_MINUTOS@
   AND PMU.D_E_L_E_T_ = ' ';;Formulario para monitoramento de propostas que nao chegaram a etapa de contrato gerado
MEDDEL;MEDIÇÃO DELETADA COM PEDIDO;69;20200721;;2;2;;0;;;;2;92;;;1;2;0;;;1;2;SELECT CNE.CNE_FILIAL,
CNE.CNE_CONTRA,
CNE.CNE_NUMERO,
CND.CND_COMPET,
CND.CND_XCLIEN,
CNE.CNE_ITEM  ,
CNE.CNE_NUMMED,
CND.D_E_L_E_T_,
CNE.D_E_L_E_T_,
C6_FILIAL, C6_NUM, C6_PRODUTO, C6_ITEM, C6_XITMPLA, C6_NOTA
FROM <ADVPL>RetSqlName('CND')</ADVPL> CND

LEFT JOIN <ADVPL>RetSqlName('CND')</ADVPL>  CNDE
ON CNDE.CND_FILIAL = CND.CND_FILIAL
AND CNDE.CND_NUMMED = CND.CND_NUMMED
AND CNDE.CND_CONTRA = CND.CND_CONTRA
AND CNDE.CND_XCLIEN = CND.CND_XCLIEN
AND CNDE.D_E_L_E_T_ = ' ' 

LEFT JOIN <ADVPL>RetSqlName('CNE')</ADVPL> CNE
ON CNE_FILIAL = CND.CND_FILIAL
AND CNE_NUMMED = CND.CND_NUMMED
AND CNE_CONTRA = CND.CND_CONTRA

INNER JOIN <ADVPL>RetSqlName('SC5')</ADVPL> SC5
ON C5_FILIAL = CND.CND_FILIAL
AND C5_MDNUMED = CND.CND_NUMMED
AND C5_CLIENTE = CND.CND_XCLIEN
AND SC5.D_E_L_E_T_ = ' ' 
 
INNER JOIN <ADVPL>RetSqlName('SC6')</ADVPL>  SC6 
ON C6_FILIAL = CNE_FILIAL
AND C6_NUM = C5_NUM
AND SC6.D_E_L_E_T_ = ' '

WHERE CND.CND_FILIAL IS NOT NULL
AND CND.CND_XCLIEN <> '  '
AND CND.CND_COMPET = @CNDCOMPET@
AND CND.D_E_L_E_T_ = '*'
AND CNDE.CND_NUMMED IS NULL;;Retorna medições que foram deletadas com pedido.
MEDDUP;MEDIÇÕES DUPLICADAS;69;20200721;;15;2;;0;;;;2;93;;;1;2;0;;;1;1;SELECT CNEP.CNE_FILIAL,
CNEP.CNE_CONTRA,
CNEP.CNE_NUMERO,
CNDP.CND_COMPET,
CNDP.CND_DTINIC,
CNDP.CND_XCLIEN,
CNEP.CNE_ITEM  ,
CNEP.CNE_NUMMED,
CNDP.D_E_L_E_T_,
CNEP.D_E_L_E_T_,
C5_MDCONTR,
C5_NUM,
C5_EMISSAO,
C6_FILIAL, C6_NUM, C6_PRODUTO, B1_DESC, C6_ITEMCNB,C6_XITMPLA, C6_NOTA,
D2_DOC, D2_SERIE, D2_EMISSAO, D2_QUANT, D2_PRCVEN, D2_TOTAL,
D1_DOC, D1_SERIE, D1_EMISSAO, D1_QUANT, D1_VUNIT, D1_TOTAL, D1_QTDEDEV
FROM 
(
SELECT 
CNE.CNE_FILIAL,
CNE.CNE_CONTRA,
CND.CND_NUMERO,
CND.CND_COMPET,
CND.CND_XCLIEN,
CNE.CNE_ITEM  ,
COUNT(CNE.CNE_NUMMED)

FROM <ADVPL>RetSqlName('CND')</ADVPL> CND
INNER JOIN  <ADVPL>RetSqlName('CNE')</ADVPL> CNE
ON CNE_FILIAL = CND_FILIAL
AND CNE_NUMMED = CND_NUMMED
AND CNE_CONTRA = CND_CONTRA
AND CNE.D_E_L_E_T_ = ' ' 

LEFT JOIN  <ADVPL>RetSqlName('SC5')</ADVPL> SC5
ON C5_FILIAL = CND_FILIAL
AND C5_MDNUMED = CND_NUMMED
AND C5_CLIENTE = CND_XCLIEN
AND C5_MDCONTR = CND_CONTRA
AND SC5.D_E_L_E_T_ = ' ' 


LEFT JOIN  <ADVPL>RetSqlName('SC6')</ADVPL> SC6 
ON C6_FILIAL = C5_FILIAL
AND C6_NUM = C5_NUM
AND C6_CONTRT = CNE_CONTRA
AND C6_XITMPLA = CNE_ITEM
AND C6_CLI = CND_XCLIEN
AND SC6.D_E_L_E_T_ = ' '


LEFT JOIN  <ADVPL>RetSqlName('SD2')</ADVPL> SD2 
ON D2_FILIAL = C6_FILIAL
AND D2_PEDIDO = C6_NUM
AND D2_ITEMPV = C6_ITEM
AND SD2.D_E_L_E_T_ = ' ' 

LEFT JOIN  <ADVPL>RetSqlName('SD1')</ADVPL> SD1 
ON D1_FILIAL = D2_FILIAL
AND D1_SERIORI = D2_SERIE
AND D1_NFORI = D2_DOC
AND D1_ITEMORI = D2_ITEM
AND SD1.D_E_L_E_T_ = ' '                                                                                                                                    
                         

WHERE CND_FILIAL IS NOT NULL
AND CND_CONTRA IS NOT NULL
AND CND_COMPET = @CNDCOMPE@
AND CND_XCLIEN <>  '  '
AND CND.D_E_L_E_T_ = ' ' 
AND D1_DOC IS NULL

GROUP BY CNE.CNE_FILIAL,
CNE.CNE_CONTRA,
CND.CND_NUMERO,
CND.CND_COMPET,
CND.CND_XCLIEN,
CNE.CNE_ITEM 

 

HAVING COUNT(CNE.CNE_NUMMED) > 1) DUPLI

INNER JOIN  <ADVPL>RetSqlName('CND')</ADVPL> CNDP
ON  CNDP.CND_FILIAL = DUPLI.CNE_FILIAL
AND CNDP.CND_CONTRA = DUPLI.CNE_CONTRA
AND CNDP.CND_NUMERO = DUPLI.CND_NUMERO
AND CNDP.CND_COMPET = DUPLI.CND_COMPET
AND CNDP.CND_XCLIEN = DUPLI.CND_XCLIEN
AND CNDP.D_E_L_E_T_ = ' ' 


INNER JOIN  <ADVPL>RetSqlName('CNE')</ADVPL> CNEP
ON  CNEP.CNE_FILIAL = CNDP.CND_FILIAL
AND CNEP.CNE_CONTRA = CNDP.CND_CONTRA 
AND CNEP.CNE_NUMMED = CNDP.CND_NUMMED
AND CNEP.CNE_ITEM   = DUPLI.CNE_ITEM
AND CNEP.D_E_L_E_T_ = ' ' 


LEFT JOIN  <ADVPL>RetSqlName('SC5')</ADVPL> SC5
ON C5_FILIAL = CNDP.CND_FILIAL
AND C5_MDNUMED = CNDP.CND_NUMMED
AND C5_CLIENTE = CNDP.CND_XCLIEN
AND C5_MDCONTR = CNDP.CND_CONTRA
AND SC5.D_E_L_E_T_ = ' ' 


LEFT JOIN  <ADVPL>RetSqlName('SC6')</ADVPL> SC6 
ON C6_FILIAL = C5_FILIAL
AND C6_NUM = C5_NUM
AND C6_CONTRT = CNEP.CNE_CONTRA
AND C6_XITMPLA = CNEP.CNE_ITEM
AND C6_CLI = CNDP.CND_XCLIEN
AND SC6.D_E_L_E_T_ = ' '

LEFT JOIN  <ADVPL>RetSqlName('SB1')</ADVPL> SB1
ON B1_FILIAL = ' ' 
AND B1_COD = C6_PRODUTO
AND SB1.D_E_L_E_T_ = ' ' 

LEFT JOIN  <ADVPL>RetSqlName('ZQJ')</ADVPL> ZQJ
ON ZQJ.ZQJ_FILIAL = ' ' 
AND ZQJ_ATIVO = 'S'
AND ZQJ.D_E_L_E_T_ = ' ' 

LEFT JOIN  <ADVPL>RetSqlName('ZQK')</ADVPL> ZQK
ON ZQK.ZQK_FILIAL = ' ' 
AND ZQK_CODZQJ = ZQJ_CODIGO
AND ZQK_GRUPO = B1_GRUPO
AND ZQK.D_E_L_E_T_ = ' ' 

LEFT JOIN  <ADVPL>RetSqlName('SD2')</ADVPL> SD2 
ON D2_FILIAL = C6_FILIAL
AND D2_PEDIDO = C6_NUM
AND D2_ITEMPV = C6_ITEM
AND SD2.D_E_L_E_T_ = ' ' 

LEFT JOIN  <ADVPL>RetSqlName('SD1')</ADVPL> SD1 
ON D1_FILIAL = D2_FILIAL
AND D1_SERIORI = D2_SERIE
AND D1_NFORI = D2_DOC
AND D1_ITEMORI = D2_ITEM
AND SD1.D_E_L_E_T_ = ' ' 

WHERE COALESCE(ZQJ_CODESP, ' ') = ' '

ORDER BY CNEP.CNE_FILIAL, CNEP.CNE_CONTRA, CNEP.CNE_NUMERO, CNEP.CNE_ITEM, CNDP.CND_XCLIEN, CNDP.CND_COMPET;;Medições duplicadas por competencia e item de contrato.
MODHRS;QUANTIDADE DE HORA DOS MODELOS POR GRUPO DE OFERTA;73;20210629;;2;2;;0;;;;2;;;;1;2;0;;;1;;SELECT AF5.AF5_ORCAME
	,AF5.AF5_DESCRI
	,PVT_DESCRI
	,SUM(AF2.AF2_QUANT) AF2_QUANT
FROM AF1000 AF1
INNER JOIN AF5000 AF5 ON AF5.D_E_L_E_T_ = ' '
	AND AF5.AF5_FILIAL = '           '
	AND AF5.AF5_ORCAME = AF1.AF1_ORCAME
	AND AF5.AF5_VERSAO = AF1.AF1_VERSAO
INNER JOIN AF2000 AF2 ON AF2.D_E_L_E_T_ = ' '
	AND AF2.AF2_FILIAL = '           '
	AND AF2.AF2_ORCAME = AF5.AF5_ORCAME
	AND AF2.AF2_VERSAO = AF5.AF5_VERSAO
	AND AF2.AF2_EDTPAI = AF5.AF5_EDT
INNER JOIN PVT000 PVT ON PVT.PVT_FILIAL = '           '
	AND  AF2.AF2_XGRPOF LIKE '%' || PVT.PVT_CODIGO || '%'
	AND PVT.D_E_L_E_T_ = ' '
WHERE AF1.AF1_FILIAL = '           '
	AND AF1.AF1_XEASY = '1'
	AND AF1.AF1_ORCAME NOT IN ('EASY000105')
	AND AF1.D_E_L_E_T_ = ' '
GROUP BY PVT_DESCRI
	,AF5.AF5_ORCAME
	,AF5.AF5_DESCRI
ORDER BY AF5.AF5_ORCAME, PVT_DESCRI;;
NFCANC;NOTAS FISCAIS CANCELADAS DE CONTRATOS;69;20200319;;12;2;;0;;;;2;94;;;1;2;0;;;1;;SELECT PHO_FILIAL, PHO_COMPET, PHO_CLIENT, PHO_LOJACL, PHO_CONTRA, PHO_REVISA, PHO_NOTA, PHO_SERIE, PHO_EMISSA, PHO_DATCAN, PHO_VALFAT, PHO_GU FROM PHO000 PHO
WHERE PHO_CLIENT BETWEEN @I_CODCLI@ AND @F_CODCLI@
AND PHO.D_E_L_E_T_ = ' ';;
OPOAPN;OPORTUNIDADES COM INDICADOR APN;73;20180523;;51;2;;0;;;;2;95;;;1;2;0;;;1;;SELECT DISTINCT
AD1_NROPOR,
AD1_DESCRI,
AD1_RCINIC,
AD1_XVLDSA,
ADJ_CODNIV,
AOM1.AOM_DESCRI DESC_NIV,
AOM1.AOM_NIVPAI,
AOM2.AOM_DESCRI DESC_PAI,
CASE
WHEN AD1_STATUS = '1' THEN 'Em Aberto'
WHEN AD1_STATUS = '2' THEN 'Perdida'
WHEN AD1_STATUS = '9' THEN 'Ganha'
END AS AD1_STATUS,
AD1_FCS,
ZX51.ZX5_DESCRI AS DESC_FCS,
AD1_FCI,
ZX52.ZX5_DESCRI AS DESC_FCI,
AD1_DATA,
AD1_DTPFIM,
AD2_VEND,
SA32.A3_NOME AS NOME_TIME,
AD2_CODCAR,
SUM1.UM_DESC AS CARGO,
AD2_CODPAP,
SUM2.UM_DESC AS PAPEL,
AD2_PERC,
AD2_UNIDAD,
ADK2.ADK_NOME AS UN_TIME,
ADY_PROPOS,
CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS ADY_STATUS,
'CLIENTE' AS ENTIDADE,
AD1_CODCLI AS CODCLI,
A1_NOME,
A1_CGC,
A1_VEND,
SA31.A3_NOME,
A1_CODMEMB,
ADK1.ADK_NOME,
AD2_XDATDE
FROM AD1000 AD1
INNER JOIN SA1000 SA1 ON A1_FILIAL = ' ' AND A1_COD = AD1_CODCLI AND SA1.D_E_L_E_T_ = ' '
INNER JOIN AD2000 AD2 ON AD2_FILIAL = ' ' AND AD2_NROPOR = AD1_NROPOR AND AD2_REVISA = AD1_REVISA AND (AD2_CODPAP IN ('000437','000424') OR AD2_CODCAR IN ('000437','000424')) AND AD2.D_E_L_E_T_ = ' '
INNER JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' ' AND SA32.A3_COD = AD2_VEND AND SA32.D_E_L_E_T_ = ' '
INNER JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' ' AND SA31.A3_COD = A1_VEND AND SA31.D_E_L_E_T_ = ' '
INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK2 ON ADK2.ADK_FILIAL = ' ' AND ADK2.ADK_COD = AD2_UNIDAD AND ADK2.D_E_L_E_T_ = ' '
INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK1 ON ADK1.ADK_FILIAL = ' ' AND ADK1.ADK_COD = A1_CODMEMB AND ADK1.D_E_L_E_T_ = ' '
LEFT JOIN ZX5000 ZX51 ON ZX51.ZX5_FILIAL = ' ' AND ZX51.ZX5_TABELA = 'CRM001' AND ZX51.ZX5_CHAVE = AD1_FCS AND ZX51.D_E_L_E_T_ = ' '
LEFT JOIN ZX5000 ZX52 ON ZX52.ZX5_FILIAL = ' ' AND ZX52.ZX5_TABELA = 'CRM003' AND ZX52.ZX5_CHAVE = AD1_FCI AND ZX52.D_E_L_E_T_ = ' '
LEFT JOIN ADJ000 ADJ ON ADJ_FILIAL = ' ' AND ADJ_NROPOR = AD1_NROPOR AND ADJ.D_E_L_E_T_ = ' '
LEFT JOIN AOM000 AOM1 ON AOM1.AOM_FILIAL = ' ' AND AOM1.AOM_CODAGR = ADJ_CODAGR AND AOM1.AOM_CODNIV = ADJ_CODNIV AND AOM1.D_E_L_E_T_ = ' '
LEFT JOIN AOM000 AOM2 ON AOM2.AOM_FILIAL = ' ' AND AOM2.AOM_CODAGR = ADJ_CODAGR AND AOM2.AOM_CODNIV = AOM1.AOM_NIVPAI AND AOM2.D_E_L_E_T_ = ' '
LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' ' AND ADY_OPORTU = AD1_NROPOR AND ADY.D_E_L_E_T_ = ' '
LEFT JOIN SUM000 SUM1 ON SUM1.UM_FILIAL = ' ' AND SUM1.UM_CARGO = AD2_CODCAR AND SUM1.D_E_L_E_T_ = ' '
LEFT JOIN SUM000 SUM2 ON SUM2.UM_FILIAL = ' ' AND SUM2.UM_CARGO = AD2_CODPAP AND SUM2.D_E_L_E_T_ = ' '
WHERE AD1_FILIAL = ' ' AND AD1_DATA BETWEEN @I_AD1_DATA@ AND @F_AD1_DATA@ AND AD1.D_E_L_E_T_ = ' '
UNION ALL
SELECT DISTINCT
AD1_NROPOR,
AD1_DESCRI,
AD1_RCINIC,
AD1_XVLDSA,
ADJ_CODNIV,
AOM1.AOM_DESCRI DESC_NIV,
AOM1.AOM_NIVPAI,
AOM2.AOM_DESCRI DESC_PAI,
CASE
WHEN AD1_STATUS = '1' THEN 'Em Aberto'
WHEN AD1_STATUS = '2' THEN 'Perdida'
WHEN AD1_STATUS = '9' THEN 'Ganha'
END AS AD1_STATUS,
AD1_FCS,
ZX51.ZX5_DESCRI AS DESC_FCS,
AD1_FCI,
ZX52.ZX5_DESCRI AS DESC_FCI,
AD1_DATA,
AD1_DTPFIM,
AD2_VEND,
SA32.A3_NOME AS NOME_TIME,
AD2_CODCAR,
SUM1.UM_DESC AS CARGO,
AD2_CODPAP,
SUM2.UM_DESC AS PAPEL,
AD2_PERC,
AD2_UNIDAD,
ADK2.ADK_NOME AS UN_TIME,
CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS ADY_STATUS,
ADY_STATUS,
'PROSPECT' AS ENTIDADE,
AD1_PROSPE AS CODCLI,
US_NOME,
US_CGC,
US_VEND,
SA31.A3_NOME,
US_CODMEMB,
ADK1.ADK_NOME,
AD2_XDATDE
FROM AD1000 AD1
INNER JOIN SUS000 SUS ON US_FILIAL = ' ' AND US_COD = AD1_PROSPE AND SUS.D_E_L_E_T_ = ' '
INNER JOIN AD2000 AD2 ON AD2_FILIAL = ' ' AND AD2_NROPOR = AD1_NROPOR AND AD2_REVISA = AD1_REVISA AND (AD2_CODPAP IN ('000437','000424') OR AD2_CODCAR IN ('000437','000424')) AND AD2.D_E_L_E_T_ = ' '
INNER JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' ' AND SA32.A3_COD = AD2_VEND AND SA32.D_E_L_E_T_ = ' '
INNER JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' ' AND SA31.A3_COD = US_VEND AND SA31.D_E_L_E_T_ = ' '
INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK2 ON ADK2.ADK_FILIAL = ' ' AND ADK2.ADK_COD = AD2_UNIDAD AND ADK2.D_E_L_E_T_ = ' '
INNER JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK1 ON ADK1.ADK_FILIAL = ' ' AND ADK1.ADK_COD = US_CODMEMB AND ADK1.D_E_L_E_T_ = ' '
LEFT JOIN ZX5000 ZX51 ON ZX51.ZX5_FILIAL = ' ' AND ZX51.ZX5_TABELA = 'CRM001' AND ZX51.ZX5_CHAVE = AD1_FCS AND ZX51.D_E_L_E_T_ = ' '
LEFT JOIN ZX5000 ZX52 ON ZX52.ZX5_FILIAL = ' ' AND ZX52.ZX5_TABELA = 'CRM003' AND ZX52.ZX5_CHAVE = AD1_FCI AND ZX52.D_E_L_E_T_ = ' '
LEFT JOIN ADJ000 ADJ ON ADJ_FILIAL = ' ' AND ADJ_NROPOR = AD1_NROPOR AND ADJ.D_E_L_E_T_ = ' '
LEFT JOIN AOM000 AOM1 ON AOM1.AOM_FILIAL = ' ' AND AOM1.AOM_CODAGR = ADJ_CODAGR AND AOM1.AOM_CODNIV = ADJ_CODNIV AND AOM1.D_E_L_E_T_ = ' '
LEFT JOIN AOM000 AOM2 ON AOM2.AOM_FILIAL = ' ' AND AOM2.AOM_CODAGR = ADJ_CODAGR AND AOM2.AOM_CODNIV = AOM1.AOM_NIVPAI AND AOM2.D_E_L_E_T_ = ' '
LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' ' AND ADY_OPORTU = AD1_NROPOR AND ADY.D_E_L_E_T_ = ' '
LEFT JOIN SUM000 SUM1 ON SUM1.UM_FILIAL = ' ' AND SUM1.UM_CARGO = AD2_CODCAR AND SUM1.D_E_L_E_T_ = ' '
LEFT JOIN SUM000 SUM2 ON SUM2.UM_FILIAL = ' ' AND SUM2.UM_CARGO = AD2_CODPAP AND SUM2.D_E_L_E_T_ = ' '
WHERE AD1_FILIAL = ' ' AND AD1_DATA BETWEEN @I_AD1_DATA@ AND @F_AD1_DATA@ AND AD1.D_E_L_E_T_ = ' ';;Consulta que apresenta todas oportunidades geradas com assistente de prospeccao no time de vendas
OPTSRV;OPORTUNIDADES SERVIÇOS;73;20200803;;122;2;;0;;;;2;96;;;1;2;0;;;1;;<ADVPL>IF(_ENTIDA = "2","SELECT DISTINCT 'CLIENTE' AS ENTIDADE ,AD1_NROPOR, AD1_DESCRI, CASE WHEN AD1_STATUS = '1' THEN 'ABERTA' WHEN AD1_STATUS = '9' THEN 'GANHA' WHEN AD1_STATUS = '2' THEN 'PERDIDA' END AS AD1_STATUS,ADY_DATA,AD1_DTFIM,ADY_PROPOS,(SELECT DISTINCT SUM(ADZ_TOTAL) FROM ADZ000 ADZ WHERE ADZ_FILIAL = ' ' AND ADZ.D_E_L_E_T_ = ' ' AND ADZ_PROPOS = ADY_PROPOS AND ADZ_REVISA = ADY_PREVIS) AS TOTAL,(SELECT DISTINCT SUM(ADZ_QTDVEN) FROM ADZ000 ADZ WHERE ADZ_FILIAL = ' ' AND ADZ.D_E_L_E_T_ = ' ' AND ADZ_PROPOS = ADY_PROPOS AND ADZ_REVISA = ADY_PREVIS) AS QTDTOTAL,ADJ_CODNIV,AOM_DESCRI,AD1_CODCLI AS COD_CONT,A1_NOME AS RAZAO,A1_DTCAD DTINCLUSAO,AD1_VEND AS COD_VEND,A3_NOME,A3_UNIDAD,ADK_NOME NOM_UNID,ADY_XUNSRV,PE1_DESCRI,AD1_XUSRCR,USR_NOME FROM PKG000 PKG INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' ' AND ADJ_CODAGR = '000112' AND ADJ_CODNIV = PKG_CODNIV AND ADJ.D_E_L_E_T_ = ' ' INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' ' AND AD1_NROPOR = ADJ_NROPOR AND AD1_REVISA = ADJ_REVISA AND AD1.D_E_L_E_T_ = ' ' INNER JOIN SA1000 SA1 ON A1_FILIAL = ' ' AND A1_COD = AD1_CODCLI AND A1_LOJA = AD1_LOJCLI AND SA1.D_E_L_E_T_ = ' ' INNER JOIN AOM000 AOM ON AOM_FILIAL = ' ' AND AOM_CODAGR = '000112' AND AOM_CODNIV = ADJ_CODNIV AND AOM.D_E_L_E_T_ = ' ' LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' AND A3_COD = AD1_VEND AND SA3.D_E_L_E_T_ = ' ' LEFT JOIN ADK000 ADK ON ADK_FILIAL = ' ' AND ADK_COD = A3_UNIDAD AND ADK.D_E_L_E_T_ = ' ' LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' ' AND ADY_OPORTU = AD1_NROPOR AND ADY_REVISA = AD1_REVISA AND ADY.D_E_L_E_T_ = ' ' LEFT JOIN PE1000 PE1 ON PE1_FILIAL = ' ' AND PE1_CODIGO = ADY_XUNSRV AND PE1.D_E_L_E_T_ = ' ' LEFT JOIN SYS_USR USR ON USR_ID = AD1_XUSRCR AND USR.D_E_L_E_T_ = ' ' WHERE PKG_FILIAL = ' ' AND PKG.D_E_L_E_T_ = ' ' AND PKG_CODAGR = '000112' AND PKG_TPVEND = '2' AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@","SELECT DISTINCT 'PROSPECT' AS ENTIDADE,AD1_NROPOR, AD1_DESCRI, CASE WHEN AD1_STATUS = '1' THEN 'ABERTA' WHEN AD1_STATUS = '9' THEN 'GANHA' WHEN AD1_STATUS = '2' THEN 'PERDIDA' END AS AD1_STATUS,ADY_DATA,AD1_DTFIM,ADY_PROPOS,(SELECT DISTINCT SUM(ADZ_TOTAL) FROM ADZ000 ADZ WHERE ADZ_FILIAL = ' ' AND ADZ.D_E_L_E_T_ = ' ' AND ADZ_PROPOS = ADY_PROPOS AND ADZ_REVISA = ADY_PREVIS) AS TOTAL,(SELECT DISTINCT SUM(ADZ_QTDVEN) FROM ADZ000 ADZ WHERE ADZ_FILIAL = ' ' AND ADZ.D_E_L_E_T_ = ' ' AND ADZ_PROPOS = ADY_PROPOS AND ADZ_REVISA = ADY_PREVIS) AS QTDTOTAL,ADJ_CODNIV,AOM_DESCRI,AD1_PROSPE AS COD_CONT,US_NOME AS RAZAO,US_DTCAD DTINCLUSAO,AD1_VEND AS COD_VEND,A3_NOME,A3_UNIDAD,ADK_NOME NOM_UNID,ADY_XUNSRV,PE1_DESCRI,AD1_XUSRCR,USR_NOME FROM PKG000 PKG INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' ' AND ADJ_CODAGR = '000112' AND ADJ_CODNIV = PKG_CODNIV AND ADJ.D_E_L_E_T_ = ' ' INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' ' AND AD1_NROPOR = ADJ_NROPOR AND AD1_REVISA = ADJ_REVISA AND AD1.D_E_L_E_T_ = ' ' INNER JOIN SUS000 SUS ON US_FILIAL = ' ' AND US_COD = AD1_PROSPE AND US_LOJA = AD1_LOJPRO AND SUS.D_E_L_E_T_ = ' ' INNER JOIN AOM000 AOM ON AOM_FILIAL = ' ' AND AOM_CODAGR = '000112' AND AOM_CODNIV = ADJ_CODNIV AND AOM.D_E_L_E_T_ = ' ' LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' AND A3_COD = AD1_VEND AND SA3.D_E_L_E_T_ = ' ' LEFT JOIN ADK000 ADK ON ADK_FILIAL = ' ' AND ADK_COD = A3_UNIDAD AND ADK.D_E_L_E_T_ = ' ' LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' ' AND ADY_OPORTU = AD1_NROPOR AND ADY_REVISA = AD1_REVISA AND ADY.D_E_L_E_T_ = ' ' LEFT JOIN PE1000 PE1 ON PE1_FILIAL = ' ' AND PE1_CODIGO = ADY_XUNSRV AND PE1.D_E_L_E_T_ = ' ' LEFT JOIN SYS_USR USR ON USR_ID = AD1_XUSRCR AND USR.D_E_L_E_T_ = ' ' WHERE PKG_FILIAL = ' ' AND PKG.D_E_L_E_T_ = ' ' AND PKG_CODAGR = '000112' AND PKG_TPVEND = '2' AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@")</ADVPL>;;
ORCHRS;HORAS DOS ORCAMENTOS REALIZADOS NO SIMULADOR DE SE;73;20210630;;7;2;;0;;;;2;;;;1;2;0;;;1;;SELECT ADY_PROPOS || ADY_PREVIS PROPOSTA
	,AD1_DESCRI
	,ADY_DATA
	,ADY_STATUS
	,AD1_VEND
	,A3_NOME
	,A3_UNIDAD
	,ADK_NOME
	,ADY_XUNSRV
	,PE1_DESCRI
	,AD1_XUSRCR
	,USR_NOME
	,AF5_ORCAME
	,AF5_DESCRI
	,AF2_QUANT
FROM ADY000 ADY
INNER JOIN (
	SELECT ADZ_PROPOS
		,ADZ_REVISA
		,ADZ_PMS
		,ADZ_PMSVER
	FROM ADZ000 ADZ
	WHERE ADZ_FILIAL = '           '
		AND EXISTS (
			SELECT 'OK'
			FROM AF1000 AF1
			WHERE AF1_FILIAL = '           '
				AND AF1_ORCAME = ADZ_PMS
				AND AF1_VERSAO = ADZ_PMSVER
				AND UTL_RAW.CAST_TO_VARCHAR2(DBMS_LOB.SUBSTR(AF1.AF1_XJSONW, 2000)) <> ' '
				AND AF1.D_E_L_E_T_ = ' '
			)
		AND ADZ.D_E_L_E_T_ = ' '
	GROUP BY ADZ_PROPOS
		,ADZ_REVISA
		,ADZ_PMS
		,ADZ_PMSVER
	) ADZTRB
	ON ADZTRB.ADZ_PROPOS = ADY_PROPOS
	AND ADZTRB.ADZ_REVISA = ADY_PREVIS
INNER JOIN (
	SELECT AF5.AF5_ORCAME
		,AF5.AF5_VERSAO
		,AF5.AF5_DESCRI
		,SUM(AF2.AF2_QUANT) AF2_QUANT
	FROM AF1000 AF1
	INNER JOIN AF5000 AF5
		ON AF5.D_E_L_E_T_ = ' '
			AND AF5.AF5_FILIAL = '           '
			AND AF5.AF5_ORCAME = AF1.AF1_ORCAME
			AND AF5.AF5_VERSAO = AF1.AF1_VERSAO
	INNER JOIN AF2000 AF2
		ON AF2.D_E_L_E_T_ = ' '
			AND AF2.AF2_FILIAL = '           '
			AND AF2.AF2_ORCAME = AF5.AF5_ORCAME
			AND AF2.AF2_VERSAO = AF5.AF5_VERSAO
			AND AF2.AF2_EDTPAI = AF5.AF5_EDT
	WHERE AF1.AF1_FILIAL = '           '
		AND UTL_RAW.CAST_TO_VARCHAR2(DBMS_LOB.SUBSTR(AF1.AF1_XJSONW, 2000)) <> ' '
		AND AF1.D_E_L_E_T_ = ' '
	GROUP BY AF5.AF5_ORCAME
		,AF5.AF5_VERSAO
		,AF5.AF5_DESCRI
	) ORC
	ON ORC.AF5_ORCAME = ADZTRB.ADZ_PMS
		AND ORC.AF5_VERSAO = ADZTRB.ADZ_PMSVER
INNER JOIN AD1000 AD1
	ON AD1_FILIAL = ' '
		AND AD1_NROPOR = ADY_OPORTU
		AND AD1_REVISA = ADY_REVISA
		AND AD1.D_E_L_E_T_ = ' '
LEFT JOIN SA3000 SA3
	ON A3_FILIAL = ' '
		AND A3_COD = AD1_VEND
		AND SA3.D_E_L_E_T_ = ' '
LEFT JOIN ADK000 ADK
	ON ADK_FILIAL = ' '
		AND ADK_COD = A3_UNIDAD
		AND ADK.D_E_L_E_T_ = ' '
LEFT JOIN PE1000 PE1
	ON PE1_FILIAL = ' '
		AND PE1_CODIGO = ADY_XUNSRV
		AND PE1.D_E_L_E_T_ = ' '
LEFT JOIN SYS_USR USR ON USR_ID = AD1_XUSRCR
	AND USR.D_E_L_E_T_ = ' '
WHERE ADY_FILIAL = '           '
	AND ADY.D_E_L_E_T_ = ' '
ORDER BY PROPOSTA
	,AF5_ORCAME
	,AF2_QUANT;;
PHJ;TEMPO MEDIO;69;20220427;;1;2;PHJ;0;;;;2;PJ;;;1;2;0;;;2;;;;Formulario para Visualização do tempo Medio
PHWCON;CONSULTA PEDIDOS DE PEDIDOS GERADOS (PHW);05;20200928;;56;2;;0;;;;2;01;;;1;2;0;;;1;;SELECT  
ADYFILIAL, ADYPROPOS, ADYPREVIS, ADYDTUPL, ADYHRUPLO,  
PHWDTINI, PHWDTFIM, PHWHRINI, PHWHRFIM, PEDIDO, MIN(MINEMISSAO), PHWCUSER, PHWNUSER, HORAS, MINUTOS, SEGUNDOS,
PHWSERVID,PHWPORTA,ADYXMODAL,ADYXTPVEN, ADYTPD,ADYCODIGO,ADYLOJA , ADYLRAT    

FROM (  

SELECT  
ADY.ADY_FILIAL ADYFILIAL, ADY.ADY_PROPOS ADYPROPOS, ADY.ADY_PREVIS ADYPREVIS, ADZ.ADZ_ITEM, ADZ.ADZ_FOLDER,
CND.CND_NUMMED, CND.CND_XCLIEN, CND_COMPET, SC5.C5_EMISSAO MINEMISSAO,  SC5.C5_NUM PEDIDO,
CNB.CNB_CONTRA, CNB.CNB_REVISA, CNB.CNB_NUMERO, CNB.CNB_ITEM,
ADY.ADY_DTUPL ADYDTUPL, ADY.ADY_HRUPLO ADYHRUPLO,  PHW.PHW_DTINI PHWDTINI,  PHW.PHW_DTFIM PHWDTFIM,
PHW.PHW_HRINI  PHWHRINI, PHW.PHW_HRFIM PHWHRFIM, PHW.PHW_CUSER PHWCUSER, PHW.PHW_NUSER PHWNUSER, 

trunc(24 * (TO_DATE(    CONCAT ( CONCAT( TO_CHAR(to_date( PHW.phw_dtFIM),'DD/MM/YYYY') , ' ') , PHW.phw_HRFIM ), 'dd/mm/yyyy hh24:mi:ss') - 
TO_DATE(  CONCAT ( CONCAT( TO_CHAR(to_date( PHW.phw_dtini),'DD/MM/YYYY') , ' ') , PHW.phw_HRINI ), 'dd/mm/yyyy hh24:mi:ss'))) AS horas,

abs(trunc((MOD(MOD(TO_DATE(  CONCAT ( CONCAT( TO_CHAR(to_date( PHW.phw_dtFIM),'DD/MM/YYYY') , ' ') , PHW.phw_HRFIM ), 'dd/mm/yyyy hh24:mi:ss') - 
TO_DATE(  CONCAT ( CONCAT( TO_CHAR(to_date( PHW.phw_dtini),'DD/MM/YYYY') , ' ') , PHW.phw_HRINI ), 'dd/mm/yyyy hh24:mi:ss'), 1) * 24, 1) * 60))) AS minutos,

abs(trunc((MOD((MOD(MOD(TO_DATE(  CONCAT ( CONCAT( TO_CHAR(to_date( PHW.phw_dtFIM),'DD/MM/YYYY') , ' ') , PHW.phw_HRFIM ), 'dd/mm/yyyy hh24:mi:ss') - 
TO_DATE(  CONCAT ( CONCAT( TO_CHAR(to_date( PHW.phw_dtini),'DD/MM/YYYY') , ' ') , PHW.phw_HRINI ), 'dd/mm/yyyy hh24:mi:ss'), 1) * 24, 1) * 60), 1) * 60))) AS segundos
,PHW.PHW_SERVID PHWSERVID
,PHW.PHW_PORTA  PHWPORTA
,ADY.ADY_XMODAL ADYXMODAL
,ADY.ADY_XTPVEN ADYXTPVEN 
,ADY.ADY_CODIGO ADYCODIGO 
,ADY.ADY_LOJA  ADYLOJA 
,case when (ADY.ADY_LRAT = 'T')  then 'TRUE' else 'FALSE' end as   ADYLRAT  
,case when (ADY.ADY_XTPVEN = '1')  then 'Aluguel de Software' 
 when (ADY.ADY_XTPVEN = '2')  then 'Venda Tradicional'
 when (ADY.ADY_XTPVEN = '3')  then 'Corporativo'
 when (ADY.ADY_XTPVEN = '4')  then 'Migracao'
 when (ADY.ADY_XTPVEN = '5')  then 'Troca de Licensa'
 when (ADY.ADY_XTPVEN = '6')  then 'Renovacao'
 when (ADY.ADY_XTPVEN = '7')  then 'Totvs Store'
 when (ADY.ADY_XTPVEN = '8')  then 'Intera'
 when (ADY.ADY_XTPVEN = '9')  then 'Intera Ilimitado'
else ' ' end as   ADYTPD  

FROM ADY000 ADY  
INNER JOIN PHW000 PHW ON  
PHW.PHW_CHAVE = ('ADY' || ADY_FILIAL || ADY_PROPOS) AND
PHW.R_E_C_N_O_ = (SELECT MAX(PHW2.R_E_C_N_O_)
                  FROM PHW000 PHW2
                  WHERE PHW2.D_E_L_E_T_ = ' '  
                  AND   PHW.PHW_CHAVE = PHW2.PHW_CHAVE )

INNER JOIN ADZ000 ADZ ON
ADZ.ADZ_PROPOS = ADY.ADY_PROPOS AND
ADZ.ADZ_REVISA = ADY.ADY_PREVIS AND
ADZ.ADZ_FILIAL = ADY.ADY_FILIAL

INNER JOIN CNB000 CNB ON
CNB.CNB_FILIAL = ADZ.ADZ_FILIAL AND
CNB.CNB_PROPOS = ADZ.ADZ_PROPOS AND
CNB.CNB_PROREV = ADZ.ADZ_REVISA AND
CNB.CNB_PROITN = ADZ.ADZ_ITEM   AND
CNB.CNB_XFLDPR = ADZ.ADZ_FOLDER

INNER JOIN CND000 CND ON
CND_FILIAL IS NOT NULL
AND CND_CONTRA = CNB.CNB_CONTRA
AND CND_REVISA = CNB.CNB_REVISA
AND CND_NUMERO = CNB.CNB_NUMERO
AND CND_COMPET =
CONCAT(CONCAT(SUBSTR ( CAST( ADY.ADY_DTUPL AS CHAR(10) ), 5, 2  ), '/'     ),  SUBSTR ( CAST( ADY.ADY_DTUPL AS CHAR(10) ), 1, 4  ) )

LEFT JOIN SC5000 SC5 ON
C5_FILIAL = CND_FILIAL
AND C5_MDNUMED = CND_NUMMED
AND C5_CLIENTE = CND_XCLIEN


WHERE  
ADY.ADY_DTUPL BETWEEN @I_DATA@ AND @F_DATA@ AND  
PHW.PHW_DTINI >= @I_DATA@ AND
ADZ.D_E_L_E_T_ = ' ' AND
CNB.D_E_L_E_T_ = ' ' AND
ADY.D_E_L_E_T_ = ' ' AND
CND.D_E_L_E_T_ = ' ' AND
PHW.D_E_L_E_T_ = ' ' AND
SC5.D_E_L_E_T_ = ' ' AND 
PHW.phw_dtFIM <> ' ' AND  
PHW.phw_dtini <> ' '  AND 
PHW.phw_HRFIM <> ' ' AND 
PHW.phw_HRINI <> ' ' 


union

select 
ADY.ADY_FILIAL ADYFILIAL, ADY.ADY_PROPOS ADYPROPOS, ADY.ADY_PREVIS ADYPREVIS, ADZ.ADZ_ITEM, ADZ.ADZ_FOLDER,
CND.CND_NUMMED, CND.CND_XCLIEN, CND_COMPET, SC5.C5_EMISSAO MINEMISSAO,  SC5.C5_NUM PEDIDO,
CNB.CNB_CONTRA, CNB.CNB_REVISA, CNB.CNB_NUMERO, CNB.CNB_ITEM,
ADY.ADY_DTUPL ADYDTUPL, ADY.ADY_HRUPLO ADYHRUPLO,  PHW.PHW_DTINI PHWDTINI,  PHW.PHW_DTFIM PHWDTFIM,
PHW.PHW_HRINI  PHWHRINI, PHW.PHW_HRFIM PHWHRFIM, PHW.PHW_CUSER PHWCUSER, PHW.PHW_NUSER PHWNUSER,

0 AS horas,
0 AS minutos,
0 AS segundos   
,PHW.PHW_SERVID PHWSERVID
,PHW.PHW_PORTA  PHWPORTA
,ADY.ADY_XMODAL ADYXMODAL
,ADY.ADY_XTPVEN ADYXTPVEN 
,ADY.ADY_CODIGO ADYCODIGO 
,ADY.ADY_LOJA  ADYLOJA 
, case when (ADY.ADY_LRAT = 'T')  then 'TRUE' else 'FALSE' end as   ADYLRAT 
,case when (ADY.ADY_XTPVEN = '1')  then 'Aluguel de Software' 
 when (ADY.ADY_XTPVEN = '2')  then 'Venda Tradicional'
 when (ADY.ADY_XTPVEN = '3')  then 'Corporativo'
 when (ADY.ADY_XTPVEN = '4')  then 'Migracao'
 when (ADY.ADY_XTPVEN = '5')  then 'Troca de Licensa'
 when (ADY.ADY_XTPVEN = '6')  then 'Renovacao'
 when (ADY.ADY_XTPVEN = '7')  then 'Totvs Store'
 when (ADY.ADY_XTPVEN = '8')  then 'Intera'
 when (ADY.ADY_XTPVEN = '9')  then 'Intera Ilimitado'
else ' ' end as   ADYTPD  

FROM ADY000 ADY  
INNER JOIN PHW000 PHW ON  
PHW.PHW_CHAVE = ('ADY' || ADY_FILIAL || ADY_PROPOS) AND
PHW.R_E_C_N_O_ = (SELECT MAX(PHW2.R_E_C_N_O_)
                  FROM PHW000 PHW2
                  WHERE PHW2.D_E_L_E_T_ = ' '  
                  AND   PHW.PHW_CHAVE = PHW2.PHW_CHAVE )

INNER JOIN ADZ000 ADZ ON
ADZ.ADZ_PROPOS = ADY.ADY_PROPOS AND
ADZ.ADZ_REVISA = ADY.ADY_PREVIS AND
ADZ.ADZ_FILIAL = ADY.ADY_FILIAL

INNER JOIN CNB000 CNB ON
CNB.CNB_FILIAL = ADZ.ADZ_FILIAL AND
CNB.CNB_PROPOS = ADZ.ADZ_PROPOS AND
CNB.CNB_PROREV = ADZ.ADZ_REVISA AND
CNB.CNB_PROITN = ADZ.ADZ_ITEM   AND
CNB.CNB_XFLDPR = ADZ.ADZ_FOLDER

INNER JOIN CND000 CND ON
CND_FILIAL IS NOT NULL
AND CND_CONTRA = CNB.CNB_CONTRA
AND CND_REVISA = CNB.CNB_REVISA
AND CND_NUMERO = CNB.CNB_NUMERO
AND CND_COMPET =
CONCAT(CONCAT(SUBSTR ( CAST( ADY.ADY_DTUPL AS CHAR(10) ), 5, 2  ), '/'     ),  SUBSTR ( CAST( ADY.ADY_DTUPL AS CHAR(10) ), 1, 4  ) )

LEFT JOIN SC5000 SC5 ON
C5_FILIAL = CND_FILIAL
AND C5_MDNUMED = CND_NUMMED
AND C5_CLIENTE = CND_XCLIEN


WHERE  
ADY.ADY_DTUPL BETWEEN @I_DATA@ AND @F_DATA@ AND  
PHW.PHW_DTINI >= @I_DATA@ AND  
ADZ.D_E_L_E_T_ = ' ' AND
CNB.D_E_L_E_T_ = ' ' AND
ADY.D_E_L_E_T_ = ' ' AND
CND.D_E_L_E_T_ = ' ' AND
PHW.D_E_L_E_T_ = ' ' AND
SC5.D_E_L_E_T_ = ' ' AND 
(PHW.phw_dtFIM = ' ' OR 
PHW.phw_dtini  = ' ' OR 
PHW.phw_HRFIM  = ' ' OR  
PHW.phw_HRINI  = ' '  ) 

order by ADYFILIAL, ADYPROPOS, ADYPREVIS, MINEMISSAO  
 )

GROUP BY
ADYFILIAL, ADYPROPOS, ADYPREVIS, ADYDTUPL, ADYHRUPLO,  
PHWDTINI, PHWDTFIM, PHWHRINI, PHWHRFIM, PEDIDO, MINEMISSAO, PHWCUSER, PHWNUSER, HORAS, MINUTOS, SEGUNDOS,
PHWSERVID,PHWPORTA,ADYXMODAL,ADYXTPVEN, ADYCODIGO, ADYLOJA ,ADYLRAT   ,ADYTPD 

ORDER BY
ADYFILIAL, ADYPROPOS, ADYPREVIS, ADYDTUPL, ADYHRUPLO,  
PHWDTINI, PHWDTFIM, PHWHRINI, PHWHRFIM, MINEMISSAO, PHWCUSER, PHWNUSER, HORAS, MINUTOS, SEGUNDOS,
PHWSERVID,PHWPORTA,ADYXMODAL,ADYXTPVEN, ADYCODIGO, ADYLOJA,ADYLRAT    
,ADYTPD;;
PL3VIN;PL3 VINDI;05;20200512;;3;2;PL3;0;;;;2;98;;;1;2;0;;;1;;;;
PMU;INTEGRACAO DE PROPOSTAS;73;20200511;;9;2;;1;PMU_OK;;;2;99;;;1;2;0;;;1;;SELECT PMU_FILIAL, PMU_CINTEG, PMU_IDSEQ, PMU_PRPEXT, PMU_SITUAC, PMU_DTPRPE, PMU_HRPRPE, PMU_STPRPE, PMU_CLIENT, PMU_CNPCLI, PMU_VENDED, PMU_TABPRC, ' ' AS PMU_OK
  FROM PMU000 PMU
 WHERE PMU_FILIAL = '<ADVPL>xFilial('PMU')</ADVPL>' AND PMU_SITUAC = '1' AND PMU_DTPRPE BETWEEN @I_PMU_DTPRPE@ AND @F_PMU_DTPRPE@ AND PMU.D_E_L_E_T_ = ' ';;Formulario para consulta de pedidos para integracao de empresas adquiridas
PMVSA1;DE/PARA CLIENTES ADQUIRIDOS;05;20180711;;11;2;;0;;;;2;9A;;;1;2;0;;;1;;SELECT A1_COD, A1_NOME, A1_CGC, PMV_IDESTR, SA1.R_E_C_N_O_ AS RECNO
   FROM PMV000 PMV
   JOIN SA1000 SA1 ON A1_FILIAL = '<ADVPL>xFilial("SA1")</ADVPL>' AND A1_COD = PMV_VAR1 AND A1_COD BETWEEN @I_A1_COD@ AND @F_A1_COD@
    AND A1_LOJA BETWEEN @I_A1_LOJA@ AND @F_A1_LOJA@ AND SA1.D_E_L_E_T_ = ' '
  WHERE PMV_CINTEG = @PMV_CINTEG@ AND PMV_ALIAS = 'SA1' AND PMV.D_E_L_E_T_ = ' ';;Consulta que apresenta a divisão das empresas adquiridas por Clientes
PMW;ITENS DE PROPOSTAS;73;20200515;;3;2;PMW;0;;;;2;9B;;;1;2;0;;;1;;;;
PMX;INTEGRACAO DE CONTRATOS;69;20200511;;1;2;PMX;0;;;;2;9C;;;1;2;0;;;1;;;;
PN7;INTEGRACAO LICENCAS;69;20200511;;1;2;PN7;0;;;;2;9D;;;1;2;0;;;1;;;;
POX;INTEGRAÇÃO PROTHEUS/MIDDLEWARE;05;20210616;;1;2;POX;0;;;;2;XX;;;1;2;0;;;1;;;;Consulta Retornos realizados com o conceito de NotiFy
PQ1;CONSULTAS;05;20200812;;1;2;PQ1;0;;;;2;9E;;;1;2;0;;;1;;;;Lista de Consultas Personalizadas
PQ9;ACESSOS - CONSULTA PERSONALIZADA;05;20190701;;7;2;PQ9;0;;;;2;9F;;;1;2;0;;;1;;;;
PRJREC;PROJETOS X CONTAS A RECEBER;06;20180703;;4;2;;0;;;;2;9G;;;1;2;0;;;1;;SELECT 
PE5_EMPPRJ,
PE5_FILPRJ,
PE5_CLIENT,
PE5_LOJA,
SA1.A1_NOME,
PE5_PROJET,
PE5_DESPRO,
PE5_UNSRV,
PEA_NUMFAT,
PEA_SERFAT,
SE1.E1_NFELETR,
SE1.E1_PREFIXO,
SE1.E1_NUM,
SE1.E1_PARCELA,
SE1.E1_VENCTO,
SE1.E1_BAIXA,
SE1.E1_VALOR,
SE1.E1_SALDO
FROM PE5000 PE5

LEFT JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND A1_COD = PE5_CLIENT
AND A1_LOJA = PE5_LOJA
AND SA1.D_E_L_E_T_ = ' '

JOIN PE1000 PE1 ON PE1.PE1_FILIAL = ' '
AND PE1.PE1_CODIGO = PE5_UNSRV
AND PE1.PE1_PROPRI = '1'
AND PE1.D_E_L_E_T_ = ' '

JOIN 
(SELECT DISTINCT PEA_PROJET,
PEA.PEA_FILFAT,
PEA_NUMFAT,
PEA_SERFAT
FROM PEA000 PEA
WHERE PEA.PEA_FILIAL = ' '
AND PEA_NUMFAT <> ' '
AND PEA.D_E_L_E_T_ = ' ') PEAC ON PEAC.PEA_PROJET = PE5.PE5_PROJET

JOIN SE1000 SE1 ON SE1.E1_FILIAL = SUBSTR(PEAC.PEA_FILFAT, 3)
AND SE1.E1_PREFIXO = PEAC.PEA_SERFAT
AND SE1.E1_NUM = PEAC.PEA_NUMFAT
AND SE1.E1_TIPO = 'NF'
AND SE1.D_E_L_E_T_ = ' '

WHERE PE5.PE5_FILIAL = ' '
AND PE5.PE5_STATUS <> '2'
AND PE5.D_E_L_E_T_ = ' ';;
PROCLI;PROPENSÃO X CLIENTE;06;20180608;;2;2;;0;;;;2;9H;;;1;2;0;;;1;;SELECT
  A1_CGC,
  A1_COD,
  A1_NOME,
  A1_PESSOA,
  A1_MSBLQL,
  A1_PAIS,
  AI0_XPROPE,
  AI0_XDTPRR
FROM SA1000 SA1
JOIN AI0000 AI0
  ON AI0_CODCLI = A1_COD
  AND AI0_LOJA = A1_LOJA
  AND AI0.D_E_L_E_T_ = ' '
WHERE SA1.D_E_L_E_T_ = ' ';;
PRODRM;PRODUTO/RECEITA/AGRUPAMENTO;05;20200610;;28;2;;0;;;;2;9I;;;1;2;0;;;1;;SELECT B1_COD, B1_DESC, BM_GRUPO, BM_DESC, PCJ_PICPAD, PCJ_PICMET, PCI_DESCRI FROM SB1000 SB1
INNER JOIN SBM000 SBM ON B1_GRUPO = BM_GRUPO
INNER JOIN PCJ000 PCJ ON BM_XLINREC = PCJ_PICPAD
INNER JOIN PCI000 PCI  ON PCJ_PICMET = PCI_CODIGO
AND SB1.D_E_L_E_T_ = ' ' 
AND SBM.D_E_L_E_T_ = ' ' 
AND PCJ.D_E_L_E_T_ = ' ' 
AND PCI.D_E_L_E_T_ = ' ' 
;;
PRVSAO;CONSULTA PROVISAO;02;20181205;;113;2;;0;;;;2;9J;;;1;2;0;;;1;;SELECT
C7_PRODUTO AS PRODUTO,
C7_DESCRI AS DESCPROD,
C7_QUANT AS QTD,
C7_UM AS UNIDADE,
C7_PRECO AS PRECO,
C7_TOTAL AS VLRTOT,
C7_TOTAL * C7_TXMOEDA AS VLR_CONV,
C7_CC AS CENTROCUST,
C7_CONTA AS CTCONTABIL,
C7_ITEMCTA AS ITCONTABIL,
C7_CLVL AS CLVALOR,
C7_NUMSC AS NUMSC,
C7_ITEMSC ITEMSC,
C7_EMISSAO AS DT_EMISSA,
SUBSTR(C7_EMISSAO, 1, 4) AS ANO,
CASE 
    WHEN SUBSTR(C7_EMISSAO, 5, 2) = '01' THEN 'Jan'
	    ELSE CASE 
            WHEN SUBSTR(C7_EMISSAO, 5, 2) = '02' THEN 'Fev'
			WHEN SUBSTR(C7_EMISSAO, 5, 2) = '03' THEN 'Mar'
			WHEN SUBSTR(C7_EMISSAO, 5, 2) = '04' THEN 'Abr'
			WHEN SUBSTR(C7_EMISSAO, 5, 2) = '05' THEN 'Mai'
			WHEN SUBSTR(C7_EMISSAO, 5, 2) = '06' THEN 'Jun'
			WHEN SUBSTR(C7_EMISSAO, 5, 2) = '07' THEN 'Jul'
			WHEN SUBSTR(C7_EMISSAO, 5, 2) = '08' THEN 'Ago'
			WHEN SUBSTR(C7_EMISSAO, 5, 2) = '09' THEN 'Set'
			WHEN SUBSTR(C7_EMISSAO, 5, 2) = '10' THEN 'Out'
			WHEN SUBSTR(C7_EMISSAO, 5, 2) = '11' THEN 'Nov'
			WHEN SUBSTR(C7_EMISSAO, 5, 2) = '12' THEN 'Dez'
         END
END MES,
C7_NUM AS NUMPC,
C7_FORNECE AS FORNECEDO,
A2_NOME AS DESCFORNEC,
C7_QUJE AS QTDENTREG,
C7_ENCER AS PEDENCER,
C7_RESIDUO AS RESIDUO,
C7_TXMOEDA AS TXMOEDA,
C7_MOEDA AS MOEDA,
CASE
  WHEN C7_TPPED = '1' THEN 'Auto'
	ELSE CASE
		WHEN C7_TPPED = '2' THEN 'Cot'
			ELSE CASE
				WHEN C7_TPPED = '3' THEN 'Reg'
					ELSE CASE
						WHEN C7_TPPED = '4' THEN 'Recor'
							ELSE CASE
								WHEN C7_TPPED = '5' THEN 'Contr'
									ELSE CASE
										WHEN C7_TPPED = '6' THEN 'Comis'	
											ELSE CASE
												WHEN C7_TPPED = '7' THEN 'Rev'
													ELSE CASE
														WHEN C7_TPPED = '8' THEN 'SI'
															ELSE CASE
																WHEN C7_TPPED = '9' THEN 'HE'
																	ELSE CASE
																		WHEN C7_TPPED = 'A' THEN 'CPR CTR/COT'
																			ELSE CASE
																				WHEN C7_TPPED = 'B' THEN 'Cpr Confi'
																					ELSE CASE
																						WHEN C7_TPPED = 'C' THEN 'Cpr Frota'
																							ELSE CASE
																								WHEN C7_TPPED = 'D' THEN 'Cpr Direta'
																									ELSE CASE
																										WHEN C7_TPPED = 'E' THEN 'Cpr TI/Cot'
																									END
																							END
																					END
																			END
																	END
															END
													END
											END		
									END		
							END
                    END
            END
    END
END TPPED
FROM SC7000X SC7 INNER JOIN
SA2000 SA2
ON SA2.D_E_L_E_T_ = ' '
AND SC7.D_E_L_E_T_ = ' '
AND C7_FORNECE = A2_COD
AND C7_CLVL = 'C0700'
AND C7_ENCER <> 'E'
AND C7_RESIDUO = ' ' OR C7_RESIDUO = 'N'
AND C7_EMISSAO BETWEEN @DATADE@ AND @DATAATE@;;
QRYTDI;EXTRAÇÃO DA TI;73;20200609;;0;2;;0;;;;2;9K;;;1;2;0;;;1;;SELECT DISTINCT
A1_COD
,A1_NOME
,A1_NREDUZ
,A1_CGC
,A1_END
,A1_BAIRRO
,A1_MUN
,A1_EST
,A1_DDD
,A1_TEL
,A1_VEND
,A3_NOME
,A1_CODMEMB
,ADK_NOME

FROM SA1000 SA1

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' 
AND SA3.D_E_L_E_T_ = ' ' 
AND A3_COD = A1_VEND

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' ' 
AND ADK_COD = A1_CODMEMB

WHERE A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' ';;
RDAVAL;VALORES DE RDA PARA VIAGENS;06;20180619;;12;2;;0;;;;2;9L;;;1;2;0;;;1;;SELECT PFO_CODFEC,
PFO_DATFEC,
PFM.PFM_DATA,
PFM_CODDES,
PFG_DESCR,
PFM_QUANT,
PFM_VLDESP,
PFM_VLUNIT,
PFM_VLREEM,
PFO_CODTEC,
RD0_NOME,
PF9_CLIENT,
A1_NOME,
PFM_GRPSE2,
PFM_EMPSE2,
ED_XCCONTA 
FROM PFM000 PFM

INNER JOIN PFO000 PFO
	ON PFO.D_E_L_E_T_ = ' '
	AND PFO_FILIAL = ' '
	AND PFO_CODFEC = PFM_CODFEC
	AND PFO_DATFEC BETWEEN @DATADE@ AND @DATAATE@
INNER JOIN PF9000 PF9
	ON PF9.D_E_L_E_T_ = ' '
	AND PF9_FILIAL = ' '
	AND PF9_IDOS = PFM_IDOS 
INNER JOIN PFG000 PFG
	ON PFG_FILIAL = ' ' 	
	AND PFG.D_E_L_E_T_ = ' '  
	AND PFG_CODIGO = PFM_CODDES
		LEFT JOIN SED000 SED
		ON SED.D_E_L_E_T_ = ' '
		AND ED_FILIAL = ' '
		AND ED_CODIGO = PFG_NATURE
INNER JOIN RD0000 RD0	
    ON RD0.D_E_L_E_T_ = ' '	
    AND RD0_FILIAL = ' '	
    AND RD0_CODIGO = PFM_TECNIC
INNER JOIN SA1000 SA1
	ON A1_FILIAL = ' '
	AND SA1.D_E_L_E_T_ = ' '
	AND A1_COD = PF9_CLIENT 	
	AND A1_LOJA = PF9_LOJA
	
WHERE
	PFM_FILIAL = ' '
                           AND PFM_GRPSE2 IN (@EMP@) 
                           AND PFM.D_E_L_E_T_ = ' '
	AND PFM_CHVSE2 <> ' ';;
RECWS;LEITURA CNPJS - RECEITAWS;96;20190121;;5;2;;0;;;;2;9M;;;1;2;0;;;1;1;SELECT PN1_FILIAL, PN1_CINTEG, PN1_DTMNT, PN1_HRMNT, SUBSTR(PN1_CHVFUL, 4, 254) AS PN1_CHVFUL
  FROM <ADVPL>RetSqlName("PN1")</ADVPL> PN1
 WHERE PN1_FILIAL = '<ADVPL>xFilial("PN1")</ADVPL>' AND PN1_CINTEG = '000000' AND PN1_ALIAS = 'PN1' AND SUBSTR(PN1_CHVFUL, 1, 3) BETWEEN 'RWS' AND 'RWS'
<ADVPL>If(oCQuery:lJob," AND EXISTS(SELECT 1 FROM " + RetSqlName('PN1') + " PN1M WHERE PN1M.PN1_FILIAL = PN1.PN1_FILIAL AND PN1M.PN1_CINTEG = PN1.PN1_CINTEG AND PN1_ALIAS = 'PN1' AND SUBSTR(PN1_CHVFUL, 1, 3) BETWEEN 'RWC' AND 'RWC' AND PN1_STATUS <> '4' AND D_E_L_E_T_ = ' ')", "")</ADVPL>
   AND D_E_L_E_T_ = ' ';;Leitura de arquivo texto com lista de CNPJS a serem processados pare realizar requisicao no endereco https://www.receitaws.com.br/
RECWSC;CNPJS A PROCESSAR;96;20190121;;88;2;;0;;;;2;9N;;;1;2;0;;;1;;SELECT PN1_FILIAL, PN1_CINTEG, PN1_DTMNT, PN1_HRMNT, PN1_DTINTE, PN1_HRINTE, SUBSTR(PN1_CHVFUL, 6, 14) AS PN1_CHVFUL, PN1_STATUS, CAST(SUBSTR(PN1_CHVFUL, 4, 2) AS CHAR(2)) AS PN1_EXEC, PN1.R_E_C_N_O_ AS PN1_RECNO
  FROM <ADVPL>RetSqlName("PN1")</ADVPL> PN1
 WHERE PN1_FILIAL = '<ADVPL>xFilial("PN1")</ADVPL>' AND PN1_CINTEG = '000000' AND PN1_ALIAS = 'PN1 ' AND SUBSTR(PN1_CHVFUL, 1, 3) BETWEEN 'RWC' AND 'RWC'
<ADVPL>If(oCQuery:lJob," AND SUBSTR(PN1_CHVFUL, 4, 2) < '06' AND PN1_STATUS <> '4'", "")</ADVPL>
   AND PN1.D_E_L_E_T_ = ' ';;
RELBUF;RELATORIO BUFFER;69;20180925;;61;2;;0;;;;2;9O;;;1;2;0;;;1;;SELECT
TAB.CNB_CONTRA , TAB.CNB_REVISA, TAB.CNB_NUMERO , TAB.CNB_ITEM , TAB.CNB_PROPOS , TAB.CNB_QUANT , TAB.CNB_VLTOT , TAB.CNB_DATASS,
TAB.CNB_VIGIC, TAB.CNB_VIGFC,
TAB.CNB_STATRM , TAB.CNB_SITUAC , TAB.CNB_VIGINI,
TAB.RECNOPH4,
TAB.CNB_UNINEG,
TAB.CNB_PRODUT,
TAB.BM_XCONTAC,
TAB.BM_XLINREC,
TAB.AOM_DESCRI,
TAB.CNB_CONDIC,
PH4_CMPINI , PH4_CMPFIM , PH4_MOTBC , SX5I.X5_DESCRI AS DESCRCAREN
, PH3_CMPSOL , PH3_CMPCAN , PH3_DATA  , PH3_QUANT , PH3_QTDCAN , PH3_MOTBC , SX5C.X5_DESCRI AS DESCRCANC,
CASE WHEN COALESCE(PH4_CMPINI,' ') = ' ' THEN 'NAO' WHEN SUBSTR(PH4_CMPINI,4,4) || SUBSTR(PH4_CMPINI,1,2) = SUBSTR(CNB_VIGINI,1,6) THEN 'SIM' ELSE 'NAO' END AS CARVEN,
CASE WHEN CNB_CONDIC = '00' THEN 'MENSAL'
WHEN CNB_CONDIC = '01' THEN 'BIMESTRAL'
WHEN CNB_CONDIC = '02' THEN 'TRIMESTRAL'
WHEN CNB_CONDIC = '03' THEN 'QUADRIMESTRAL'
WHEN CNB_CONDIC = '05' THEN 'SEMESTRAL'
WHEN CNB_CONDIC = '11' THEN 'ANUAL'
ELSE
'NÃO CLASSIFICADO' END AS DESCPERIOD,
TAB.ADZ_QTDVEN,
TAB.ADZ_TOTAL,
TAB.ADY_DTAPRO,
TAB.ADY_DTUPL

FROM
(
 
SELECT CNB_CONTRA , CNB_REVISA, CNB_NUMERO , CNB_ITEM , CNB_PROPOS , CNB_QUANT , CNB_VLTOT , CNB_DATASS , SUBSTR(CNB_VIGINI,5,2) || '/' || SUBSTR(CNB_VIGINI,1,4) AS CNB_VIGIC, SUBSTR(CNB_VIGFIM,5,2) || '/' || SUBSTR(CNB_VIGFIM,1,4) AS CNB_VIGFC, CNB_STATRM , CNB_SITUAC , CNB_VIGINI
, ( SELECT MIN(R_E_C_N_O_) RECNOPH4
FROM PH4000 PH4
WHERE PH4_FILIAL = ' '
AND PH4_CONTRA = CNB_CONTRA
AND PH4_REVISA = CNB_REVISA
AND PH4_NUMERO = CNB_NUMERO
AND PH4_ITEM = CNB_ITEM
AND PH4_TIPO = 'C'
AND PH4_STATUS IN('A','E')
AND PH4.D_E_L_E_T_ = ' ')RECNOPH4
, CNB_UNINEG
, CNB_PRODUT
, BM_XCONTAC
, BM_XLINREC
, AOM_DESCRI
, CNB_CONDIC
                , ADZ_QTDVEN
                , ADZ_TOTAL
                , ADY_DTAPRO
                , ADY_DTUPL

FROM CNB000 CNB

INNER JOIN CN9000 CN9
ON CN9_FILIAL  = ' '
AND CN9_NUMERO = CNB_CONTRA
AND CN9_REVISA = CNB_REVISA
AND CN9_SITUAC = '05'
AND CN9_ESPCTR = '2'
AND CN9.D_E_L_E_T_ = ' '

LEFT JOIN ADZ000 ADZ ON
CNB.CNB_FILIAL = ADZ.ADZ_FILIAL  AND
CNB.CNB_PROPOS = ADZ.ADZ_PROPOS  AND
CNB.CNB_PROREV = ADZ.ADZ_REVISA  AND
CNB.CNB_PROITN = ADZ.ADZ_ITEM    AND
CNB.CNB_XFLDPR = ADZ.ADZ_FOLDER AND
        ADZ.D_E_L_E_T_ = ' '

LEFT JOIN ADY000 ADY ON
ADZ.ADZ_PROPOS = ADY.ADY_PROPOS AND
ADZ.ADZ_REVISA = ADY.ADY_PREVIS AND
ADZ.ADZ_FILIAL = ADY.ADY_FILIAL  AND
        ADY.D_E_L_E_T_ = ' '

INNER JOIN SB1000 SB1
ON B1_FILIAL = ' '
AND B1_COD = CNB_PRODUT
AND SB1.D_E_L_E_T_ = ' '

INNER JOIN SBM000 SBM
ON BM_FILIAL = ' '
AND BM_GRUPO = B1_GRUPO
AND SBM.D_E_L_E_T_ = ' '

INNER JOIN AOM000 AOM
ON AOM_FILIAL = ' '
AND AOM_CODAGR = '000001'
AND AOM_CODNIV = BM_XLINREC
AND AOM.D_E_L_E_T_ = ' '

WHERE CNB_FILIAL = ' '
AND CNB_CONTRA >= ' '
AND CNB_SITUAC IN ('A','P','C')
AND CNB_TIPREC = '1'
AND CNB_VIGINI  BETWEEN @I_VIG@ AND @F_VIG@
AND CNB.D_E_L_E_T_ = ' '

) TAB

LEFT JOIN PH4000 A
ON A.PH4_FILIAL = ' '
AND A.PH4_CONTRA = TAB.CNB_CONTRA
AND A.PH4_REVISA = TAB.CNB_REVISA
AND A.PH4_NUMERO = TAB.CNB_NUMERO
AND A.PH4_ITEM   = TAB.CNB_ITEM
AND A.PH4_TIPO = 'C'
AND A.PH4_STATUS IN('A','E')
AND A.R_E_C_N_O_ = TAB.RECNOPH4
AND A.D_E_L_E_T_ = ' '

LEFT JOIN PH3000 PH3
ON PH3_FILIAL = ' '
AND PH3_CONTRA = TAB.CNB_CONTRA
AND PH3_REVISA = TAB.CNB_REVISA
AND PH3_NUMERO = TAB.CNB_NUMERO
AND PH3_ITEM = TAB.CNB_ITEM
AND PH3_STATUS  = 'C'
AND PH3.D_E_L_E_T_ = ' '

LEFT JOIN SX5000 SX5C
ON SX5C.X5_FILIAL = '  '
AND SX5C.X5_TABELA = '_C'
AND SX5C.X5_CHAVE = PH3_MOTBC
AND SX5C.D_E_L_E_T_ = ' '

LEFT JOIN SX5000 SX5I
ON SX5I.X5_FILIAL = '  '
AND SX5I.X5_TABELA = '_I'
AND SX5I.X5_CHAVE = PH4_MOTBC
AND SX5I.D_E_L_E_T_ = ' ';;
RELCLI;RELATÓRIO DE CLIENTES - CADASTRO;06;20180705;;27;2;;0;;;;2;9P;;;1;2;0;;;1;;SELECT 
A1_COD
,A1_LOJA   
,A1_NOME   
,A1_MSBLQL 
,A1_CGC    
,A1_INSCR  
,A1_XCLIVIP
,A1_X_XHDLR
,A1_XHDSEMP
,A1_TIPO   
,A1_PAIS   
,A1_XUPMSHP
,A1_CODPAIS
,A1_CNAE   
,A1_CODSEG 
,A1_XESTRAT
,A1_XDTESTR
,A1_NREDUZ 
,A1_CEP    
,A1_END    
,A1_XNEND  
,A1_COMPLEM
,A1_BAIRRO 
,A1_MUN    
,A1_EST    
,A1_ESTADO 
,A1_COD_MUN
,A1_CODSIAF
,A1_IBGE   
,A1_DDD    
,A1_NATUREZ
,A1_DDI    
,A1_TEL    
,A1_ENDCOB 
,A1_CONTATO
,A1_EMAIL  
,A1_HPAGE  
,A1_VEND   
,A1_BCO1   
,A1_BCO2   
,A1_BCO3   
,A1_BCO4   
,A1_BCO5   
,A1_COND   
,A1_RECISS 
,A1_INCISS 
,A1_MUNC   
,A1_CLICNV 
,A1_CODMUN 
,A1_B2B    
,A1_GRPVEN 
,A1_SIMPLES
,A1_CDRDES 
,A1_SIMPNAC
,A1_ORIGEM 
,A1_HRCAD  
,A1_SUPER  
,A1_RECIRRF
,A1_CEPC   
,A1_BAIRROC
,A1_ESTC   
,A1_SATIV1 
,A1_TPESSOA
,A1_TIPCLI 
,A1_CONDPAG
,A1_RECINSS
,A1_RECCOFI
,A1_RECCSLL
,A1_RECPIS 
,A1_UNIDVEN
,A1_CONTRIB
,A1_CODTER 
,ADK_NOME
,A1_CODMEMB
,A1_XSITCLI
,A1_DTCAD  
,A1_XCODRM 
,A1_XEMAILF

FROM SA1000 SA1

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' ' 
AND ADK_COD = A1_CODTER

WHERE A1_XSITCLI = @SITCLI@
AND A1_DTCAD BETWEEN @DATADE@ AND @DATAATE@
AND SA1.D_E_L_E_T_ = ' ';;
RELCON;RELATÓRIO DE CONTATOS;73;20180710;;6;2;;0;;;;2;9Q;;;1;2;0;;;1;;SELECT DISTINCT
'CLIENTE' AS ENTIDADE
,A1_COD AS CODIGO
,A1_NOME
,A1_CGC CNPJ
,A1_CODSEG
,AOV_DESSEG
,A1_VEND
,A3_NOME
,A1_CODMEMB
,ADK_NOME
,U5_CONTAT COD_CONT
,U5_EMAIL EMAIL_CONT
,U5_DDD
,U5_FCOM1
,U5_CELULAR
,U5_CPF
,UM_DESC CARGO
,U5_MSBLQL

FROM SA1000 SA1

LEFT JOIN AC8000 AC8 ON AC8_FILIAL = ' '
AND AC8.D_E_L_E_T_ = ' '
AND AC8_ENTIDA = 'SA1'
AND A1_COD = SUBSTR(AC8_CODENT,1,6)

LEFT JOIN SU5000 SU5 ON U5_FILIAL = ' '
AND SU5.D_E_L_E_T_ = ' '
AND AC8_CODCON = U5_CODCONT

LEFT JOIN SUM000 SUM ON UM_FILIAL = ' '
AND SUM.D_E_L_E_T_ = ' '
AND UM_CARGO = U5_FUNCAO

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' 
AND SA3.D_E_L_E_T_ = ' ' 
AND A3_COD = A1_VEND

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' ' 
AND ADK_COD = A1_CODMEMB

LEFT JOIN AOV000 AOV ON AOV_FILIAL = ' ' 
AND AOV.D_E_L_E_T_ = ' ' 
AND AOV_CODSEG = A1_CODSEG

WHERE A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_VEND BETWEEN @I_CODVEN@ AND @F_CODVEN@
AND A1_CODMEMB BETWEEN @I_UNID@ AND @F_UNID@
<ADVPL>If(_ATIVO = "1", "AND U5_MSBLQL <> '2'", If(_ATIVO = "2", "AND U5_MSBLQL = '2'", ""))</ADVPL>

UNION ALL

SELECT DISTINCT
'PROSPECT' AS ENTIDADE
,US_COD AS CODIGO
,US_NOME
,US_CGC CNPJ
,US_CODSEG
,AOV_DESSEG
,US_VEND
,A3_NOME
,US_CODMEMB
,ADK_NOME
,U5_CONTAT COD_CONT
,U5_EMAIL EMAIL_CONT
,U5_DDD
,U5_FCOM1
,U5_CELULAR
,U5_CPF
,UM_DESC CARGO
,U5_MSBLQL

FROM SUS000 SUS

LEFT JOIN AC8000 AC8 ON AC8_FILIAL = ' '
AND AC8.D_E_L_E_T_ = ' '
AND AC8_ENTIDA = 'SUS'
AND US_COD = SUBSTR(AC8_CODENT,1,6)

LEFT JOIN SU5000 SU5 ON U5_FILIAL = ' '
AND SU5.D_E_L_E_T_ = ' '
AND AC8_CODCON = U5_CODCONT

LEFT JOIN SUM000 SUM ON UM_FILIAL = ' '
AND SUM.D_E_L_E_T_ = ' '
AND UM_CARGO = U5_FUNCAO

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' 
AND SA3.D_E_L_E_T_ = ' ' 
AND A3_COD = US_VEND

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' ' 
AND ADK_COD = US_CODMEMB

LEFT JOIN AOV000 AOV ON AOV_FILIAL = ' ' 
AND AOV.D_E_L_E_T_ = ' ' 
AND AOV_CODSEG = US_CODSEG

WHERE US_FILIAL = ' '
AND SUS.D_E_L_E_T_ = ' '
AND US_STATUS <> '6'
AND US_VEND BETWEEN @I_CODVEN@ AND @F_CODVEN@
AND US_CODMEMB BETWEEN @I_UNID@ AND @F_UNID@
<ADVPL>If(_ATIVO = "1", "AND U5_MSBLQL <> '2'", If(_ATIVO = "2", "AND U5_MSBLQL = '2'", ""))</ADVPL>

UNION ALL

SELECT DISTINCT
'SUSPECT' AS ENTIDADE
,ACH_CODIGO AS CODIGO
,ACH_RAZAO
,ACH_CGC CNPJ
,ACH_CODSEG
,AOV_DESSEG
,ACH_VEND
,A3_NOME
,ACH_CODMEM
,ADK_NOME
,U5_CONTAT COD_CONT
,U5_EMAIL EMAIL_CONT
,U5_DDD
,U5_FCOM1
,U5_CELULAR
,U5_CPF
,UM_DESC CARGO
,U5_MSBLQL

FROM ACH000 ACH

LEFT JOIN AC8000 AC8 ON AC8_FILIAL = ' '
AND AC8.D_E_L_E_T_ = ' '
AND AC8_ENTIDA = 'ACH'
AND ACH_CODIGO = SUBSTR(AC8_CODENT,1,6)

LEFT JOIN SU5000 SU5 ON U5_FILIAL = ' '
AND SU5.D_E_L_E_T_ = ' '
AND AC8_CODCON = U5_CODCONT

LEFT JOIN SUM000 SUM ON UM_FILIAL = ' '
AND SUM.D_E_L_E_T_ = ' '
AND UM_CARGO = U5_FUNCAO

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' 
AND SA3.D_E_L_E_T_ = ' ' 
AND A3_COD = ACH_VEND

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' ' 
AND ADK_COD = ACH_CODMEM

LEFT JOIN AOV000 AOV ON AOV_FILIAL = ' ' 
AND AOV.D_E_L_E_T_ = ' ' 
AND AOV_CODSEG = ACH_CODSEG

WHERE ACH_FILIAL = ' '
AND ACH.D_E_L_E_T_ = ' '
AND ACH_STATUS <> '6'
AND ACH_VEND BETWEEN @I_CODVEN@ AND @F_CODVEN@
AND ACH_CODMEM BETWEEN @I_UNID@ AND @F_UNID@
<ADVPL>If(_ATIVO = "1", "AND U5_MSBLQL <> '2'", If(_ATIVO = "2", "AND U5_MSBLQL = '2'", ""))</ADVPL>;;Relatório de todos os contatos das contas
RELPH3;CONSULTAR REATIVAÇÕES;69;20201208;;12;2;;0;;;;2;;;;1;2;0;;;2;;SELECT 
PH3.PH3_FILIAL,
PH3.PH3_CONTRA,
PH3.PH3_REVISA,
PH3.PH3_NUMERO,
PH3.PH3_ITEM,
PH3.PH3_ITSEQ,
PH3.PH3_STATUS,
PH3.PH3_PRODUT,
PH3.PH3_PROPOS,
PH3.PH3_VERPRO,
PH3.PH3_ITMPRO,
PH3.PH3_FLDPRP,
PH3.PH3_QUANT,
PH3.PH3_SITUAC,
PH3.PH3_STATRM,
PH3.PH3_CMPSOL,
PH3.PH3_CMPCAN,
PH3.PH3_MOTBC,
PH3.PH3_DATA,
PH3.PH3_MSFIL,
PH3.PH3_GRUPO,
PH3.PH3_UNINEG,
PH3.PH3_CHAMAD
FROM <ADVPL>RetSqlName('PH3')</ADVPL>  PH3 
INNER JOIN <ADVPL>RetSqlName('CN9')</ADVPL>  CN9  ON 
CN9.CN9_NUMERO = PH3.PH3_CONTRA AND
CN9.CN9_REVISA = PH3.PH3_REVISA AND
CN9.CN9_SITUAC = '05'
 
WHERE 
PH3.PH3_STATUS = 'R' AND 
PH3.D_E_L_E_T_ = ' ' AND
CN9.D_E_L_E_T_ = ' '   AND PH3_CMPREA BETWEEN  @PH3CMPET1@   AND @PH3CMPET2@ 
ORDER BY PH3.PH3_CONTRA, PH3.PH3_REVISA, PH3.PH3_NUMERO, PH3.PH3_ITEM, PH3.PH3_ITSEQ;;
RELRDA;RELATORIO DE RDA POR DATA DE FECHAMENTO;97;20180718;;1;2;;0;;;;2;9R;;;1;2;0;;;1;;SELECT PFO_CODFEC, PFO_DATFEC, PF9_IDOS,PFM_DATA, PFM_CODDES, PFG_DESCR, PFM_QUANT, PFM_VLDESP, PFM_VLUNIT, PFM_VLREEM,PFO_CODTEC, RD0_NOME, PF9_CLIENT, A1_NOME,PFM_GRPSE2,PFM_EMPSE2,ED_XCCONTA FROM PFM000 PFM		
INNER JOIN PFO000 PFO		
	ON PFO.D_E_L_E_T_ = ' '	
	AND PFO_FILIAL = ' '	
	AND PFO_CODFEC = PFM_CODFEC	
	AND PFO_DATFEC BETWEEN @DTINI@ AND @DTFIM@
INNER JOIN PF9000 PF9		
	ON PF9.D_E_L_E_T_ = ' '	
	AND PF9_FILIAL = ' '	
	AND PF9_IDOS = PFM_IDOS 	
INNER JOIN PFG000 PFG		
	ON PFG_FILIAL = ' ' 	
	AND PFG.D_E_L_E_T_ = ' '  	
	AND PFG_CODIGO = PFM_CODDES	
		LEFT JOIN SED000 SED
		ON SED.D_E_L_E_T_ = ' '
		AND ED_FILIAL = ' '
		AND ED_CODIGO = PFG_NATURE
INNER JOIN RD0000 RD0		
    ON RD0.D_E_L_E_T_ = ' '		
    AND RD0_FILIAL = ' '		
    AND RD0_CODIGO = PFM_TECNIC		
INNER JOIN SA1000 SA1		
	ON A1_FILIAL = ' '	
	AND SA1.D_E_L_E_T_ = ' '	
	AND A1_COD = PF9_CLIENT 	
	AND A1_LOJA = PF9_LOJA	
WHERE		
	PFM_FILIAL = ' '	
	AND PFM.D_E_L_E_T_ = ' '	
	AND PFM_CHVSE2 <> ' '	
;;
RELSC;RELATORIO DE SOLICITAÇÃO DE COMPRA APROVADAS;02;20180813;;1101;2;;0;;;;2;9S;;;1;2;0;;;1;;SELECT DISTINCT
C1_FILIAL, 
M0_FILIAL,
CASE WHEN SUBSTR(C1_EMISSAO,5,2) = '01' THEN 'Janeiro' 
	 WHEN SUBSTR(C1_EMISSAO,5,2) = '02' THEN 'Fevereiro' 
	 WHEN SUBSTR(C1_EMISSAO,5,2) = '03' THEN 'Março' 
	 WHEN SUBSTR(C1_EMISSAO,5,2) = '04' THEN 'Abril' 
	 WHEN SUBSTR(C1_EMISSAO,5,2) = '05' THEN 'Maio' 
	 WHEN SUBSTR(C1_EMISSAO,5,2) = '06' THEN 'Junho' 
	 WHEN SUBSTR(C1_EMISSAO,5,2) = '07' THEN 'Julho' 
	 WHEN SUBSTR(C1_EMISSAO,5,2) = '08' THEN 'Agosto' 
	 WHEN SUBSTR(C1_EMISSAO,5,2) = '09' THEN 'Setembro' 
	 WHEN SUBSTR(C1_EMISSAO,5,2) = '10' THEN 'Outubro' 
	 WHEN SUBSTR(C1_EMISSAO,5,2) = '11' THEN 'Novembro' 
	 WHEN SUBSTR(C1_EMISSAO,5,2) = '12' THEN 'Dezembro' 
ELSE ' ' END MES,
SCR.CR_DATALIB, 
C1_NUM,
CASE C1_XTIDT
	WHEN '1' THEN 'TI'
	WHEN '2' THEN 'NORMAL'
	WHEN '3' THEN 'CONTRATOS'
ELSE 'OUTROS' END C1_XTIDT,
C1_ITEM, 
C1_EMISSAO, 
C1_PRODUTO, 
C1_DESCRI, 
C1_UM, 
C1_QUANT, 
C1_VUNIT, 
C1_FORNECE,
A2_NOME,
C1_SOLICIT, 
C1_XJUSTIF, 
C1_CC,
SAK.AK_NOME APROVADOR,
CTT.CTT_DESC01,
C1_CONTA,
CT1.CT1_DESC01,
C1_OBS,
UTL_RAW.CAST_TO_VARCHAR2(DBMS_LOB.SUBSTR(C1_XCOMPLE,2000)) C1_XCOMPLE

  FROM <ADVPL>RetSqlName("SC1")</ADVPL> SC1  
 INNER JOIN 
    <ADVPL>RetSqlName("SCR")</ADVPL> SCR 
    ON CR_FILIAL = C1_FILIAL  
    AND CR_NUM = C1_NUM
    AND SCR.D_E_L_E_T_ = ' '
LEFT JOIN
      <ADVPL>RetSqlName("SA2")</ADVPL> SA2
      ON A2_FILIAL = ' ' 
      AND A2_COD = C1_FORNECE 
      AND SA2.D_E_L_E_T_ = ' ' 
LEFT JOIN
      <ADVPL>RetSqlName("CTT")</ADVPL> CTT
      ON CTT_FILIAL = ' ' 
      AND CTT_CUSTO = C1_CC 
      AND CTT.D_E_L_E_T_ = ' ' 
 LEFT JOIN
      <ADVPL>RetSqlName("CT1")</ADVPL> CT1
      ON CT1_FILIAL = ' ' 
      AND CT1_CONTA = C1_CONTA 
      AND CT1.D_E_L_E_T_ = ' ' 
LEFT JOIN
      SIGAMAT SIGAMAT
      ON M0_CODFIL = C1_FILIAL AND
      M0_CODIGO = '00' AND
      SIGAMAT.D_E_L_E_T_ = ' ' 
LEFT JOIN
	  SAK000 SAK ON
	  SAK.AK_COD = CR_APROV
	  AND SAK.D_E_L_E_T_ = ' '
WHERE SCR.CR_DATALIB = (SELECT MAX(SCR.CR_DATALIB) 
                         FROM SCR000 SCR 
                         WHERE SCR.CR_DATALIB BETWEEN @I_CR_DATALIB@ AND @F_CR_DATALIB@ AND SCR.CR_DATALIB <> ' '  AND SCR.CR_FILIAL = C1_FILIAL AND SCR.CR_NUM = C1_NUM) 
AND C1_APROV = 'L' AND CR_TIPO IN ('SC','IP')
AND SCR.CR_NIVEL = (SELECT MAX(SCR.CR_NIVEL) 
					FROM SCR000 SCR 
					WHERE SCR.CR_NUM = SC1.C1_NUM AND SCR.CR_FILIAL = SC1.C1_FILIAL)
AND  SCR.CR_DATALIB BETWEEN @I_CR_DATALIB@ AND @F_CR_DATALIB@
AND SC1.D_E_L_E_T_ = ' '
ORDER BY C1_FILIAL, SCR.CR_DATALIB, C1_NUM, C1_ITEM, C1_EMISSAO;;Rotina que gera relatório de solicitações de compra aprovadas, contendo apenas a última aprovação.
RELVEN;RELATÓRIO DE VENDAS GCT;69;20180612;;801;2;;0;;;;2;9T;;;1;2;0;;;1;;SELECT DISTINCT
ADY_PROPOS			
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS ADY_STATUS
,CASE
WHEN CNB_TIPREC = '1' THEN 'SIM'
WHEN CNB_TIPREC = '2' THEN 'NAO'
END AS RECORRENTE
,ADY_XMODAL						
,AOM1.AOM_DESCRI AS AGRUP						
,ADY_DTUPL
, ADZ_PRODUT
,ADZ_DESCRI		
,B1_GRUPO
,B1_XDNEGOC
,ZX5_DESCRI 
,BM_DESC
,ADZ_CONDPG						
,ADZ_PRCVEN						
,ADZ_QTDVEN						
,ADZ_TOTAL						
,ADZ_XSITUA
,ADZ_ITEM
,CASE 
WHEN CNB_CONDIC = '00' THEN 'MENSAL'
WHEN CNB_CONDIC = '01' THEN 'Bimestral'
WHEN CNB_CONDIC = '02' THEN 'Trimestral'
WHEN CNB_CONDIC = '03' THEN 'Quadrimestral'
WHEN CNB_CONDIC = '05' THEN 'Semestral'
WHEN CNB_CONDIC = '11' THEN 'Anual'
WHEN CNB_CONDIC = '12' THEN 'Bianual'
END AS CNB_CONDIC
,CASE
WHEN CNB_SITUAC = 'A' THEN 'ATIVO'
WHEN CNB_SITUAC = 'C' THEN 'CANCELADO'
WHEN CNB_SITUAC = 'G' THEN 'GRATUITO'
WHEN CNB_SITUAC = 'M' THEN 'MANUAL'
WHEN CNB_SITUAC = 'P' THEN 'PENDENTE'
WHEN CNB_SITUAC = 'S' THEN 'SUSPENSO'
WHEN CNB_SITUAC = 'O' THEN 'TROCADO'
WHEN CNB_SITUAC = 'T' THEN 'TRANSFERIDO'                               
END AS CONTR_SITUA
,BM_XLINREC
,BM_XCONTAC					
,AOM2.AOM_DESCRI AS DESC_LIN						
,ADZ_DT1VEN
,ADZ_XCOMPE						
,AD1_CODCLI					
,A1_NOME						
,A1_CODMEMB						
,ADK_NOME
,CASE 
WHEN BM_FLGREAJ = '1' THEN 'SIM'
WHEN BM_FLGREAJ = '2' THEN 'NÃO'
END AS BM_FLGREAJ
,( SELECT CN6_DESCRI FROM CN6000 CN6
WHERE CN6_CODIGO = CNB_INDICE 
AND CN6.D_E_L_E_T_ = ' ' ) AS CN6_DESCRI
,CNB_UNINEG
,M0_FILIAL


FROM ADY000 ADY

INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' ' 
AND AD1.D_E_L_E_T_ = ' ' 
AND AD1_NROPOR = ADY_OPORTU
AND AD1_REVISA = ADY_REVISA							

INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '							
AND ADZ.D_E_L_E_T_ = ' '							
AND ADZ_PROPOS = ADY_PROPOS							
AND ADZ_REVISA = ADY_PREVIS		

INNER JOIN CN9000 CN9 ON CN9_FILIAL = ' ' 
AND CN9_SITUAC = '05'
AND CN9_REVATU = '    '
AND CN9_ESPCTR = '2'
AND CN9_TPCTO = '013'
AND CN9_NUMERO = 'CON' || (CASE WHEN AD1_CODCLI = '      ' THEN AD1_CODCLI ELSE ADY_CODIGO END) 
AND CN9.D_E_L_E_T_ = ' '					

INNER JOIN CNB000 CNB ON CNB_FILIAL = ' ' 
AND CNB_CONTRA = CN9_NUMERO
AND CNB_REVISA = CN9_REVISA
AND CNB_PROPOS = ADY_PROPOS
AND CNB_PRODUT = ADZ_PRODUT
AND CNB.D_E_L_E_T_ = ' ' 

INNER JOIN SIGAMAT SM0 ON M0_CODFIL = CNB_UNINEG
AND SM0.D_E_L_E_T_ = ' ' 

LEFT JOIN SB1000 SB1 ON B1_FILIAL = ' '							
AND SB1.D_E_L_E_T_ = ' '							
AND B1_COD = ADZ_PRODUT							

INNER JOIN ZX5000 ZX5
ON ZX5.D_E_L_E_T_ = ' '
AND ZX5_FILIAL = ' '
AND ZX5_TABELA='CRM045' 
AND ZX5_CHAVE=B1_XFAMILI


LEFT JOIN SBM000 SBM ON BM_FILIAL = ' '							
AND SBM.D_E_L_E_T_ = ' '							
AND BM_GRUPO = B1_GRUPO							

LEFT JOIN SA1000 SA1 ON A1_FILIAL = ' '							
AND SA1.D_E_L_E_T_ = ' '							
AND A1_COD = AD1_CODCLI

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '							
AND ADK.D_E_L_E_T_ = ' '							
AND ADK_COD = A1_CODMEMB							

LEFT JOIN AOM000 AOM1 ON AOM1.AOM_FILIAL = ' '							
AND AOM1.D_E_L_E_T_ = ' '							
AND AOM1.AOM_CODAGR = '000112'							
AND AOM1.AOM_CODNIV = ADY_XMODAL							

LEFT JOIN AOM000 AOM2 ON AOM2.AOM_FILIAL = ' '							
AND AOM2.D_E_L_E_T_ = ' '							
AND AOM2.AOM_CODAGR = '000001'							
AND AOM2.AOM_IDINT = BM_XLINREC							

WHERE ADY_FILIAL = ' '							
AND ADY.D_E_L_E_T_ = ' '							
AND ADY_ENTIDA = '1'							
AND ADY_STATUS IN ('I','J','K')					
AND ADY_DTUPL BETWEEN @I_ADY_DTUPL@ AND @F_ADY_DTUPL@

ORDER BY ADY_PROPOS;;
REPOOL;CONTAS VENDEDOR POOL;73;20180709;;20;2;;0;;;;2;9U;;;1;2;0;;;1;;SELECT DISTINCT
'CLIENTE' AS ENTIDADE
,A1_COD AS CODIGO
,A1_NOME AS NOME
,A1_CGC AS CNPJ
,A1_CNAE AS CNAE
,CC3_DESC
,A1_CODSEG AS CODSEG
,AOV1.AOV_DESSEG AS DESSEG
,A1_XCODSUB AS CODSUB
,AOV2.AOV_DESSEG AS DESSUB
,A1_VEND AS ESN
,A3_NOME AS NOMEESN
,A1_CODMEMB AS UNIDADE
,ADK1.ADK_NOME AS NOMEUNID
,A1_CODTER AS CODTER
,ADK2.ADK_NOME AS NOMETER
,U5_CONTAT COD_CONT
,U5_EMAIL EMAIL_CONT
,U5_DDD
,U5_FCOM1
,U5_CELULAR
,UM_DESC CARGO

FROM SA1000 SA1

LEFT JOIN CC3000 CC3 ON CC3_FILIAL = ' '
AND CC3.D_E_L_E_T_ = ' '
AND CC3_COD = A1_CNAE

LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' '
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = A1_CODSEG
AND AOV1.AOV_PAI = ' '

LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' '
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = A1_XCODSUB
AND AOV2.AOV_PAI = A1_CODSEG

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = A1_VEND

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK1 ON ADK1.ADK_FILIAL = ' '
AND ADK1.D_E_L_E_T_ = ' '
AND ADK1.ADK_COD = A1_CODMEMB

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK2 ON ADK2.ADK_FILIAL = ' '
AND ADK2.D_E_L_E_T_ = ' '
AND ADK2.ADK_COD = A1_CODTER

LEFT JOIN AC8000 AC8 ON AC8_FILIAL = ' '
AND AC8.D_E_L_E_T_ = ' '
AND AC8_ENTIDA = 'SA1'
AND A1_COD = SUBSTR(AC8_CODENT,1,6)

LEFT JOIN SU5000 SU5 ON U5_FILIAL = ' '
AND SU5.D_E_L_E_T_ = ' '
AND AC8_CODCON = U5_CODCONT

LEFT JOIN SUM000 SUM ON UM_FILIAL = ' '
AND SUM.D_E_L_E_T_ = ' '
AND UM_CARGO = U5_FUNCAO

WHERE A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_VEND = '000001'
AND A1_CODTER BETWEEN @I_CODTER@ AND @F_CODTER@

UNION ALL

SELECT DISTINCT
'PROSPECT' AS ENTIDADE
,US_COD AS CODIGO
,US_NOME AS NOME
,US_CGC CNPJ
,US_CNAE AS CNAE
,CC3_DESC
,US_CODSEG AS CODSEG
,AOV1.AOV_DESSEG AS DESSEG
,US_XCODSUB AS CODSUB
,AOV2.AOV_DESSEG AS DESSUB
,US_VEND AS ESN
,A3_NOME AS NOMEESN
,US_CODMEMB AS UNIDADE
,ADK1.ADK_NOME AS NOMEUNID
,US_CODTER AS CODTER
,ADK2.ADK_NOME AS NOMETER
,U5_CONTAT COD_CONT
,U5_EMAIL EMAIL_CONT
,U5_DDD
,U5_FCOM1
,U5_CELULAR
,UM_DESC CARGO

FROM SUS000 SUS

LEFT JOIN CC3000 CC3 ON CC3_FILIAL = ' '
AND CC3.D_E_L_E_T_ = ' '
AND CC3_COD = US_CNAE

LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' '
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = US_CODSEG
AND AOV1.AOV_PAI = ' '

LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' '
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = US_XCODSUB
AND AOV2.AOV_PAI = US_CODSEG

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = US_VEND

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK1 ON ADK1.ADK_FILIAL = ' '
AND ADK1.D_E_L_E_T_ = ' '
AND ADK1.ADK_COD = US_CODMEMB

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK2 ON ADK2.ADK_FILIAL = ' '
AND ADK2.D_E_L_E_T_ = ' '
AND ADK2.ADK_COD = US_CODTER

LEFT JOIN AC8000 AC8 ON AC8_FILIAL = ' '
AND AC8.D_E_L_E_T_ = ' '
AND AC8_ENTIDA = 'SUS'
AND US_COD = SUBSTR(AC8_CODENT,1,6)

LEFT JOIN SU5000 SU5 ON U5_FILIAL = ' '
AND SU5.D_E_L_E_T_ = ' '
AND AC8_CODCON = U5_CODCONT

LEFT JOIN SUM000 SUM ON UM_FILIAL = ' '
AND SUM.D_E_L_E_T_ = ' '
AND UM_CARGO = U5_FUNCAO

WHERE US_FILIAL = ' '
AND SUS.D_E_L_E_T_ = ' '
AND US_VEND = '000001'
AND US_CODTER BETWEEN @I_CODTER@ AND @F_CODTER@
AND US_STATUS <> '6'

UNION ALL

SELECT DISTINCT
'SUSPECT' AS ENTIDADE
,ACH_CODIGO AS CODIGO
,ACH_RAZAO AS NOME
,ACH_CGC CNPJ
,ACH_CNAE AS CNAE
,CC3_DESC
,ACH_CODSEG AS CODSEG
,AOV1.AOV_DESSEG AS DESSEG
,ACH_XCODSS AS CODSUB
,AOV2.AOV_DESSEG AS DESSUB
,ACH_VEND AS ESN
,A3_NOME AS NOMEESN
,ACH_CODMEM AS UNIDADE
,ADK1.ADK_NOME AS NOMEUNID
,ACH_CODTER AS CODTER
,ADK2.ADK_NOME AS NOMETER
,U5_CONTAT COD_CONT
,U5_EMAIL EMAIL_CONT
,U5_DDD
,U5_FCOM1
,U5_CELULAR
,UM_DESC CARGO

FROM ACH000 ACH

LEFT JOIN CC3000 CC3 ON CC3_FILIAL = ' '
AND CC3.D_E_L_E_T_ = ' '
AND CC3_COD = ACH_CNAE

LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' '
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = ACH_CODSEG
AND AOV1.AOV_PAI = ' '

LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' '
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = ACH_XCODSS
AND AOV2.AOV_PAI = ACH_CODSEG

LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND A3_COD = ACH_VEND

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK1 ON ADK1.ADK_FILIAL = ' '
AND ADK1.D_E_L_E_T_ = ' '
AND ADK1.ADK_COD = ACH_CODMEM

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK2 ON ADK2.ADK_FILIAL = ' '
AND ADK2.D_E_L_E_T_ = ' '
AND ADK2.ADK_COD = ACH_CODTER

LEFT JOIN AC8000 AC8 ON AC8_FILIAL = ' '
AND AC8.D_E_L_E_T_ = ' '
AND AC8_ENTIDA = 'ACH'
AND ACH_CODIGO = SUBSTR(AC8_CODENT,1,6)

LEFT JOIN SU5000 SU5 ON U5_FILIAL = ' '
AND SU5.D_E_L_E_T_ = ' '
AND AC8_CODCON = U5_CODCONT

LEFT JOIN SUM000 SUM ON UM_FILIAL = ' '
AND SUM.D_E_L_E_T_ = ' '
AND UM_CARGO = U5_FUNCAO

WHERE ACH_FILIAL = ' '
AND ACH.D_E_L_E_T_ = ' '
AND ACH_VEND = '000001'
AND ACH_CODTER BETWEEN @I_CODTER@ AND @F_CODTER@
AND ACH_STATUS <> '6';;Lista de contas que estejam no pool de contas.
Clientes
Prospects
Suspects
RETTEF;PV DA OFERTA TEF GERADOS NO PROTHEUS;05;20190425;;12;2;;0;;;;2;9V;;;1;2;0;;;1;;SELECT	'PROTHEUS'	ORIGINFO	
	,'81' 	UNIDORGAN	
	,F2_FILIAL 	FILPROT		
	,'0'||A1_CGC	CNPJFAT		
	,C5_PEDECOM 	PEDORACLE	
	,C5_PEDECOM 	ORDEMLEG	
	,C5_NUM 	PVPROTHEUS	
	,F2_DOC 	NF			
	,F2_EMISSAO	EMISSAO		
	,F2_VALBRUT	TOTAL		
FROM							
	<ADVPL>RetSqlName("SF2")</ADVPL> F2	
		INNER JOIN <ADVPL>RetSqlName("SD2")</ADVPL> D2
		ON	D2_FILIAL = F2_FILIAL AND					
			D2_DOC = F2_DOC AND					
			D2_SERIE = F2_SERIE AND					
			D2.D_E_L_E_T_ = ' '	
		INNER JOIN <ADVPL>RetSqlName("SC6")</ADVPL> C6
		ON	C6_FILIAL = D2_FILIAL AND					
			C6_NUM = D2_PEDIDO AND					
			C6_ITEM = D2_ITEMPV AND					
			C6_NOTA = D2_DOC AND					
			C6_SERIE = D2_SERIE AND
			C6_PRODUTO LIKE 'TFL%' AND					
			C6.D_E_L_E_T_ = ' '	
		INNER JOIN <ADVPL>RetSqlName("SC5")</ADVPL> C5
		ON C5_FILIAL = C6_FILIAL AND				
			C5_NUM = C6_NUM AND				
			C5_NUM BETWEEN @PV_I@ AND @PV_F@ AND		
			C5.D_E_L_E_T_ = ' '	
		INNER JOIN <ADVPL>RetSqlName("SA1")</ADVPL> A1
		ON A1_FILIAL = '<ADVPL>xFilial("SA1")</ADVPL>' AND				
			A1_COD = F2_CLIENTE AND					
			A1_LOJA = F2_LOJA  AND					
			A1.D_E_L_E_T_ = ' ' 
WHERE F2_FILIAL = '<ADVPL>xFilial("SF2")</ADVPL>' AND						
	F2_DOC BETWEEN @NOTA_I@ AND @NOTA_F@ AND					
	F2_EMISSAO BETWEEN @EMISS_I@ AND @EMISS_F@ AND					
	F2.D_E_L_E_T_ = ' '	
ORDER BY F2_EMISSAO, F2_DOC;;
RJCON;REAJUSTE DE CONTRATOS;69;20200319;;348;2;;0;;;;2;9W;;;1;2;0;;;1;;SELECT CXL_CONTRA,
CXL_REVISA,
CXL_PLAN,
CXL_ITEMPL,
CXL_ITEM,
CXL_DTPREV,
CXL_DTREAJ,
CXL_DTPROX,
CXL_VLANT,
CXL_VLATU,
CNB_QUANT,
CXL_INDICE,
CXL_VLIND,
CXL_VLAPL,
CXL_SITUAC,
CXL_XCOMPE,
CNB_UNINEG,
CNB_DESCRI,
B1_GRUPO,
BM_DESC,
CNB_SITUAC,
CASE
WHEN CNB_CONDIC = '00' THEN 'MENSAL'
WHEN CNB_CONDIC = '01' THEN 'BIMESTRAL'
WHEN CNB_CONDIC = '02' THEN 'TRIMESTRAL'
WHEN CNB_CONDIC = '03' THEN 'QUADRIMESTRAL'
WHEN CNB_CONDIC = '05' THEN 'SEMESTRAL'
WHEN CNB_CONDIC = '11' THEN 'ANUAL'
WHEN CNB_CONDIC = '12' THEN 'BIANUAL'
END AS CNB_CONDIC,
CASE
WHEN CNB_TIPREC = '1' THEN 'RECORRENTE'
WHEN CNB_TIPREC = '2' THEN 'PONTUAL'
END AS CNB_TIPREC,
CASE
WHEN BM_FLGREAJ = '1' THEN 'SIM'
WHEN BM_FLGREAJ = '2' THEN 'NAO'
END AS BM_FLGREAJ,
CASE
WHEN CNB_XBILLI = ' '  THEN 'NAO'
WHEN CNB_XBILLI = '1' THEN 'SIM'
WHEN CNB_XBILLI = '2' THEN 'NAO'
END AS CNB_XBILLI,
CASE
WHEN A1_XCLIVIP = '1' THEN 'VIP'            
WHEN A1_XCLIVIP = '2' THEN 'Padrao'                                                 
WHEN A1_XCLIVIP = '3' THEN 'Governo'                                                
WHEN A1_XCLIVIP = '4' THEN 'Private'                                                
WHEN A1_XCLIVIP = '5' THEN 'Gen'
WHEN A1_XCLIVIP = '6' THEN 'TFS'
WHEN A1_XCLIVIP = '7' THEN 'VBP'
WHEN A1_XCLIVIP = '8' THEN 'PBP'
WHEN A1_XCLIVIP = '9' THEN 'Fran'
WHEN A1_XCLIVIP = 'M' THEN 'Eleve'
WHEN A1_XCLIVIP = 'P' THEN 'Parc'
WHEN A1_XCLIVIP = 'G' THEN 'Gare'
WHEN A1_XCLIVIP = 'U' THEN 'Un Pr'
WHEN A1_XCLIVIP = 'F' THEN 'MPN FLY01'
WHEN A1_XCLIVIP = 'T' THEN 'TQTVD'                                                 
WHEN A1_XCLIVIP = 'B' THEN 'MPN BEMA'
WHEN A1_XCLIVIP = 'V' THEN 'Vip Adv'
WHEN A1_XCLIVIP = 'C' THEN 'CMNET'
WHEN A1_XCLIVIP = 'E' THEN 'BEMATECH'
END AS A1_XCLIVIP,
CASE
WHEN CNB_XTPILI = '1' THEN 'Ilimitado'
WHEN CNB_XTPILI = '2' THEN 'IDs'
END AS CNB_XTPILI,
CASE
WHEN ( EXISTS( SELECT * FROM ZQK000 ZQK
WHERE ZQK_CODZQJ = '000021' 
AND ZQK_GRUPO = B1_GRUPO
AND ZQK.D_E_L_E_T_ = ' ' )  )  THEN 'SIM'
ELSE 'NAO'
END AS SAAS,
( SELECT CN6_DESCRI FROM CN6000 CN6
WHERE CN6_CODIGO = CNB_INDICE 
AND CN6.D_E_L_E_T_ = ' ' ) AS CN6_DESCRI,
BM_XCONTAC,
CNB_PROPOS
FROM CXL000 CXL
INNER JOIN CNB000 CNB ON CNB_CONTRA = CXL_CONTRA
AND CNB_NUMERO = CXL_PLAN
AND CNB_ITEM = CXL_ITEMPL
AND CNB_REVISA = CXL_REVISA
INNER JOIN SA1000 SA1 ON A1_COD = SUBSTR(CNB_CONTRA,4,6)
INNER JOIN SB1000 SB1 ON B1_COD = CNB_PRODUT
INNER JOIN SBM000 SBM ON B1_GRUPO = BM_GRUPO
WHERE CXL.D_E_L_E_T_ = ' '
AND CNB.D_E_L_E_T_ = ' ' 
AND SB1.D_E_L_E_T_ = ' ' 
AND SBM.D_E_L_E_T_ = ' ' 
AND SA1.D_E_L_E_T_ = ' ' 
AND CXL_INDICE BETWEEN @I_INDICE@ AND @F_INDICE@
AND SUBSTR(CXL_XCOMPE,4,4)||SUBSTR(CXL_XCOMPE,1,2) BETWEEN <ADVPL>"'" + RIGHT(_I_COMPET,4) + LEFT(_I_COMPET,2) + "'"</ADVPL> 
AND <ADVPL>"'" + RIGHT(_F_COMPET,4) + LEFT(_F_COMPET,2)+ "'"</ADVPL>
;;
RMETAS;RELATÓRIO DE METAS;73;20180713;;223;2;;0;;;;2;9X;;;1;2;0;;;1;;SELECT DISTINCT
CT_VEND
,SA31.A3_NOME AS NOMEESN
,SUBSTR(CT_DATA,7,2) || '/' || SUBSTR(CT_DATA,5,2) || '/' || SUBSTR(CT_DATA,1,4) AS CT_DATA
,CT_VALOR
,CT_XCODSEG
,AOV_DESSEG
,CT_XAGRUP
,AOM_DESCRI
,CT_XCODSUP
,SA32.A3_NOME AS NOMEGSN
,CT_XUNIDAD
,ADK_NOME
,CT_DESCRI
,CT_XMETAPL
,CT_XMETAAR

FROM SCT000 SCT

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' ' 
AND ADK_COD = CT_XUNIDAD

LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' ' 
AND SA31.D_E_L_E_T_ = ' ' 
AND SA31.A3_COD = CT_VEND

LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' ' 
AND SA32.D_E_L_E_T_ = ' ' 
AND SA32.A3_COD = CT_XCODSUP

LEFT JOIN AOV000 AOV ON AOV_FILIAL = ' ' 
AND AOV.D_E_L_E_T_ = ' ' 
AND AOV_CODSEG = CT_XCODSEG
AND AOV_PAI = ' ' 

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' ' 
AND AOM.D_E_L_E_T_ = ' ' 
AND AOM_CODAGR = '000001'
AND AOM_CODNIV = CT_XAGRUP

WHERE CT_FILIAL = ' '
AND SCT.D_E_L_E_T_ <ADVPL>If(_DELETE = "1", "=", "<>")</ADVPL> ' ' 
AND CT_VEND BETWEEN @I_CT_VEND@ AND @F_CT_VEND@
AND CT_DATA BETWEEN @I_CT_DATA@ AND @F_CT_DATA@
AND CT_XCODSEG BETWEEN @I_XCODSEG@ AND @F_XCODSEG@
AND CT_XAGRUP BETWEEN @I_CT_XAGRUP@ AND @F_CT_XAGRUP@
AND CT_XCODSUP BETWEEN @I_XCODSUP@ AND @F_XCODSUP@
AND CT_XUNIDAD BETWEEN @I_CT_XUNIDAD@ AND @F_CT_XUNIDAD@;;Relatório de Metas
RV0001;DUPLICIDADES RV 1;06;20180705;;12;2;;0;;;;2;9Y;;;1;2;0;;;1;;SELECT PED_PROJET
	,PED_AGRUPA, TRB.PE8_COORD
FROM PED000 PED

INNER JOIN ( SELECT DISTINCT PE8_PROJET, PE8_AGRUPA, PE8_COORD
		FROM PE8000 PE8C
		WHERE PE8C.PE8_FILIAL = ' '
			AND PE8C.D_E_L_E_T_ = ' ' ) TRB
		ON TRB.PE8_PROJET = PED_PROJET
		AND TRB.PE8_AGRUPA = PED_AGRUPA

WHERE PED.PED_FILIAL = ' '
	AND PED.PED_STATUS = 'R'
	AND NOT EXISTS (
		SELECT 'OK'
		FROM PE8000 PE8
		WHERE PE8.PE8_FILIAL = ' '
			AND PE8.PE8_SUSPEN <> 'E'
			AND PE8.PE8_PROJET = PED.PED_PROJET
			AND PE8.PE8_AGRUPA = PED.PED_AGRUPA
			AND PE8.D_E_L_E_T_ = ' '
		)
	AND PED.D_E_L_E_T_ = ' ';;
RV0002;DUPLICIDADES RV 2;06;20180705;;18;2;;0;;;;2;9Z;;;1;2;0;;;1;;SELECT PED_PROJET
	,PED_AGRUPA
	,TRB.PE8_COORD
FROM PED000 PED
INNER JOIN PE5000 PE5 ON PE5.PE5_FILIAL = ' '
	AND PE5.PE5_PROJET = PED.PED_PROJET
	AND PE5.D_E_L_E_T_ = ' '
	AND EXISTS (
		SELECT 'OK'
		FROM ZX5000 ZX5
		WHERE ZX5.ZX5_FILIAL = ' '
			AND ZX5.ZX5_TABELA = 'SRV036'
			AND TRIM(ZX5.ZX5_CHAVE) = PE5.PE5_MODAL
			AND ZX5.D_E_L_E_T_ = ' '
		)
INNER JOIN (
	SELECT DISTINCT PE8_PROJET
		,PE8_AGRUPA
		,PE8_COORD
	FROM PE8000 PE8C
	WHERE PE8C.PE8_FILIAL = ' '
		AND PE8C.D_E_L_E_T_ = ' '
	) TRB ON TRB.PE8_PROJET = PED_PROJET
	AND TRB.PE8_AGRUPA = PED_AGRUPA
WHERE PED.PED_FILIAL = ' '
	AND PED.PED_STATUS = 'E'
	AND PED.PED_DTFECH = @DTFECHA@
	AND EXISTS (
		SELECT 'OK'
		FROM PF9000 PF9
		WHERE PF9.PF9_FILIAL = ' '
			AND PF9.PF9_DATA >= '20170401'
			AND PF9.PF9_PROJET = PED.PED_PROJET
			AND PF9.D_E_L_E_T_ = ' '
		)
	AND PED.D_E_L_E_T_ = ' ';;
RV0003;DUPLICIDADES RV 3;06;20180705;;11;2;;0;;;;2;A0;;;1;2;0;;;1;;SELECT PED_PROJET
	,PED_AGRUPA
	,TRB.PE8_COORD
FROM PED000 PED
INNER JOIN (
	SELECT DISTINCT PE8_PROJET
		,PE8_AGRUPA
		,PE8_COORD
	FROM PE8000 PE8C
	WHERE PE8C.PE8_FILIAL = ' '
		AND PE8C.D_E_L_E_T_ = ' '
	) TRB ON TRB.PE8_PROJET = PED_PROJET
	AND TRB.PE8_AGRUPA = PED_AGRUPA
WHERE PED.PED_FILIAL = ' '
	AND PED.PED_STATUS = 'R'
	AND NOT EXISTS (
		SELECT 'OK'
		FROM PE8000 PE8
		WHERE PE8.PE8_FILIAL = ' '
			AND PE8.PE8_SUSPEN <> 'E'
			AND PE8.PE8_PROJET = PED.PED_PROJET
			AND PE8.PE8_AGRUPA = PED.PED_AGRUPA
			AND PE8.D_E_L_E_T_ = ' '
		)
	AND PED.D_E_L_E_T_ = ' ';;
SA1PMV;GERACAO CLIENTES ACESSO EXTERNO;05;20200722;;73;2;;0;;;;2;A1;;;1;2;0;;;1;1;SELECT ZQJ_CINTEG, A1_COD, A1_LOJA, A1_NOME, A1_CGC, SA1.R_E_C_N_O_ AS RECNO_SA1
  FROM <ADVPL>RetSqlName("CN9")</ADVPL> CN9 
  JOIN <ADVPL>RetSqlName("CNB")</ADVPL> CNB ON CNB_FILIAL = '<ADVPL>xFilial("CNB")</ADVPL>' AND CNB_CONTRA = CN9_NUMERO AND CNB_REVISA = CN9_REVISA 
   AND CNB.D_E_L_E_T_ = ' '
  JOIN <ADVPL>RetSqlName("SB1")</ADVPL> SB1 ON B1_FILIAL = '<ADVPL>xFilial("SB1")</ADVPL>' AND B1_COD = CNB_PRODUT AND SB1.D_E_L_E_T_ = ' '
  JOIN <ADVPL>RetSqlName("ZQJ")</ADVPL> ZQJ ON ZQJ_FILIAL = ' ' AND ZQJ_CINTEG BETWEEN '000000' AND 'ZZZZZZ' AND ZQJ.D_E_L_E_T_ = ' '
  JOIN <ADVPL>RetSqlName("ZQK")</ADVPL> ZQK ON ZQK_FILIAL = ZQJ_FILIAL AND ZQK_CODZQJ = ZQJ_CODIGO AND ZQK_VERSAO = ZQJ_VERSAO
   AND ZQK_GRUPO = B1_GRUPO AND ZQK.D_E_L_E_T_ = ' '
  JOIN <ADVPL>RetSqlName("SA1")</ADVPL> SA1 ON A1_FILIAL = '<ADVPL>xFilial("SA1")</ADVPL>' AND A1_COD = SUBSTR(CN9_NUMERO, 4, 6) AND SA1.D_E_L_E_T_ = ' '
 WHERE CN9_FILIAL = ' ' AND CN9_SITUAC = '05' AND CN9_REVATU = ' ' AND CN9_ESPCTR = '2' AND CN9_TPCTO = '013' AND CN9.D_E_L_E_T_ = ' '
   AND NOT EXISTS(SELECT 1 FROM <ADVPL>RetSqlName("PMV")</ADVPL> WHERE PMV_FILIAL = '<ADVPL>xFilial("SA1")</ADVPL>' AND PMV_CINTEG = ZQJ.ZQJ_CINTEG 
                     AND PMV_ALIAS = 'SA1' AND PMV_VAR1 = SA1.A1_COD AND PMV_VAR2 = SA1.A1_LOJA AND D_E_L_E_T_ = ' ') 
 GROUP BY ZQJ_CINTEG, A1_COD, A1_LOJA, A1_NOME, A1_CGC, SA1.R_E_C_N_O_;<ADVPL> (U_EXECSQL("alter session set cursor_sharing = exact"), __JBINI := "004")</ADVPL>;Formulario para geração do conteudo da tabela PMV, que permite a disponibilização de informações para o metodo TADQGETCLIENTES para integração com outros sistemas
SC7;PEDIDOS DE COMPRAS;02;20220517;;1;2;SC7;0;;;;2;;;;1;2;0;;;1;;;;
SERIMP;PROPOSTA DE SERVIÇOS X MODELO DE IMPRESSÃO;73;20180614;;50;2;;0;;;;2;A2;;;1;2;0;;;1;;SELECT DISTINCT
'CLIENTE' AS ENTIDADE
,AD1_NROPOR OPORT
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTO'
WHEN AD1_STATUS = '2' THEN 'PERDIDA'
WHEN AD1_STATUS = '9' THEN 'GANHA'
END AS STAT_OPORT
,AD1_DATA
,AD1_DTFIM
,AD1_DTPFIM
,AD1_STAGE ESTAGIO
,ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS STAT_PROP
,(SELECT DISTINCT 
		SUM(ADZ_TOTAL)
			FROM ADZ000 ADZ 
			WHERE ADZ_FILIAL = ' ' 
			AND ADZ.D_E_L_E_T_ = ' '
			AND ADZ_PROPOS = ADY_PROPOS
			AND ADZ_REVISA = ADY_PREVIS
 ) AS TOTAL
,ADY_XMODAL
,AOM_DESCRI
,ADY_XUNSRV
,PE1_DESCRI
,A1_COD COD_CLI
,A1_NOME RAZ_SOCI
,A1_CODSEG SEGM
,AOV1.AOV_DESSEG AS DESSEG
,A1_XCODSUB SUBSEG
,AOV2.AOV_DESSEG AS DESSUB
,AD1_VEND COD_EAR
,SA3.A3_NOME NOME_EAR
,A1_CODMEMB UNIDADE
,ADK_NOME NOM_UNID
,AF5_ORCAME COD_ORC
,AF5_DESCRI DESC_ORC
,AF5_MODORI
,AF12.AF1_XMDIMP
,AG1_DESCRI NOME_MOD
,AD1_STAGE
,AC2_DESCRI
,AD1_FCS
,ZX51.ZX5_DESCRI AS DESCFCS
,AD1_FCI
,ZX52.ZX5_DESCRI AS DESCFCI
,CASE 
WHEN AD1_FEELIN = '1' THEN '30%'
WHEN AD1_FEELIN = '2' THEN '60%'
WHEN AD1_FEELIN = '3' THEN '90%'
END AS AD1_FEELIN

FROM ADY000 ADY

INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND AD1_NROPOR = ADY_OPORTU
AND AD1_REVISA = ADY_REVISA

INNER JOIN AD2000 AD2 ON AD2_FILIAL = ' '
AND AD2_NROPOR = AD1_NROPOR
AND AD2_REVISA = AD1_REVISA
AND AD2.D_E_L_E_T_ = ' '

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_COD = ADY_CODIGO

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = A1_CODMEMB

LEFT JOIN SA3000 SA3 ON SA3.A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND SA3.A3_COD = AD1_VEND

LEFT JOIN SA3000 SA3B ON SA3B.A3_FILIAL = ' '
AND SA3B.A3_COD = AD2_VEND
AND SA3B.D_E_L_E_T_ = ' '

LEFT JOIN AF1000 AF11 ON AF11.AF1_FILIAL = ' '
AND AF11.D_E_L_E_T_ = ' '
AND AF11.AF1_CODORC = ADY_PROPOS

LEFT JOIN AF5000 AF5 ON AF5_FILIAL = ' '
AND AF5.D_E_L_E_T_ = ' '
AND AF5_ORCAME = AF11.AF1_ORCAME

LEFT JOIN AF1000 AF12 ON AF12.AF1_FILIAL = ' '
AND AF12.D_E_L_E_T_ = ' '
AND AF12.AF1_ORCAME = AF5_MODORI

LEFT JOIN AG1000 AG1 ON AG1_FILIAL = ' '
AND AG1.D_E_L_E_T_ = ' '
AND AG1_CODIGO = AF12.AF1_XMDIMP

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = ADY_XMODAL  

LEFT JOIN  PE1000 PE1  ON PE1_FILIAL = ' '
AND PE1_CODIGO = ADY_XUNSRV
AND PE1.D_E_L_E_T_ = ' '

LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' '
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = A1_CODSEG
AND AOV1.AOV_PAI = ' '

LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' '
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = A1_XCODSUB
AND AOV2.AOV_PAI = A1_CODSEG

LEFT JOIN AC2000 AC2 ON AC2_FILIAL = ' ' 
AND AC2.D_E_L_E_T_ = ' ' 
AND AC2_PROVEN = '000002'
AND AC2_STAGE = AD1_STAGE

LEFT JOIN ZX5000 ZX51 ON ZX51.ZX5_FILIAL = ' ' 
AND ZX51.D_E_L_E_T_ = ' ' 
AND ZX51.ZX5_TABELA = 'CRM001'
AND ZX51.ZX5_CHAVE = AD1_FCS

LEFT JOIN ZX5000 ZX52 ON ZX52.ZX5_FILIAL = ' ' 
AND ZX52.D_E_L_E_T_ = ' ' 
AND ZX52.ZX5_TABELA = 'CRM003'
AND ZX52.ZX5_CHAVE = AD1_FCI

WHERE ADY_FILIAL = ' '
AND ADY_ENTIDA = '1'
AND AF5_EDT = '01'
AND AD1_DATA BETWEEN @I_AD1_DATA@ AND @F_AD1_DATA@ 
AND ADY_XMODAL IN ('0054','0055','0062','0063','0064','0065','0066','0067','0253','0277','0068','0185','0187','0216','0252','0069','0070','0071','0072','0073','0074','0075','0102','0103','0104','0105','0106','0107','0108','0084','0085','0263')
AND ADY.D_E_L_E_T_ = ' '

UNION ALL

SELECT DISTINCT
'PROSPECT' AS ENTIDADE
,AD1_NROPOR OPORT
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTO'
WHEN AD1_STATUS = '2' THEN 'PERDIDA'
WHEN AD1_STATUS = '9' THEN 'GANHA'
END AS STAT_OPORT
,AD1_DATA
,AD1_DTFIM
,AD1_DTPFIM
,AD1_STAGE ESTAGIO
,ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS STAT_PROP
,(SELECT DISTINCT 
		SUM(ADZ_TOTAL)
			FROM ADZ000 ADZ 
			WHERE ADZ_FILIAL = ' ' 
			AND ADZ.D_E_L_E_T_ = ' '
			AND ADZ_PROPOS = ADY_PROPOS
			AND ADZ_REVISA = ADY_PREVIS
 ) AS TOTAL
,ADY_XMODAL
,AOM_DESCRI
,ADY_XUNSRV
,PE1_DESCRI
,US_COD COD_CLI
,US_NOME RAZ_SOCI
,US_CODSEG SEGM
,AOV1.AOV_DESSEG AS DESSEG
,US_XCODSUB SUBSEG
,AOV2.AOV_DESSEG AS DESSUB
,AD1_VEND COD_EAR
,SA3.A3_NOME NOME_EAR
,US_CODMEMB UNIDADE
,ADK_NOME NOM_UNID
,AF5_ORCAME COD_ORC
,AF5_DESCRI DESC_ORC
,AF5_MODORI
,AF12.AF1_XMDIMP
,AG1_DESCRI NOME_MOD
,AD1_STAGE
,AC2_DESCRI
,AD1_FCS
,ZX51.ZX5_DESCRI AS DESCFCS
,AD1_FCI
,ZX52.ZX5_DESCRI AS DESCFCI
,CASE 
WHEN AD1_FEELIN = '1' THEN '30%'
WHEN AD1_FEELIN = '2' THEN '60%'
WHEN AD1_FEELIN = '3' THEN '90%'
END AS AD1_FEELIN

FROM ADY000 ADY

INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND AD1_NROPOR = ADY_OPORTU
AND AD1_REVISA = ADY_REVISA

INNER JOIN AD2000 AD2 ON AD2_FILIAL = ' '
AND AD2_NROPOR = AD1_NROPOR
AND AD2_REVISA = AD1_REVISA
AND AD2.D_E_L_E_T_ = ' '

INNER JOIN SUS000 SUS ON US_FILIAL = ' '
AND SUS.D_E_L_E_T_ = ' '
AND US_COD = ADY_CODIGO

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = US_CODMEMB

LEFT JOIN SA3000 SA3 ON SA3.A3_FILIAL = ' '
AND SA3.D_E_L_E_T_ = ' '
AND SA3.A3_COD = AD1_VEND

LEFT JOIN AF1000 AF11 ON AF11.AF1_FILIAL = ' '
AND AF11.D_E_L_E_T_ = ' '
AND AF11.AF1_CODORC = ADY_PROPOS

LEFT JOIN AF5000 AF5 ON AF5_FILIAL = ' '
AND AF5.D_E_L_E_T_ = ' '
AND AF5_ORCAME = AF11.AF1_ORCAME

LEFT JOIN AF1000 AF12 ON AF12.AF1_FILIAL = ' '
AND AF12.D_E_L_E_T_ = ' '
AND AF12.AF1_ORCAME = AF5_MODORI

LEFT JOIN AG1000 AG1 ON AG1_FILIAL = ' '
AND AG1.D_E_L_E_T_ = ' '
AND AG1_CODIGO = AF12.AF1_XMDIMP

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' '
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = ADY_XMODAL  

LEFT JOIN  PE1000 PE1  ON PE1_FILIAL = ' '
AND PE1_CODIGO = ADY_XUNSRV
AND PE1.D_E_L_E_T_ = ' '

LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' '
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = US_CODSEG
AND AOV1.AOV_PAI = ' '

LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' '
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = US_XCODSUB
AND AOV2.AOV_PAI = US_CODSEG

LEFT JOIN AC2000 AC2 ON AC2_FILIAL = ' ' 
AND AC2.D_E_L_E_T_ = ' ' 
AND AC2_PROVEN = '000002'
AND AC2_STAGE = AD1_STAGE

LEFT JOIN ZX5000 ZX51 ON ZX51.ZX5_FILIAL = ' ' 
AND ZX51.D_E_L_E_T_ = ' ' 
AND ZX51.ZX5_TABELA = 'CRM001'
AND ZX51.ZX5_CHAVE = AD1_FCS

LEFT JOIN ZX5000 ZX52 ON ZX52.ZX5_FILIAL = ' ' 
AND ZX52.D_E_L_E_T_ = ' ' 
AND ZX52.ZX5_TABELA = 'CRM003'
AND ZX52.ZX5_CHAVE = AD1_FCI

WHERE ADY_FILIAL = ' '
AND ADY_ENTIDA = '2'
AND AF5_EDT = '01'
AND AD1_DATA BETWEEN @I_AD1_DATA@ AND @F_AD1_DATA@ 
AND ADY_XMODAL IN ('0054','0055','0062','0063','0064','0065','0066','0067','0253','0277','0068','0185','0187','0216','0252','0069','0070','0071','0072','0073','0074','0075','0102','0103','0104','0105','0106','0107','0108','0084','0085','0263')
AND ADY.D_E_L_E_T_ = ' ';;
SERPRO;PROPOSTAS DE SERVIÇOS;73;20180615;;1;2;;0;;;;2;A3;;;1;2;0;;;1;;SELECT DISTINCT	
AD1_NROPOR
,AD1_DESCRI
,ADY_PROPOS
,ADZ_PRODUT
,ADZ_DESCRI
,ADY_DATA
,CASE	
WHEN ADY_STATUS = 'A' THEN 'ABERTO'	
WHEN ADY_STATUS = 'B' THEN 'FECHADA'	
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'	
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'	
WHEN ADY_STATUS = 'E' THEN 'APROVADA'	
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'	
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'	
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'	
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'	
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'	
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'	
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDAS'	
END AS STATUS
,ADJ_CODNIV
,AOM_DESCRI
,ADY_XUNSRV
,PE1_DESCRI
,ADY_XMLUCR	

FROM AD1000 AD1	

INNER JOIN  ADY000 ADY  ON ADY_FILIAL = ' ' 
AND ADY_OPORTU = AD1_NROPOR 
AND ADY_REVISA = AD1_REVISA 
AND ADY.D_E_L_E_T_ = ' '	

INNER JOIN  ADZ000 ADZ 	ON ADZ_FILIAL = ' ' 
AND ADZ_PROPOS = ADY_PROPOS 
AND ADZ_REVISA = ADY_PREVIS 
AND ADZ.D_E_L_E_T_ = ' '

INNER JOIN  ADJ000 ADJ  ON ADJ_FILIAL = ' ' 
AND ADJ_NROPOR = AD1_NROPOR 
AND ADJ_REVISA = AD1_REVISA 
AND ADJ.D_E_L_E_T_ = ' '	

INNER JOIN  AOM000 AOM  ON AOM_FILIAL = ' ' 
AND AOM_CODAGR = ADJ_CODAGR 
AND AOM_CODNIV = ADJ_CODNIV 
AND AOM.D_E_L_E_T_ = ' '	

INNER JOIN  PE1000 PE1  ON PE1_FILIAL = ' ' 
AND PE1_CODIGO = ADY_XUNSRV 
AND PE1.D_E_L_E_T_ = ' '	
	
WHERE AD1_FILIAL = ' ' 
AND  ADY_DTUPL BETWEEN @I_ADY_DTUPL@ AND @F_ADY_DTUPL@
AND AD1.D_E_L_E_T_ = ' ' 
;;
SF2NFE;CONSULTA DE NOTAS DE SAIDA X NFE/NFSE;05;20180718;;3;2;SF2;0;;;;2;A4;;;1;2;0;;;1;;;;
SOFTCL;SOFTWARE COMPLEMENTAR FATURAMENTO X PC;02;20210713;;6;2;;0;;;;2;AI;;;1;2;0;;;1;;SELECT C7_FILIAL, C7_NUM, C7_ITEM, C7_XPROPOS, C7_NUMSC, C7_ITEMSC, C7_EMISSAO, C7_PRODUTO, C7_DESCRI, C7_QUANT, C7_PRECO, C7_TOTAL, C7_CC, C7_CONTA, C7_ITEMCTA, C7_CLVL, C7_FORNECE, A2_NOME,  C7_LOJA, C6_FILIAL, C6_NUM, C6_CLI, A1_NOME, C6_PRODUTO, C6_QTDVEN, C6_PRCVEN, C6_VALOR,
C6_NOTA, C6_SERIE, C6_DATFAT, SYS.USR_NOME AS C7_NOME , SYSA.USR_NOME AS C1_NOME
FROM <ADVPL>RetSqlName('SC7')</ADVPL> SC7
INNER JOIN <ADVPL>RetSqlName('SC6')</ADVPL> SC6 ON C6_FILIAL = C7_FILIAL AND C6_PRODUTO = C7_PRODUTO AND C6_XPROPOS = C7_XPROPOS AND  SC6.D_E_L_E_T_ = ' '
INNER JOIN <ADVPL>RetSqlName('SA2')</ADVPL> SA2 ON A2_FILIAL = ' ' AND A2_COD = C7_FORNECE AND A2_LOJA = C7_LOJA AND SA2.D_E_L_E_T_ = ' '
INNER JOIN <ADVPL>RetSqlName('SA1')</ADVPL> SA1 ON A1_FILIAL = ' ' AND A1_COD = C6_CLI AND A1_LOJA = C6_LOJA  AND SA1.D_E_L_E_T_ = ' '
INNER JOIN <ADVPL>RetSqlName('SC1')</ADVPL> SC1 ON C1_FILIAL = C7_FILIAL AND C1_PRODUTO = C7_PRODUTO AND C1_NUM = C7_NUMSC AND C1_ITEM = C7_ITEMSC AND C1_LOJA = C7_LOJA AND SC1.D_E_L_E_T_ = ' '
INNER JOIN SYS_USR SYS ON SYS.USR_ID = C7_USER AND SYS.D_E_L_E_T_ = ' '
INNER JOIN SYS_USR SYSA ON SYSA.USR_ID = C1_USER AND SYSA.D_E_L_E_T_ = ' '
WHERE
C7_XPROPOS <> ' '
AND C7_TPPED = '7'
AND SC7.D_E_L_E_T_ = ' '
<ADVPL> IF(!Empty(mv_par02), " AND C7_FILIAL BETWEEN '" + mv_par01 + "' AND '" + mv_par02 + "' ", "")</ADVPL>
<ADVPL> IF(!Empty(mv_par04), " AND C7_EMISSAO BETWEEN '" + mv_par03 + "' AND '" + mv_par04 + "' ", "")</ADVPL>
ORDER BY C7_NUM, C7_ITEM, C7_XPROPOS;;
SRV001;COORDENADORES DE PROJETO;97;20190123;;1;2;;0;;;;2;A5;;;1;2;0;;;1;;SELECT RD0_CODIGO,RD0_NOME,RD0_TIPO,RD0_EMAIL,RD0_MSBLQL,RD0_XPRFAC,RD0_XTPCGO,RD0_XCARGO,RD0_XUNSRV FROM RD0000 RD0
WHERE
RD0.RD0_XTPCGO = 'CP'
AND RD0.RD0_FILIAL = ' '
AND RD0.D_E_L_E_T_ = ' ';;
SRVOPT;OPORTUNIDADES DE SERVIÇOS;73;20200731;;0;2;;0;;;;2;A6;;;1;2;0;;;1;;SELECT DISTINCT
'CLIENTE' AS ENTIDADE
,AD1_NROPOR
,CASE
	WHEN AD1_STATUS = '1' THEN 'ABERTA'
	WHEN AD1_STATUS = '9' THEN 'GANHA'
	WHEN AD1_STATUS = '2' THEN 'PERDIDA'
END AS AD1_STATUS
,AD1_DTINI
,AD1_DTFIM
,ADY_PROPOS
,(SELECT DISTINCT 
		SUM(ADZ_TOTAL)
			FROM ADZ000 ADZ 
			WHERE ADZ_FILIAL = ' ' 
			AND ADZ.D_E_L_E_T_ = ' '
			AND ADZ_PROPOS = ADY_PROPOS
			AND ADZ_REVISA = ADY_PREVIS

 ) AS TOTAL
,ADJ_CODNIV
,AOM_DESCRI
,AD1_CODCLI AS COD_CONT
,A1_NOME AS RAZAO
,A1_CODSEG AS SEGMEN
,AOV_DESSEG
,ADY_XUNSRV
,PE1_DESCRI
,AD1_USER
,USR_NOME

FROM PKG000 PKG

INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' ' 
AND ADJ.D_E_L_E_T_ = ' '
AND ADJ_CODAGR = '000112'
AND ADJ_CODNIV = PKG_CODNIV

INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' ' 
AND AD1.D_E_L_E_T_ = ' '
AND AD1_NROPOR = ADJ_NROPOR
AND AD1_REVISA = ADJ_REVISA

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' ' 
AND A1_COD = AD1_CODCLI

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' ' 
AND AOM.D_E_L_E_T_ = ' ' 
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = ADJ_CODNIV

LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' ' 
AND ADY_OPORTU = AD1_NROPOR
AND ADY_REVISA = AD1_REVISA
AND ADY_XUNSRV = '001'

LEFT JOIN PE1000 PE1 ON PE1_FILIAL = ' ' 
AND PE1.D_E_L_E_T_ = ' ' 
AND PE1_CODIGO = ADY_XUNSRV

LEFT JOIN AOV000 AOV ON AOV_FILIAL = ' ' 
AND AOV.D_E_L_E_T_ = ' ' 
AND AOV_CODSEG = A1_CODSEG
AND AOV_PAI = ' ' 

LEFT JOIN SYS_USR USR ON USR.D_E_L_E_T_ = ' '
AND USR_ID = AD1_USER

WHERE PKG_FILIAL = ' ' 
AND PKG.D_E_L_E_T_ = ' ' 
AND PKG_TPVEND = '2'
AND PKG_CODAGR = '000112'
AND AD1_DTINI BETWEEN @I_DATA@ AND @F_DATA@

UNION 

SELECT DISTINCT
'PROSPECT' AS ENTIDADE
,AD1_NROPOR
,CASE
	WHEN AD1_STATUS = '1' THEN 'ABERTA'
	WHEN AD1_STATUS = '9' THEN 'GANHA'
	WHEN AD1_STATUS = '2' THEN 'PERDIDA'
END AS AD1_STATUS
,AD1_DTINI
,AD1_DTFIM
,ADY_PROPOS
,(SELECT DISTINCT 
		SUM(ADZ_TOTAL)
			FROM ADZ000 ADZ 
			WHERE ADZ_FILIAL = ' ' 
			AND ADZ.D_E_L_E_T_ = ' '
			AND ADZ_PROPOS = ADY_PROPOS
			AND ADZ_REVISA = ADY_PREVIS

 ) AS TOTAL
,ADJ_CODNIV
,AOM_DESCRI
,AD1_PROSPE AS COD_CONT
,US_NOME AS RAZAO
,US_CODSEG AS SEGMEN
,AOV_DESSEG
,ADY_XUNSRV
,PE1_DESCRI
,AD1_USER
,USR_NOME

FROM PKG000 PKG

INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' ' 
AND ADJ.D_E_L_E_T_ = ' '
AND ADJ_CODAGR = '000112'
AND ADJ_CODNIV = PKG_CODNIV

INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' ' 
AND AD1.D_E_L_E_T_ = ' '
AND AD1_NROPOR = ADJ_NROPOR
AND AD1_REVISA = ADJ_REVISA

INNER JOIN SUS000 SUS ON US_FILIAL = ' ' 
AND SUS.D_E_L_E_T_ = ' ' 
AND US_COD = AD1_PROSPE

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' ' 
AND AOM.D_E_L_E_T_ = ' ' 
AND AOM_CODAGR = '000112'
AND AOM_CODNIV = ADJ_CODNIV

LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' ' 
AND ADY_OPORTU = AD1_NROPOR
AND ADY_REVISA = AD1_REVISA
AND ADY_XUNSRV = '001'

LEFT JOIN PE1000 PE1 ON PE1_FILIAL = ' ' 
AND PE1.D_E_L_E_T_ = ' ' 
AND PE1_CODIGO = ADY_XUNSRV

LEFT JOIN AOV000 AOV ON AOV_FILIAL = ' ' 
AND AOV.D_E_L_E_T_ = ' ' 
AND AOV_CODSEG = US_CODSEG
AND AOV_PAI = ' ' 

LEFT JOIN SYS_USR USR ON USR.D_E_L_E_T_ = ' '
AND USR_ID = AD1_USER

WHERE PKG_FILIAL = ' ' 
AND PKG.D_E_L_E_T_ = ' ' 
AND PKG_TPVEND = '2'
AND PKG_CODAGR = '000112'
AND AD1_DTINI BETWEEN @I_DATA@ AND @F_DATA@;;
SRVSGR;CONSULTA PROPOSTAS COM GRUPOS DE OFERTAS;73;20211103;;3;2;;0;;;;2;;;;1;1;0;;;1;;<ADVPL>IF(_ENTIDA = "2","SELECT 'CLIENTE' AS ENTIDADE,AD1_NROPOR,AD1_DESCRI,AD1_DTASSI,ADY_PROPOS,ADY_DATA,CASE WHEN ADY_STATUS = 'A' THEN 'PROPOSTA EM ABERTO' WHEN ADY_STATUS = 'B' THEN 'PROPOSTA FECHADA'WHEN ADY_STATUS = 'C' THEN 'PROPOSTA CANCELADA'WHEN ADY_STATUS = 'D' THEN 'PROPOSTA NÃO APROVADA' WHEN ADY_STATUS = 'E' THEN 'PROPOSTA APROVADA' WHEN ADY_STATUS = 'F' THEN 'PROPOSTA BLOQUEADA' WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE' WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE' WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO' WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO' WHEN ADY_STATUS = 'K' THEN 'NOTA FISCAL GERADA' END AS ADY_STATUS,ADY_XMSPSA,PA3_RISK,CASE WHEN ADY_XTPATE = '1' THEN '100% REMOTO' WHEN ADY_XTPATE = '2' THEN 'ATÉ 30% PRESENCIAL' WHEN ADY_XTPATE = '3' THEN 'MAIS QUE 30% PRESENCIAL' WHEN ADY_XTPATE = '4' THEN '100% PRESENCIAL' ELSE 'NAO PREENCHIDO' END AS ADY_XTPATE,CASE WHEN ADY_WEBORC = '1' THEN 'SIM' ELSE 'NAO' END AS ADY_WEBORC,(SELECT DISTINCT SUM(ADZ_TOTAL) FROM   ADZ000 ADZ WHERE  ADZ_FILIAL = ' ' AND ADZ.D_E_L_E_T_ = ' ' AND ADZ_PROPOS = ADY_PROPOS AND ADZ_REVISA = ADY_PREVIS)  AS TOTAL,( SELECT DISTINCT SUM(ADZ_QTDVEN) FROM   ADZ000 ADZ WHERE  ADZ_FILIAL = ' ' AND ADZ.D_E_L_E_T_ = ' ' AND ADZ_PROPOS = ADY_PROPOS AND ADZ_REVISA = ADY_PREVIS)  AS QTDTOTAL,ADJ_CODNIV,AOM_DESCRI,AD1_CODCLI AS COD_CONT,A1_NOME AS RAZAO,AD1_VEND AS COD_VEND,A3_NOME,A3_UNIDAD,ADK_NOME NOM_UNID,ADY_XUNSRV,PE1_DESCRI,ADY_USREMI,USR_NOME,ADY_XDTPRI,ADY_XDTPRF,ORC.PVT_CODIGO,ORC.PVT_DESCRI FROM   PKG000 PKG INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' ' AND ADJ_CODAGR = '000112'  AND ADJ_CODNIV = PKG_CODNIV AND ADJ.D_E_L_E_T_ = ' ' INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' ' AND AD1_NROPOR = ADJ_NROPOR AND AD1_REVISA = ADJ_REVISA AND AD1.D_E_L_E_T_ = ' ' LEFT JOIN PA3000 PA3 ON PA3.PA3_FILIAL = ' ' AND PA3.PA3_OPORTU = AD1_NROPOR AND PA3.PA3_VERSAO = ( SELECT MAX(P3.PA3_VERSAO) FROM   PA3000 P3 WHERE  P3.D_E_L_E_T_ = ' ' AND P3.PA3_OPORTU = AD1_NROPOR AND P3.PA3_FILIAL = ' ') AND PA3.D_E_L_E_T_= ' ' INNER JOIN SA1000 SA1 ON A1_FILIAL = ' ' AND A1_COD = AD1_CODCLI AND A1_LOJA = AD1_LOJCLI AND SA1.D_E_L_E_T_ = ' ' INNER JOIN AOM000 AOM ON AOM_FILIAL = ' ' AND AOM_CODAGR = '000112' AND AOM_CODNIV = ADJ_CODNIV AND AOM.D_E_L_E_T_ = ' ' LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' AND A3_COD = AD1_VEND AND SA3.D_E_L_E_T_ = ' ' LEFT JOIN ADK000 ADK ON ADK_FILIAL = ' ' AND ADK_COD = A3_UNIDAD AND ADK.D_E_L_E_T_ = ' ' INNER JOIN ADY000 ADY ON ADY_FILIAL = ' ' AND ADY_OPORTU = AD1_NROPOR  AND ADY_REVISA = AD1_REVISA  AND ADY.D_E_L_E_T_ = ' ' LEFT JOIN PE1000 PE1 ON PE1_FILIAL = ' '  AND PE1_CODIGO = ADY_XUNSRV  AND PE1.D_E_L_E_T_ = ' ' LEFT JOIN SYS_USR USR ON USR_ID = ADY_USREMI  AND USR.D_E_L_E_T_ = ' ' LEFT JOIN (  SELECT AF5.AF5_ORCAME,AF5.AF5_VERSAO,AF5.AF5_DESCRI,PVT_CODIGO,PVT_DESCRI,ADZC.ADZ_PROPOS,ADZC.ADZ_REVISA  FROM   AF1000 AF1 INNER JOIN AF5000 AF5 ON AF5.D_E_L_E_T_ = ' '  AND AF5.AF5_FILIAL = '           '  AND AF5.AF5_ORCAME = AF1.AF1_ORCAME  AND AF5.AF5_VERSAO = AF1.AF1_VERSAO  INNER JOIN AF2000 AF2C ON AF2C.D_E_L_E_T_ = ' ' AND AF2C.AF2_FILIAL = '           '  AND AF2C.AF2_ORCAME = AF5.AF5_ORCAME  AND AF2C.AF2_VERSAO = AF5.AF5_VERSAO  AND AF2C.AF2_EDTPAI = AF5.AF5_EDT  INNER JOIN ADZ000 ADZC ON ADZC.ADZ_FILIAL = ' '  AND ADZC.D_E_L_E_T_ = ' '  AND ADZC.ADZ_PMS=AF2C.AF2_ORCAME AND ADZC.ADZ_PMSVER=AF2C.AF2_VERSAO INNER JOIN PVT000 PVT ON PVT.PVT_FILIAL = '           ' AND AF2C.AF2_XGRPOF LIKE '%' || PVT.PVT_CODIGO || '%' AND PVT.D_E_L_E_T_ = ' '  WHERE  AF1.AF1_FILIAL = ' ' AND AF1.AF1_SIMULA = 'T'  AND AF1.D_E_L_E_T_ = ' ' GROUP BY AF5.AF5_ORCAME ,AF5.AF5_VERSAO ,PVT_CODIGO ,PVT_DESCRI ,AF5.AF5_DESCRI ,ADZC.ADZ_PROPOS ,ADZC.ADZ_REVISA )  ORC ON ORC.ADZ_PROPOS=ADY.ADY_PROPOS  AND ORC.ADZ_REVISA=ADY.ADY_PREVIS WHERE  PKG_FILIAL = ' ' AND PKG.D_E_L_E_T_ = ' '  AND PKG_CODAGR = '000112'  AND PKG_TPVEND = '2'  AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@","SELECT 'PROSPECT' AS ENTIDADE,AD1_NROPOR,AD1_DESCRI,AD1_DTASSI,ADY_PROPOS,ADY_DATA,CASE WHEN ADY_STATUS = 'A' THEN 'PROPOSTA EM ABERTO' WHEN ADY_STATUS = 'B' THEN 'PROPOSTA FECHADA'WHEN ADY_STATUS = 'C' THEN 'PROPOSTA CANCELADA'WHEN ADY_STATUS = 'D' THEN 'PROPOSTA NÃO APROVADA' WHEN ADY_STATUS = 'E' THEN 'PROPOSTA APROVADA' WHEN ADY_STATUS = 'F' THEN 'PROPOSTA BLOQUEADA' WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE' WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE' WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO' WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO' WHEN ADY_STATUS = 'K' THEN 'NOTA FISCAL GERADA' END AS ADY_STATUS,ADY_XMSPSA,PA3_RISK,CASE WHEN ADY_XTPATE = '1' THEN '100% REMOTO' WHEN ADY_XTPATE = '2' THEN 'ATÉ 30% PRESENCIAL' WHEN ADY_XTPATE = '3' THEN 'MAIS QUE 30% PRESENCIAL' WHEN ADY_XTPATE = '4' THEN '100% PRESENCIAL' ELSE 'NAO PREENCHIDO' END AS ADY_XTPATE,CASE WHEN ADY_WEBORC = '1' THEN 'SIM' ELSE 'NAO' END AS ADY_WEBORC,(  SELECT DISTINCT SUM(ADZ_TOTAL) FROM   ADZ000 ADZ WHERE  ADZ_FILIAL = ' ' AND ADZ.D_E_L_E_T_ = ' ' AND ADZ_PROPOS = ADY_PROPOS  AND ADZ_REVISA = ADY_PREVIS)  AS TOTAL,(  SELECT DISTINCT SUM(ADZ_QTDVEN) FROM   ADZ000 ADZ WHERE  ADZ_FILIAL = ' ' AND ADZ.D_E_L_E_T_ = ' ' AND ADZ_PROPOS = ADY_PROPOS AND ADZ_REVISA = ADY_PREVIS)  AS QTDTOTAL,ADJ_CODNIV,AOM_DESCRI,AD1_CODCLI AS COD_CONT,US_NOME AS RAZAO,AD1_VEND AS COD_VEND,A3_NOME,A3_UNIDAD,ADK_NOME NOM_UNID,ADY_XUNSRV,PE1_DESCRI,ADY_USREMI,USR_NOME,ADY_XDTPRI,ADY_XDTPRF,ORC.PVT_CODIGO,ORC.PVT_DESCRI FROM   PKG000 PKG INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' '  AND ADJ_CODAGR = '000112'  AND ADJ_CODNIV = PKG_CODNIV  AND ADJ.D_E_L_E_T_ = ' ' INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' '  AND AD1_NROPOR = ADJ_NROPOR  AND AD1_REVISA = ADJ_REVISA  AND AD1.D_E_L_E_T_ = ' ' LEFT JOIN PA3000 PA3 ON PA3.PA3_FILIAL = ' '  AND PA3.PA3_OPORTU = AD1_NROPOR  AND PA3.PA3_VERSAO = ( SELECT MAX(P3.PA3_VERSAO) FROM   PA3000 P3  WHERE  P3.D_E_L_E_T_ = ' '  AND P3.PA3_OPORTU = AD1_NROPOR  AND P3.PA3_FILIAL = ' ')  AND PA3.D_E_L_E_T_= ' ' INNER JOIN SUS000 SUS ON US_FILIAL = ' '  AND US_COD = AD1_PROSPE AND US_LOJA = AD1_LOJPRO  AND SUS.D_E_L_E_T_ = ' ' INNER JOIN AOM000 AOM ON AOM_FILIAL = ' '  AND AOM_CODAGR = '000112'  AND AOM_CODNIV = ADJ_CODNIV  AND AOM.D_E_L_E_T_ = ' ' LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' '  AND A3_COD = AD1_VEND  AND SA3.D_E_L_E_T_ = ' ' LEFT JOIN ADK000 ADK ON ADK_FILIAL = ' '  AND ADK_COD = A3_UNIDAD  AND ADK.D_E_L_E_T_ = ' ' INNER JOIN ADY000 ADY ON ADY_FILIAL = ' '  AND ADY_OPORTU = AD1_NROPOR  AND ADY_REVISA = AD1_REVISA  AND ADY.D_E_L_E_T_ = ' ' LEFT JOIN PE1000 PE1 ON PE1_FILIAL = ' '  AND PE1_CODIGO = ADY_XUNSRV  AND PE1.D_E_L_E_T_ = ' ' LEFT JOIN SYS_USR USR ON USR_ID = ADY_USREMI  AND USR.D_E_L_E_T_ = ' ' LEFT JOIN (  SELECT AF5.AF5_ORCAME,AF5.AF5_VERSAO,AF5.AF5_DESCRI,PVT_CODIGO,PVT_DESCRI,ADZC.ADZ_PROPOS,ADZC.ADZ_REVISA  FROM   AF1000 AF1  INNER JOIN AF5000 AF5 ON AF5.D_E_L_E_T_ = ' '  AND AF5.AF5_FILIAL = '           '  AND AF5.AF5_ORCAME = AF1.AF1_ORCAME  AND AF5.AF5_VERSAO = AF1.AF1_VERSAO INNER JOIN AF2000 AF2C ON AF2C.D_E_L_E_T_ = ' ' AND AF2C.AF2_FILIAL = '           ' AND AF2C.AF2_ORCAME = AF5.AF5_ORCAME  AND AF2C.AF2_VERSAO = AF5.AF5_VERSAO  AND AF2C.AF2_EDTPAI = AF5.AF5_EDT  INNER JOIN ADZ000 ADZC ON ADZC.ADZ_FILIAL = ' '  AND ADZC.D_E_L_E_T_ = ' '  AND ADZC.ADZ_PMS=AF2C.AF2_ORCAME  AND ADZC.ADZ_PMSVER=AF2C.AF2_VERSAO  INNER JOIN PVT000 PVT ON PVT.PVT_FILIAL = '           '   AND AF2C.AF2_XGRPOF LIKE '%' || PVT.PVT_CODIGO || '%'   AND PVT.D_E_L_E_T_ = ' '  WHERE  AF1.AF1_FILIAL = ' ' AND AF1.AF1_SIMULA = 'T'  AND AF1.D_E_L_E_T_ = ' ' GROUP BY AF5.AF5_ORCAME ,AF5.AF5_VERSAO ,PVT_CODIGO ,PVT_DESCRI ,AF5.AF5_DESCRI ,ADZC.ADZ_PROPOS ,ADZC.ADZ_REVISA )  ORC ON ORC.ADZ_PROPOS=ADY.ADY_PROPOS  AND ORC.ADZ_REVISA=ADY.ADY_PREVIS WHERE  PKG_FILIAL = ' '  AND PKG.D_E_L_E_T_ = ' '  AND PKG_CODAGR = '000112' AND PKG_TPVEND = '2' AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@")</ADVPL>;;
SRVSIM;PROPOSTAS COM O SIMULADOR DE SERVIÇO;73;20200902;;100;2;;0;;;;2;97;;;1;2;0;;;1;;<ADVPL>IF(_ENTIDA = "2","SELECT DISTINCT 'CLIENTE' AS ENTIDADE ,AD1_NROPOR, AD1_DESCRI, ADY_PROPOS,ADY_DATA,CASE WHEN ADY_STATUS = 'A' THEN 'Proposta em aberto' WHEN ADY_STATUS = 'B' THEN 'Proposta fechada'WHEN  ADY_STATUS = 'C' THEN 'Proposta cancelada'WHEN  ADY_STATUS = 'D' THEN 'Proposta não aprovada' WHEN  ADY_STATUS = 'E' THEN 'Proposta Aprovada' WHEN  ADY_STATUS = 'F' THEN 'Proposta bloqueada' WHEN  ADY_STATUS = 'G' THEN 'Upload Pendente' WHEN  ADY_STATUS = 'H' THEN 'Aguardando Analise' WHEN  ADY_STATUS = 'I' THEN 'Contrato Gerado' WHEN  ADY_STATUS = 'J' THEN 'Pedido de Venda Gerado' WHEN  ADY_STATUS = 'K' THEN 'Nota Fiscal Gerada' END AS ADY_STATUS,ADY_XMLUCR,ADY_XMSPSA,PA3_RISK,CASE WHEN ADY_XTPATE = '1' THEN '100% Remoto' WHEN ADY_XTPATE = '2' THEN 'Até 30% presencial' WHEN ADY_XTPATE = '3' THEN 'Mais que 30% presencial' WHEN ADY_XTPATE = '4' THEN '100% presencial' ELSE 'NAO PREENCHIDO' END AS ADY_XTPATE,CASE WHEN ADY_WEBORC = '1' THEN 'SIM' ELSE 'NAO' END AS ADY_WEBORC,(SELECT DISTINCT SUM(ADZ_TOTAL) FROM ADZ000 ADZ WHERE ADZ_FILIAL = ' ' AND ADZ.D_E_L_E_T_ = ' ' AND ADZ_PROPOS = ADY_PROPOS AND ADZ_REVISA = ADY_PREVIS) AS TOTAL,(SELECT DISTINCT SUM(ADZ_QTDVEN) FROM ADZ000 ADZ WHERE ADZ_FILIAL = ' ' AND ADZ.D_E_L_E_T_ = ' ' AND ADZ_PROPOS = ADY_PROPOS AND ADZ_REVISA = ADY_PREVIS) AS QTDTOTAL,ADJ_CODNIV,AOM_DESCRI,AD1_CODCLI AS COD_CONT,A1_NOME AS RAZAO,AD1_VEND AS COD_VEND,A3_NOME,A3_UNIDAD,ADK_NOME NOM_UNID,ADY_XUNSRV,PE1_DESCRI,ADY_USREMI,USR_NOME,ADY_XDTPRI,ADY_XDTPRF FROM PKG000 PKG INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' ' AND ADJ_CODAGR = '000112' AND ADJ_CODNIV = PKG_CODNIV AND ADJ.D_E_L_E_T_ = ' ' INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' ' AND AD1_NROPOR = ADJ_NROPOR AND AD1_REVISA = ADJ_REVISA AND AD1.D_E_L_E_T_ = ' ' LEFT JOIN pa3000 pa3 ON pa3_filial = ' ' AND pa3_oportu = ad1_nropor AND pa3_versao = (SELECT MAX(PA3_VERSAO) FROM PA3000 WHERE D_E_L_E_T_ = ' ' AND PA3_OPORTU = AD1_NROPOR) AND pa3.d_e_l_e_t_ = ' ' INNER JOIN SA1000 SA1 ON A1_FILIAL = ' ' AND A1_COD = AD1_CODCLI AND A1_LOJA = AD1_LOJCLI AND SA1.D_E_L_E_T_ = ' ' INNER JOIN AOM000 AOM ON AOM_FILIAL = ' ' AND AOM_CODAGR = '000112' AND AOM_CODNIV = ADJ_CODNIV AND AOM.D_E_L_E_T_ = ' ' LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' AND A3_COD = AD1_VEND AND SA3.D_E_L_E_T_ = ' ' LEFT JOIN ADK000 ADK ON ADK_FILIAL = ' ' AND ADK_COD = A3_UNIDAD AND ADK.D_E_L_E_T_ = ' ' INNER JOIN ADY000 ADY ON ADY_FILIAL = ' ' AND ADY_OPORTU = AD1_NROPOR AND ADY_REVISA = AD1_REVISA AND ADY.D_E_L_E_T_ = ' ' LEFT JOIN PE1000 PE1 ON PE1_FILIAL = ' ' AND PE1_CODIGO = ADY_XUNSRV AND PE1.D_E_L_E_T_ = ' ' LEFT JOIN SYS_USR USR ON USR_ID = ADY_USREMI AND USR.D_E_L_E_T_ = ' ' WHERE PKG_FILIAL = ' ' AND PKG.D_E_L_E_T_ = ' ' AND PKG_CODAGR = '000112' AND PKG_TPVEND = '2' AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@","SELECT DISTINCT 'PROSPECT' AS ENTIDADE,AD1_NROPOR,AD1_DESCRI,ADY_PROPOS,ADY_DATA, CASE WHEN ADY_STATUS = 'A' THEN 'Proposta em aberto' WHEN ADY_STATUS = 'B' THEN 'Proposta fechada'WHEN  ADY_STATUS = 'C' THEN 'Proposta cancelada'WHEN  ADY_STATUS = 'D' THEN 'Proposta não aprovada' WHEN  ADY_STATUS = 'E' THEN 'Proposta Aprovada' WHEN  ADY_STATUS = 'F' THEN 'Proposta bloqueada' WHEN  ADY_STATUS = 'G' THEN 'Upload Pendente' WHEN  ADY_STATUS = 'H' THEN 'Aguardando Analise' WHEN  ADY_STATUS = 'I' THEN 'Contrato Gerado' WHEN  ADY_STATUS = 'J' THEN 'Pedido de Venda Gerado' WHEN  ADY_STATUS = 'K' THEN 'Nota Fiscal Gerada' END AS ADY_STATUS,ADY_XMLUCR,ADY_XMSPSA,PA3_RISK,CASE WHEN ADY_XTPATE = '1' THEN '100% Remoto' WHEN ADY_XTPATE = '2' THEN 'Até 30% presencial' WHEN ADY_XTPATE = '3' THEN 'Mais que 30% presencial' WHEN ADY_XTPATE = '4' THEN '100% presencial' ELSE 'NAO PREENCHIDO' END AS ADY_XTPATE,CASE WHEN ADY_WEBORC = '1' THEN 'SIM' ELSE 'NAO' END AS ADY_WEBORC,(SELECT DISTINCT SUM(ADZ_TOTAL) FROM ADZ000 ADZ WHERE ADZ_FILIAL = ' ' AND ADZ.D_E_L_E_T_ = ' ' AND ADZ_PROPOS = ADY_PROPOS AND ADZ_REVISA = ADY_PREVIS) AS TOTAL,(SELECT DISTINCT SUM(ADZ_QTDVEN) FROM ADZ000 ADZ WHERE ADZ_FILIAL = ' ' AND ADZ.D_E_L_E_T_ = ' ' AND ADZ_PROPOS = ADY_PROPOS AND ADZ_REVISA = ADY_PREVIS) AS QTDTOTAL,ADJ_CODNIV,AOM_DESCRI,AD1_PROSPE AS COD_CONT,US_NOME AS RAZAO,AD1_VEND AS COD_VEND,A3_NOME,A3_UNIDAD,ADK_NOME NOM_UNID,ADY_XUNSRV,PE1_DESCRI,ADY_USREMI,USR_NOME,ADY_XDTPRI,ADY_XDTPRF FROM PKG000 PKG INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' ' AND ADJ_CODAGR = '000112' AND ADJ_CODNIV = PKG_CODNIV AND ADJ.D_E_L_E_T_ = ' ' INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' ' AND AD1_NROPOR = ADJ_NROPOR AND AD1_REVISA = ADJ_REVISA AND AD1.D_E_L_E_T_ = ' ' LEFT JOIN pa3000 pa3 ON pa3_filial = ' ' AND pa3_oportu = ad1_nropor AND pa3_versao = (SELECT MAX(PA3_VERSAO) FROM PA3000 WHERE D_E_L_E_T_ = ' ' AND PA3_OPORTU = AD1_NROPOR) AND pa3.d_e_l_e_t_ = ' ' INNER JOIN SUS000 SUS ON US_FILIAL = ' ' AND US_COD = AD1_PROSPE AND US_LOJA = AD1_LOJPRO AND SUS.D_E_L_E_T_ = ' ' INNER JOIN AOM000 AOM ON AOM_FILIAL = ' ' AND AOM_CODAGR = '000112' AND AOM_CODNIV = ADJ_CODNIV AND AOM.D_E_L_E_T_ = ' ' LEFT JOIN SA3000 SA3 ON A3_FILIAL = ' ' AND A3_COD = AD1_VEND AND SA3.D_E_L_E_T_ = ' ' LEFT JOIN ADK000 ADK ON ADK_FILIAL = ' ' AND ADK_COD = A3_UNIDAD AND ADK.D_E_L_E_T_ = ' ' INNER JOIN ADY000 ADY ON ADY_FILIAL = ' ' AND ADY_OPORTU = AD1_NROPOR AND ADY_REVISA = AD1_REVISA AND ADY.D_E_L_E_T_ = ' ' LEFT JOIN PE1000 PE1 ON PE1_FILIAL = ' ' AND PE1_CODIGO = ADY_XUNSRV AND PE1.D_E_L_E_T_ = ' ' LEFT JOIN SYS_USR USR ON USR_ID = ADY_USREMI AND USR.D_E_L_E_T_ = ' ' WHERE PKG_FILIAL = ' ' AND PKG.D_E_L_E_T_ = ' ' AND PKG_CODAGR = '000112' AND PKG_TPVEND = '2' AND ADY_DATA BETWEEN @I_DATA@ AND @F_DATA@")</ADVPL>;;
STVIAG;CONSULTA E ATUALIZA STATUS DE VIAGENS EM ABERTO;06;20210426;;11;2;;0;PZG_OK;;;2;;;;1;2;0;;;1;2;SELECT ' ' PZG_OK,COUNT(*) OVER (PARTITION BY ' ') TOTREG, PZG.* FROM <ADVPL>RetSqlName("PZG")</ADVPL> PZG WHERE UPPER(PZG_STATUS) LIKE 'ABERTO%' AND D_E_L_E_T_=' ';;
SX3;DICIONARIO DE CAMPOS;96;20200627;;45;2;SX3;0;;;;2;A7;;;1;2;0;;;1;;;;
SX5;DICIONARIO DE TABELAS;97;20201019;;8;2;SX5;0;;;;2;B1;;;1;2;0;;;1;;;;
SX6;PARAMETROS DO SISTEMA;96;20180717;;162;2;SX6;0;;;;2;A8;;;1;2;0;;;2;;;;
TABITE;TABELA DE PRECO COM ACESSORIOS;05;20180710;;3;2;;0;;;;2;A9;;;1;2;0;;;1;;SELECT DA1.DA1_CODTAB, B1_COD AS KIT, '1' AS TIPO, B1_COD AS U1_ACESSOR, B1_DESC, B1_XSOLBCS, ZX5_DESCRI, DA1_PRCVEN, DA1_XTPDES
  FROM SB1000 SB1
  JOIN ZX5000 ZX5 ON ZX5_FILIAL = B1_FILIAL AND ZX5_TABELA = 'SOLBCH' AND ZX5_CHAVE = B1_XSOLBCS AND ZX5.D_E_L_E_T_ = ' '
  JOIN DA1000 DA1 ON DA1_FILIAL = B1_FILIAL AND DA1_CODPRO = B1_COD AND DA1_CODTAB BETWEEN @I_DA1_COD_TAB@ AND @F_DA1_COD_TAB@
   AND DA1.D_E_L_E_T_ = ' '
 WHERE SB1.D_E_L_E_T_ = ' ' AND B1_XSOLBCS <> ' '
 UNION 
SELECT DA1.DA1_CODTAB, SB1.B1_COD AS KIT, '2' AS TIPO, U1_ACESSOR, SB1A.B1_DESC, '' AS B1_XSOLBCS, '' AS ZX5_DESCRI, 
       DA1A.DA1_PRCVEN, DA1A.DA1_XTPDES
  FROM SB1000 SB1
  JOIN DA1000 DA1 ON DA1.DA1_FILIAL = B1_FILIAL AND DA1_CODPRO = B1_COD
   AND DA1_CODTAB BETWEEN @I_DA1_COD_TAB@ AND @F_DA1_COD_TAB@ AND DA1.DA1_XTPDES IN (' ', 'A') AND DA1.D_E_L_E_T_ = ' '
  JOIN ZX5000 ZX5 ON ZX5_FILIAL = B1_FILIAL AND ZX5_TABELA = 'SOLBCH' AND ZX5_CHAVE = B1_XSOLBCS AND ZX5.D_E_L_E_T_ = ' '
  JOIN SUG000 SUG ON UG_FILIAL = B1_FILIAL AND UG_PRODUTO = SB1.B1_COD AND SUG.D_E_L_E_T_ = ' '
  JOIN SU1000 SU1 ON U1_FILIAL = B1_FILIAL AND U1_CODACE = UG_CODACE AND SU1.D_E_L_E_T_ = ' ' 
  JOIN SB1000 SB1A ON SB1A.B1_FILIAL = SB1.B1_FILIAL AND SB1A.B1_COD = U1_ACESSOR AND SB1A.D_E_L_E_T_ = ' '
  LEFT JOIN DA1000 DA1A ON DA1A.DA1_FILIAL = ' ' AND DA1A.DA1_CODTAB = DA1.DA1_CODTAB AND DA1A.DA1_CODPRO = U1_ACESSOR 
   AND DA1A.D_E_L_E_T_ = ' ' 
 WHERE SB1.D_E_L_E_T_ = ' ' AND SB1.B1_XSOLBCS <> ' ';;
TCTTR1;CONSULTA TREINAMENTOS VENDIDOS X REALIZADOS;73;20211124;;8;2;;0;;;;2;;;;1;2;0;;;1;;SELECT PD3_FILIAL
	,CASE WHEN PD3_STATUS = 'S' THEN 'SIM/CONFIRMADA' ELSE CASE WHEN PD3_STATUS = 'C' THEN 'CANCELADA' ELSE 'EM CRIACAO' END END PD3_STATUS
	,CASE WHEN PD3_MODAL = '1' THEN 'PRESENCIAL' ELSE 'VIRTUAL' END PD3_MODAL
	,CASE WHEN PD3_CATEG = '1' THEN 'CALENDARIO' ELSE CASE WHEN PD3_CATEG = '2' THEN 'VIP' ELSE CASE WHEN PD3_CATEG = '3' THEN 'PERSONALIZADO' ELSE CASE WHEN PD3_CATEG = '4' THEN 'IN COMPANY' ELSE CASE WHEN PD3_CATEG = '5' THEN 'TOTVERS' ELSE CASE WHEN PD3_CATEG = '6' THEN 'FORMAÇÃO TOTVS' ELSE 'CERTIFICAÇÃO' END END END END END END PD3_CATEG
	,PD3_DTINI
	,PD3_DTFIM
	,PD3_TURMA
	,CASE WHEN PDM_TPOSIS = 'P' THEN 'PROTHEUS' ELSE CASE WHEN PDM_TPOSIS = 'R' THEN 'RM' ELSE CASE WHEN PDM_TPOSIS = 'D' THEN 'DATASUL' ELSE CASE WHEN PDM_TPOSIS = 'L' THEN 'LOGIX' ELSE CASE WHEN PDM_TPOSIS = 'F' THEN 'FORMACAO' ELSE CASE WHEN PDM_TPOSIS = 'G' THEN 'FLUIG' ELSE CASE WHEN PDM_TPOSIS = 'H' THEN 'PC-SISTEMAS' ELSE CASE WHEN PDM_TPOSIS = 'I' THEN 'VIRTUAL AGE' ELSE 'NAO IDENTIFICADO' END END END END END END END END PDM_TPOSIS
	,PD3_CURSO
	,PD3_NOME
	,CASE WHEN PD3_PERIOD = 'I' THEN 'INTEGRAL' ELSE CASE WHEN PD3_PERIOD = 'M' THEN 'MANHA' ELSE CASE WHEN PD3_PERIOD = 'T' THEN 'TARDE' ELSE CASE WHEN PD3_PERIOD = 'N' THEN 'NOITE' ELSE CASE WHEN PD3_PERIOD = 'S' THEN 'SABADO' ELSE 'NAO IDENTIFICADO' END END END END END PD3_PERIOD
	,PD3.PD3_QTDHOR
	,PD2_NOME
	,PD2_EMAIL
	,CASE WHEN PD2_CARGO = '1' THEN 'COODERNADOR' ELSE CASE WHEN PD2_CARGO = '2' THEN 'LIDER' ELSE CASE WHEN PD2_CARGO = '3' THEN 'INSTRUTOR' ELSE CASE WHEN PD2_CARGO = '4' THEN 'ANALISTA' ELSE CASE WHEN PD2_CARGO = '5' THEN 'PARCEIRO' ELSE 'NAO IDENTIFICADO' END END END END END PD2_CARGO
	,CASE WHEN PD7_CONFIR = '1' THEN 'CONFIRMADO' ELSE CASE WHEN PD7_CONFIR = '2' THEN 'CANC. NO PRAZO' ELSE CASE WHEN PD7_CONFIR = '3' THEN 'CANC. FORA DO PRAZO (PERDEU CREDITO)' ELSE CASE WHEN PD7_CONFIR = '4' THEN 'CANC. FORA DO PRAZO (REALOCAR)' ELSE CASE WHEN PD7_CONFIR = '5' THEN 'CORTESIA' ELSE CASE WHEN PD7_CONFIR = '6' THEN 'REALOCADO' ELSE 'NAO IDENTIFICADO' END END END END END END PD7_CONFIR
	,PD7_ALUNO
	,PDL_NOME
	,PDL_EMAIL
	,PD7_PRENC
	,CASE WHEN US_FILIAL IS NULL THEN A1_COD ELSE US_COD END AS A1_COD
	,CASE WHEN US_FILIAL IS NULL THEN A1_NOME ELSE US_NOME END AS A1_NOME
	,PD6_PROPOS
	,PD6_DATA
	,CASE WHEN PD6_TIPO = '1' THEN 'N. RECORRENTE' ELSE CASE WHEN PD6_TIPO = '2' THEN 'RECORRENTE' ELSE CASE WHEN PD6_TIPO = '3' THEN 'INTERNO' ELSE CASE WHEN PD6_TIPO = '4' THEN 'ADMINISTRATIVA' ELSE 'NAO IDENTIFICADO' END END END END PD6_TIPO
	,PD6_SLDHS
	,PD9_QTDE
	,PD9_VALOR
	,PD9_VALTOT
	,PD9_QTDHRS
FROM PDF000 PDF
LEFT JOIN PD2000 PD2 ON PD2.PD2_FILIAL = ' '
	AND PD2.PD2_PROF = PDF.PDF_PROF
	AND PD2.D_E_L_E_T_ = ' '
LEFT JOIN PD3000 PD3 ON PD3.PD3_FILIAL = PDF.PDF_FILIAL
	AND PD3.PD3_TURMA = PDF.PDF_TURMA
	AND PD3.D_E_L_E_T_ = ' '
LEFT JOIN PDM000 PDM ON PDM.PDM_FILIAL = ' '
	AND PDM.PDM_CURSO = PD3.PD3_CURSO
	AND PDM.D_E_L_E_T_ = ' '
LEFT JOIN PD7000 PD7 ON PD7.PD7_FILIAL = PD3.PD3_FILIAL
	AND PD7.PD7_TURMA = PD3.PD3_TURMA
	AND PD7.D_E_L_E_T_ = ' '
LEFT JOIN SA1000 SA1 ON SA1.A1_FILIAL = ' '
	AND SA1.A1_COD = PD7.PD7_CLIENT
	AND SA1.A1_LOJA = PD7.PD7_LOJA
	AND SA1.D_E_L_E_T_ = ' '
LEFT JOIN SUS000 SUS ON SUS.US_FILIAL = ' '
	AND SUS.US_COD = PD7.PD7_PROSPE
	AND SUS.US_LOJA = PD7.PD7_LOJPRO
	AND SUS.D_E_L_E_T_ = ' '
LEFT JOIN PDL000 PDL ON PDL.PDL_ALUNO = PD7.PD7_ALUNO
	AND PDL.D_E_L_E_T_ = ' '
LEFT JOIN PD6000 PD6 ON PD7_FILIAL = PD6_FILIAL
	AND PD7_PROPOS = PD6_PROPOS
	AND PD6.D_E_L_E_T_ = ' '
LEFT JOIN PD9000 PD9 ON PD9_FILIAL = PD6_FILIAL
	AND PD9_PROPOS = PD6_PROPOS
	AND PD9_FILIAL = PD3_FILIAL
	AND PD9_CURSO = PD3_CURSO
	AND PD9.D_E_L_E_T_ = ' '
WHERE  PDF.PDF_FILIAL >= @I_FILIAL@
       AND PDF.PDF_FILIAL <= @F_FILIAL@
       AND PDF.PDF_TURMA >= @I_TURMA@
       AND PDF.PDF_TURMA <= @F_TURMA@
       AND PDF.PDF_DTINI >= @I_DATA@
       AND PDF.PDF_DTFIM <= @F_DATA@
       AND PDF.D_E_L_E_T_= ' ' 
ORDER BY  PD3_FILIAL, PD3_DTINI, PDF_TURMA
;;
TFI930;TFINR930 - AGLUTINADA;06;20200617;;11;2;SA4;0;;;;2;AA;;;1;2;0;;;1;;;;
TIATEN;TI ATENDIMENTO - EXTRAÇÃO DE DADOS;69;20190715;;4;2;;0;;;;2;AB;;;1;2;0;;;1;;SELECT DISTINCT
A1_COD
,A1_CGC
,A1_NOME
,A1_CODSEG
,AOV_DESSEG
,A1_VEND
,SA31.A3_NOME AS NOMEEAR
,A1_XGAR
,SA32.A3_NOME AS NOMEGAR
,A1_CODMEMB
,ADK_NOME
,AD1_NROPOR
,SUBSTR(AD1_DATA,7,2) || '/' || SUBSTR(AD1_DATA,5,2) || '/' || SUBSTR(AD1_DATA,1,4) AS AD1_DATA
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTA'
WHEN AD1_STATUS = '2' THEN 'PERDIDA'
WHEN AD1_STATUS = '9' THEN 'ENCERRADA'
END AS AD1_STATUS
,ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
END AS STAT_PROP
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_TOTAL
FROM SA1000 SA1
INNER JOIN AD1000 AD1 ON AD1_FILIAL = ' '
AND AD1_CODCLI = A1_COD
AND AD1.D_E_L_E_T_ = ' '
INNER JOIN ADY000 ADY ON ADY_FILIAL = ' '
AND ADY_OPORTU = AD1_NROPOR
AND ADY_REVISA = AD1_REVISA
INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS
AND ADZ_PRODUT IN ('1111001024','1111001084')
AND ADZ.D_E_L_E_T_ = ' '
LEFT JOIN AOV000 AOV ON AOV_FILIAL = ' '
AND AOV_CODSEG = A1_CODSEG
AND AOV_PAI = ' '
AND AOV.D_E_L_E_T_ = ' '
LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' '
AND SA31.A3_COD = A1_VEND
AND SA31.D_E_L_E_T_ = ' '
LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' '
AND SA32.A3_COD = A1_XGAR
AND SA32.D_E_L_E_T_ = ' '
LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK_COD = A1_CODMEMB
AND ADK.D_E_L_E_T_ = ' '
WHERE A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
ORDER BY A1_COD, AD1_NROPOR;;RAFAEL SAMPAIO - #6367393 
RAFAEL SAMPAIO - #6295259
RAFAEL SAMPAIO - #5936394
TITIPO;ANÁLISE DE ERRO DO CAMPO TIPO;73;20180709;;60;2;;0;;;;2;AC;;;1;2;0;;;1;;SELECT DISTINCT
'CLIENTE' AS ENTIDADE
,A1_COD AS CODIGO
,A1_NOME AS NOME
,A1_CGC AS CNPJ
,A1_TIPO AS TIPO
,A1_VEND AS ESN
,A3_NOME AS NOMEESN
,'F,L,R,S,X,I,B,C' VALIDOS

FROM SA1000 SA1

INNER JOIN SA3000 SA3 ON A3_FILIAL = ' ' 
AND SA3.D_E_L_E_T_ = ' ' 
AND A3_COD = A1_VEND

WHERE A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' '
AND A1_VEND = @COD_VEND@
AND A1_TIPO NOT IN ('F','L','R','S','X','I','B','C')

UNION ALL

SELECT DISTINCT
'PROSPECT' AS ENTIDADE
,US_COD AS CODIGO
,US_NOME AS NOME
,US_CGC AS CNPJ
,US_TIPO AS TIPO
,US_VEND AS ESN
,A3_NOME AS NOMEESN
,'F,L,R,S,X,M' VALIDOS

FROM SUS000 SUS

INNER JOIN SA3000 SA3 ON A3_FILIAL = ' ' 
AND SA3.D_E_L_E_T_ = ' ' 
AND A3_COD = US_VEND

WHERE US_FILIAL = ' ' 
AND SUS.D_E_L_E_T_ = ' '
AND US_VEND = @COD_VEND@
AND US_TIPO NOT IN ('F','L','R','S','X','M')
AND US_STATUS <> '6'

UNION ALL

SELECT DISTINCT
'SUSPECT' AS ENTIDADE
,ACH_CODIGO AS CODIGO
,ACH_RAZAO AS NOME
,ACH_CGC AS CNPJ
,ACH_TIPO AS TIPO
,ACH_VEND AS ESN
,A3_NOME AS NOMEESN
,'1,2,3,4,5,6,F,R' VALIDOS

FROM ACH000 ACH

INNER JOIN SA3000 SA3 ON A3_FILIAL = ' ' 
AND SA3.D_E_L_E_T_ = ' ' 
AND A3_COD = ACH_VEND

WHERE ACH_FILIAL = ' ' 
AND ACH.D_E_L_E_T_ = ' '
AND ACH_VEND = @COD_VEND@
AND ACH_TIPO NOT IN ('1','2','3','4','5','6','F','R')
AND ACH_STATUS <> '6';;Relatório para análise de erro do campo tipo.
Apenas adicione o código do vendedor e se alguma conta estiver com esse campo errado será apresentada no relatório.
TITTAT;CONSULTA DE LOG DAS TABELAS;06;20180620;;61;2;;0;;;;2;AD;;;1;2;0;;;1;;SELECT ttat_field                                   TMP_FIELD, 
       ttat_cold                                    TMP_COLD, 
       ttat_cnew                                    TMP_CNEW, 
       ttat_type                                    TMP_TYPE, 
       ttat_recno                                   TMP_RECNO, 
       ttat_user                                    TMP_USER, 
       ttat_udb                                     TMP_UDB, 
       ttat_hostnam                                 TMP_HOST, 
       ttat_program                                 TMP_PROG, 
       ttat_operati                                 TMP_OPER, 
       ttat_delet                                   TMP_DELET, 
       To_char(ttat_dtime, 'yyyy-mm-dd hh24:mi:ss') TMP_DTIME, 
       ttat_unq                                     TMP_UNQ, 
       CASE 
         WHEN Ttat_md5(Cast(ttat_cnew AS VARCHAR(255)) 
                       || Cast(ttat_cold AS VARCHAR(255)) 
                       || Cast(ttat_field AS VARCHAR(10)) 
                       || Cast(ttat_recno AS VARCHAR(12)) 
                       || Cast(ttat_operati AS VARCHAR(1)) 
                       || Cast(ttat_delet AS VARCHAR(1)) 
                       || Cast(ttat_type AS VARCHAR(1)) 
                       || Cast(To_char(ttat_dtime, 'yyyy-mm-dd hh24:mi:ss') AS 
                               VARCHAR( 
                               50)) 
                       || Cast(ttat_hostnam AS VARCHAR(50)) 
                       || Cast(ttat_program AS VARCHAR(50)) 
                       || Cast(ttat_udb AS VARCHAR(50)) 
                       || Cast(ttat_userid AS VARCHAR(50)) 
                       || Cast(ttat_user AS VARCHAR(50))) <> ttat_ident THEN '2' 
         ELSE '1' 
       END                                          AS TMP_OK 
FROM   <ADVPL>RetSqlName(__TABELA) + "_TTAT_LOG"</ADVPL> TMP1 
WHERE  ttat_recno IN (<ADVPL>@RECNO@</ADVPL>);;
TNUSMS;RELATÓRIO DE PROPOSTAS TNU;73;20180705;;171;2;;0;;;;2;AE;;;1;2;0;;;1;;SELECT 
A1_COD
,A1_NOME
,A3_UNIDAD
,ADK_NOME
,A1_VEND
,A3_NOME
,CNB_PROPOS
,AD1_DTASSI
,CNB_ITEM
,CNB_PRODUT
,CNB_DESCRI
,CNB_QUANT
,CNB_VLUNIT
,CASE
WHEN CNB_SITUAC = 'A' THEN 'ATIVO'
WHEN CNB_SITUAC = 'S' THEN 'SUSPENSO'
WHEN CNB_SITUAC = 'C' THEN 'CANCELADO'
WHEN CNB_SITUAC = 'G' THEN 'GRATUITO'
WHEN CNB_SITUAC = 'P' THEN 'PENDENTE'
WHEN CNB_SITUAC = 'M' THEN 'MANUAL'
WHEN CNB_SITUAC = 'O' THEN 'TROCADO'
WHEN CNB_SITUAC = 'T' THEN 'TRANSFERIDO'
END AS SITUACAO

FROM SA1000 SA1 

INNER JOIN CN9000 CN9 ON CN9_FILIAL = ' ' 
AND CN9.D_E_L_E_T_ = ' ' 
AND CN9_NUMERO = CONCAT('CON',A1_COD) 
AND CN9_SITUAC = '05' 
AND CN9_ESPCTR = '2' 
AND CN9_REVATU = ' '

INNER JOIN CNB000 CNB ON CNB_FILIAL = ' ' 
AND CNB.D_E_L_E_T_ = ' ' 
AND CNB_CONTRA = CN9_NUMERO 
AND CNB_REVISA = CN9_REVISA

INNER JOIN SA3000 SA3 ON A3_FILIAL = ' ' 
AND A3_COD = A1_VEND 
AND SA3.D_E_L_E_T_ = ' '

INNER JOIN ADK000 ADK ON ADK_FILIAL = ' ' 
AND ADK_COD = A3_UNIDAD
AND ADK.D_E_L_E_T_ = ' '

LEFT JOIN AD1000 AD1 ON AD1_FILIAL = ' '
AND AD1.D_E_L_E_T_ = ' '
AND AD1_PROPOS = CNB_PROPOS

LEFT JOIN SB1000 SB1 ON B1_FILIAL = ' ' 
AND SB1.D_E_L_E_T_ = ' ' 
And b1_cod = cnb_produt

Left join sbm000 sbm on bm_filial = ' ' 
And sbm.d_e_l_e_t_ = ' '
AND BM_GRUPO = B1_GRUPO

WHERE A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' '   
AND (ADK_COD IN ('TSE401','CNT013','CNT389') OR ADK_XSUPER = 'TSE401')
AND SUBSTR(BM_PICPAD,1,2) <ADVPL>If(_SMS = "1", "=", "<>")</ADVPL> '03';;
TRAKIN;CONTROLE TRACKING DE VENDAS  - CST;69;20180618;;416;2;;0;;;;2;AF;;;1;2;0;;;1;;SELECT DISTINCT
ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS STAT_PROP
,ADY_XMODAL
,ADY_XFILSF
,AOM1.AOM_DESCRI AS AGRUP
,AOM2.AOM_DESCRI AS LINREC
,ADY_DTUPL
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_CONDPG
,ADZ_PRCVEN
,ADZ_QTDVEN
,ADZ_TOTAL
,ADY_XSAAS 
,CNB_XCOMPE
,CNB_SITUAC
,CNB_VLUNIT
,CNB_VLTOT
,C6_NUM
,C6_VALOR
,CASE
WHEN ADZ_XSITUA = 'F' THEN 'FATURAR'
WHEN ADZ_XSITUA = 'G' THEN 'GRATUITO'
END AS ADZ_XSITUA
,BM_XLINREC
,AOM2.AOM_DESCRI AS DESC_LIN
,CASE
WHEN BM_XGRPREC = '1' THEN 'RECORRENTE'
WHEN BM_XGRPREC = '2' THEN 'PONTUAL'
END AS BM_XGRPREC
,CNB_DTSITU
,CNB_VIGINI
,ADZ_DT1VEN
,ADZ_XCOMPE
,CNB_CONTRA
,CNB_NUMERO
,CNB_ITEM
,ADY_CODIGO
,A1_NOME
,A1_CODMEMB
,AI0_DTLIMT
,ADK_NOME
,BM_XLINREC
,D2_DOC
,D2_SERIE
,D2_TOTAL
,D2_EMISSAO
,ADZ_XVLTMP
,ADZ_XMESDT
,ADZ_XPDEST
,CNB_STATRM
FROM ADY000 ADY
INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' '
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS
AND ADZ_REVISA = ADY_PREVIS
LEFT JOIN CN9000 CN9 ON CN9_FILIAL = ' ' 
AND CN9.D_E_L_E_T_ = ' ' 
AND CN9_NUMERO = CONCAT('CON',ADY_CODIGO)
AND CN9_ESPCTR = '2'
AND CN9_SITUAC = '05'
AND CN9_REVATU = ' '
LEFT JOIN CNB000 CNB ON CNB_FILIAL = ' '
AND CNB_CONTRA = CN9_NUMERO
AND CNB_REVISA = CN9_REVISA
AND ADZ_PRODUT = CNB_PRODUT
AND CNB_PROITN = ADZ_ITEM
AND CNB_PROREV = ADZ_REVISA
AND CNB_XFLDPR = ADZ_FOLDER
AND CNB_PROPOS = ADZ_PROPOS
AND CNB.D_E_L_E_T_ = ' '
LEFT JOIN SB1000 SB1 ON B1_FILIAL = ' '
AND SB1.D_E_L_E_T_ = ' '
AND B1_COD = ADZ_PRODUT
LEFT JOIN SBM000 SBM ON BM_FILIAL = ' '
AND SBM.D_E_L_E_T_ = ' '
AND BM_GRUPO = B1_GRUPO
INNER JOIN SA1000 SA1 ON A1_FILIAL = ' '
AND SA1.D_E_L_E_T_ = ' '
AND A1_COD = ADY_CODIGO
INNER JOIN AI0000 AI0 ON AI0_FILIAL = ' '
AND AI0_CODCLI = A1_COD
AND AI0_LOJA = A1_LOJA
LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' '
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = A1_CODMEMB
LEFT JOIN AOM000 AOM1 ON AOM1.AOM_FILIAL = ' '
AND AOM1.D_E_L_E_T_ = ' '
AND AOM1.AOM_CODAGR = '000112'
AND AOM1.AOM_CODNIV = ADY_XMODAL
LEFT JOIN AOM000 AOM2 ON AOM2.AOM_FILIAL = ' '
AND AOM2.D_E_L_E_T_ = ' '
AND AOM2.AOM_CODAGR = '000001'
AND AOM2.AOM_IDINT = BM_XLINREC
LEFT JOIN SC6000 SC6 ON SC6.D_E_L_E_T_ = ' ' 
AND C6_XPROPOS = ADZ_PROPOS
AND C6_PRODUTO = ADZ_PRODUT
AND C6_XVERSAO = ADZ_REVISA 
AND C6_XITPROP = ADZ_ITEM 
LEFT JOIN SD2000 SD2 ON SD2.D_E_L_E_T_ = ' ' 
AND C6_NOTA = D2_DOC
AND C6_SERIE = D2_SERIE
AND C6_PRODUTO = D2_COD
AND C6_FILIAL = D2_FILIAL
AND C6_CLI = D2_CLIENTE
AND C6_LOJA = D2_LOJA
AND C6_ITEM = D2_ITEMPV 
WHERE ADY_FILIAL = ' '
AND ADY.D_E_L_E_T_ = ' '
AND ADY_XCDMOT = ' '
AND ADY_XUNSRV = ' '
AND ADY_DTUPL BETWEEN @I_ADY_DTUPL@ AND @F_ADY_DTUPL@
;<ADVPL>(U_EXECSQL("alter session set cursor_sharing = exact"), "")</ADVPL>;
TRMPRD;PRODUTOS DE TREINAMENTOS;73;20210714;;0;2;;0;;;;2;;;;1;2;0;;;1;;SELECT B1_COD
	,B1_DESC
	,B1_GRUPO
	,BM_DESC
FROM SB1000 SB1
INNER JOIN SBM000 SBM ON BM_FILIAL = '           '
	AND BM_GRUPO = B1_GRUPO
	AND SBM.D_E_L_E_T_ = ' '
WHERE B1_FILIAL = '           '
	AND B1_MSBLQL <> '1'
	AND SB1.D_E_L_E_T_ = ' ';;
UNDRSP;RESPONSÁVEL UNIDADE DE VENDAS;73;20180713;;18;2;;0;;;;2;AG;;;1;2;0;;;1;;SELECT DISTINCT
ADK_COD
,ADK_NOME
,ADK_USRESP
,AZS_VEND
,SA31.A3_NOME AS N_RESP1
,ADK_XRESP2
,SA32.A3_NOME AS N_RESP2
,ADK_XRESP3
,SA33.A3_NOME AS N_RESP3

FROM <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK

LEFT JOIN AZS000 AZS ON AZS_FILIAL = ' ' 
AND AZS.D_E_L_E_T_ = ' ' 
AND AZS_CODUND = ADK_COD

LEFT JOIN SA3000 SA31 ON SA31.A3_FILIAL = ' ' 
AND SA31.D_E_L_E_T_ = ' ' 
AND SA31.A3_COD = AZS_VEND

LEFT JOIN SA3000 SA32 ON SA32.A3_FILIAL = ' ' 
AND SA32.D_E_L_E_T_ = ' ' 
AND SA32.A3_COD = ADK_XRESP2

LEFT JOIN SA3000 SA33 ON SA33.A3_FILIAL = ' ' 
AND SA33.D_E_L_E_T_ = ' ' 
AND SA33.A3_COD = ADK_XRESP3

WHERE ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' '
AND SUBSTR(ADK_USRESP,1,6) = AZS_CODUSR
AND SUBSTR(ADK_USRESP,7,2) = AZS_SEQUEN
AND SUBSTR(ADK_USRESP,9,6) = AZS_PAPEL
AND ADK_COD BETWEEN @I_UNID@ AND @F_UNID@;;
UPDMPL;CLASSIFICACAO MPN - LOG DE ALTERACOES;69;20180509;;43;2;;0;;;;2;AH;;;1;2;0;;;1;;SELECT PN1_ALIAS, SUBSTR(PN1_CHVFUL, 1, 6) AS A1_COD, SUBSTR(PN1_CHVFUL, 7, 2) AS A1_LOJA, A1_NOME, USR_CODIGO, USR_EMAIL, PN1_DTMNT, PN1_HRMNT,
       UTL_RAW.CAST_TO_VARCHAR2(DBMS_LOB.SUBSTR(PN1_OBSERR, 50,1)) AS PN1_OBSERR
  FROM PN1000 PN1
  JOIN SA1000 SA1 ON A1_FILIAL = PN1_FILIAL AND A1_COD = SUBSTR(PN1_CHVFUL, 1, 6) AND A1_LOJA = SUBSTR(PN1_CHVFUL, 7, 2) AND SA1.D_E_L_E_T_ = ' '
  JOIN SYS_USR USR ON USR.USR_ID = PN1_MSEXP AND USR.D_E_L_E_T_ = ' '
 WHERE PN1_FILIAL = ' ' AND PN1_ALIAS = 'SA1' AND SUBSTR(PN1_CHVFUL, 1, 6) BETWEEN @I_A1_COD@ AND @F_A1_COD@ 
   AND PN1_DTMNT BETWEEN @I_PN1_DTMNT@ AND @F_PN1_DTMNT@ AND PN1.D_E_L_E_T_ = ' ';;Log das alteracoes do campo de Tipo de Cliente realizadas pela rotina de Classificacao de Clientes MPN
UPDMPN;CLASSIFICACAO DE CLIENTES MPN;69;20180508;;84;2;;1;A1_OK;;;2;AI;;;1;2;0;;;1;;SELECT TAB.*,
       CASE WHEN NOT A1_XCLIVIP = 'B' AND TAB.BM_XLINREC LIKE '%B-%' AND NOT TAB.BM_XLINREC LIKE '%P-%' THEN 'Alterar para B-MPN Bema' 
	        WHEN     A1_XCLIVIP = 'B' AND TAB.BM_XLINREC LIKE '%B-%' AND NOT TAB.BM_XLINREC LIKE '%P-%' THEN 'Ok' 
	        WHEN NOT A1_XCLIVIP = 'F' AND TAB.BM_XLINREC LIKE '%F-%' AND NOT TAB.BM_XLINREC LIKE '%P-%' THEN 'Alterar para F-MPN FLY' 
	        WHEN     A1_XCLIVIP = 'F' AND NOT TAB.BM_XLINREC LIKE '%F-%' AND TAB.BM_XLINREC LIKE '%P-%'
			THEN 'Alterar para 2-Padrao' ELSE 'Ok' End As ACAO,
	   CASE WHEN NOT A1_XCLIVIP = 'B' AND TAB.BM_XLINREC LIKE '%B-%' AND NOT TAB.BM_XLINREC LIKE '%P-%' THEN 'B'
	        WHEN     A1_XCLIVIP = 'B' AND TAB.BM_XLINREC LIKE '%B-%' AND NOT TAB.BM_XLINREC LIKE '%P-%' THEN A1_XCLIVIP
	        WHEN NOT A1_XCLIVIP = 'F' AND TAB.BM_XLINREC LIKE '%F-%' AND NOT TAB.BM_XLINREC LIKE '%P-%' THEN 'F' 
	        WHEN     A1_XCLIVIP = 'F' AND NOT TAB.BM_XLINREC LIKE '%F-%' AND TAB.BM_XLINREC LIKE '%P-%' THEN '2' 
	        ELSE A1_XCLIVIP End As A1_XCLIV_N
  FROM (
SELECT '<ADVPL>If(oCQuery:lJob, "XX", " ")</ADVPL>' AS A1_OK, RECNO, A1_COD, A1_LOJA, A1_NOME, A1_CGC, A1_XCLIVIP, TIPO_CLI, 
       MIN(CN9_DTINIC) AS CN9_DTINIC, 
	   LISTAGG(TAB.BM_XLINREC || '-' || CASE WHEN TAB.BM_XLINREC LIKE '%0262%' THEN 'B' 
	                                         WHEN TAB.BM_XLINREC LIKE '%0105%' OR TAB.BM_XLINREC LIKE '%0201%' OR
	                                              TAB.BM_XLINREC LIKE '%0251%' OR TAB.BM_XLINREC LIKE '%0301%' OR
	                                              TAB.BM_XLINREC LIKE '%0803%' OR TAB.BM_XLINREC LIKE '%0804%' THEN 'F'
									  	     WHEN TAB.BM_XLINREC = '0702' THEN 'C' 
	                                         ELSE 'P' END, '-') WITHIN GROUP (ORDER BY TAB.BM_XLINREC) || '-' AS BM_XLINREC
  FROM (
SELECT CN9.RECNO, A1_COD, A1_LOJA, A1_NOME, A1_CGC, A1_XCLIVIP,
       MIN(CASE WHEN A1_XCLIVIP = '1' THEN 'VIP' WHEN A1_XCLIVIP = '2' THEN 'Padrao' WHEN A1_XCLIVIP = '3' THEN 'Governo'
			    WHEN A1_XCLIVIP = '4' THEN 'Private' WHEN A1_XCLIVIP = '5' THEN 'Gens PM' WHEN A1_XCLIVIP = '6' THEN 'TFS'
			    WHEN A1_XCLIVIP = '7' THEN 'VBP' WHEN A1_XCLIVIP = '8' THEN 'PBP' WHEN A1_XCLIVIP = '9' THEN 'Franquia'
			    WHEN A1_XCLIVIP = 'P' THEN 'Parceiro' WHEN A1_XCLIVIP = 'G' THEN 'Gare' WHEN A1_XCLIVIP = 'U' THEN 'Unidade Propria'
			    WHEN A1_XCLIVIP = 'F' THEN 'MPN Fly' WHEN A1_XCLIVIP = 'T' THEN 'TQTVD' WHEN A1_XCLIVIP = 'B' THEN 'MPN Bema' 
				WHEN A1_XCLIVIP = 'V' THEN 'Vip Adv' ELSE 'Nao Definido' END) AS TIPO_CLI, MIN(CN9_DTINIC) AS CN9_DTINIC, BM_XLINREC
  FROM (SELECT CN9_NUMERO, CN9_REVISA, CN9_DTINIC, SA1.R_E_C_N_O_ AS RECNO, 
               A1_FILIAL, A1_COD, A1_LOJA, A1_NOME, A1_CGC, A1_XCLIVIP
          FROM CN9000 CN9
		  JOIN SA1000 SA1 ON A1_FILIAL = ' ' AND A1_COD = SUBSTR( CN9_NUMERO, 4, 6 ) AND A1_LOJA = '00'
		   AND A1_MSBLQL IN (' ', '2') AND NOT A1_XCLIVIP IN ('1', '3', '4', '9', 'G', 'P', 'V') AND SA1.D_E_L_E_T_ = ' ' 
		 WHERE CN9_FILIAL = ' ' AND CN9_NUMERO BETWEEN ' ' AND 'ZZZZZZZZZZZZZZZ' AND CN9_REVISA BETWEEN ' ' AND 'ZZZZZZ' 
		   AND CN9_ESPCTR = '2' AND CN9_SITUAC = '05' AND CN9.D_E_L_E_T_ = ' ') CN9
  JOIN CNB000 CNB ON CNB_FILIAL = A1_FILIAL AND CNB_CONTRA = CN9_NUMERO AND CNB_REVISA = CN9_REVISA AND CNB_SITUAC IN ('A', 'G', 'P') AND CNB_TIPREC = '1'
   AND CNB.D_E_L_E_T_ = ' '
  JOIN SB1000 SB1 ON B1_FILIAL = A1_FILIAL AND B1_COD = CNB_PRODUT AND SB1.D_E_L_E_T_ = ' '
  JOIN SBM000 SBM ON BM_FILIAL = A1_FILIAL AND BM_GRUPO = B1_GRUPO AND SBM.D_E_L_E_T_ = ' '
 GROUP BY CN9.RECNO, A1_COD, A1_LOJA, A1_NOME, A1_CGC, A1_XCLIVIP, BM_XLINREC
 ) TAB
 GROUP BY RECNO, A1_COD, A1_LOJA, A1_NOME, A1_CGC, A1_XCLIVIP, TIPO_CLI 
) TAB
WHERE CASE WHEN NOT A1_XCLIVIP = 'B' AND TAB.BM_XLINREC LIKE '%B-%' AND NOT TAB.BM_XLINREC LIKE '%P-%' THEN 1
	       WHEN NOT A1_XCLIVIP = 'F' AND TAB.BM_XLINREC LIKE '%F-%' AND NOT TAB.BM_XLINREC LIKE '%P-%' THEN 1 
	       WHEN     A1_XCLIVIP = 'F' AND NOT TAB.BM_XLINREC LIKE '%F-%' AND TAB.BM_XLINREC LIKE '%P-%' THEN 1 
	       ELSE 0 End = 1;;Classificacao do tipo do cliente analisando periodo de assinatura de contrato para Regras MPN
UPDTPC;CLASSIFICAO DE CLIENTES MANUAL;69;20180604;;21;2;;1;A1_OK;;;2;AJ;;;1;2;0;;;1;;SELECT A1_COD, A1_LOJA, A1_NOME, A1_CGC, A1_XCLIVIP, A1_XCLIVIP AS A1_XCLIV_N, R_E_C_N_O_ AS RECNO
FROM SA1000
WHERE A1_FILIAL = '<ADVPL>xFilial("SA1")</ADVPL>'
<ADVPL>If(_SEL_CLI = "1", "AND A1_COD || A1_LOJA BETWEEN '" + _I_A1_COD + _I_A1_LOJA + "' AND '" + _F_A1_COD + _F_A1_LOJA + "'", "AND A1_COD = 'ZZZZZZZZ'")</ADVPL>
AND D_E_L_E_T_ = ' ';;Classificacao manual do tipo de cliente opcionalmente utilizando importacao VIA CSV
UPLOAD;PROPOSTAS SEM DATA DE UPLOAD;73;20200423;;93;2;;1;ADY_OK;;;2;AK;;;1;2;0;;;1;2;SELECT 'XX' AS ADY_OK, ADY_PROPOS, ADY_PREVIS, ADY_OPORTU, ADY_REVISA, ADY_DATA, ADY_ENTIDA, ADY_CODIGO, A1_NOME, ADY_XVALPR, ADY_XVALAC, ADY_XMODAL, AOM_DESCRI, 
       ADY_USRUPL, ADY_DTUPL, ADY_HRUPLO, ADY_STATUS, AOB_DTNOTA, ADY.R_E_C_N_O_ AS ADY_RECNO,
       CASE WHEN COALESCE(ADC_XDATA, ' ') = ' ' THEN ADY_DATA ELSE ADC_XDATA END AS ADC_XDATA, 
       CASE WHEN COALESCE(ADC_XHORA, ' ') = ' ' THEN '15:00:00' ELSE ADC_XHORA END AS ADC_XHORA, 
       CASE WHEN COALESCE(ADC_XCODUS, ' ') = ' ' THEN '999999' ELSE ADC_XCODUS END AS ADC_XCODUS
  FROM ADY000 ADY
  JOIN AOB000 AOB ON AOB.AOB_FILIAL = ' ' AND AOB_ENTIDA = 'ADY' AND SUBSTR(LTRIM(RTRIM(AOB_CHAVE)), 1, 6) = ADY_PROPOS 
   AND AOB_DTNOTA BETWEEN @I_AOB_DTNT@ AND @F_AOB_DTNT@ AND AOB.D_E_L_E_T_ = ' '
  JOIN SA1000 SA1 ON SA1.A1_FILIAL = ' ' AND A1_COD = ADY_CODIGO AND SA1.D_E_L_E_T_ = ' '
  JOIN AOM000 AOM ON AOM.AOM_FILIAL = ' ' AND AOM_CODAGR = '000112' AND AOM_CODNIV = ADY_XMODAL AND AOM.D_E_L_E_T_ = ' '
  LEFT JOIN ADC000 ADC ON ADC_FILIAL = ADY_FILIAL AND ADC_NROPOR = ADY_OPORTU AND ADC_XREVAT = ADY_REVISA AND ADC.D_E_L_E_T_ = ' '
 WHERE ADY_FILIAL = ' ' AND ADY_STATUS IN ('H', 'I', 'J', 'K') AND ADY_ENTIDA = '1' 
<ADVPL>If(_TIPO_P = "1", "AND ADY_DTUPL = ' '", If(_TIPO_P = "2", "AND (ADY_DTUPL <> ' ' AND ADY_HRUPLO = ' ')", "AND (ADY_DTUPL = ' ' OR (ADY_DTUPL <> ' ' AND ADY_HRUPLO = ' '))"))</ADVPL>
   AND ADY.D_E_L_E_T_ = ' '
UNION
SELECT ' ' AS ADY_OK, ADY_PROPOS, ADY_PREVIS, ADY_OPORTU, ADY_REVISA, ADY_DATA, ADY_ENTIDA, ADY_CODIGO, US_NOME, ADY_XVALPR, ADY_XVALAC, ADY_XMODAL, AOM_DESCRI, 
       ADY_USRUPL, ADY_DTUPL, ADY_HRUPLO, ADY_STATUS, AOB_DTNOTA, ADY.R_E_C_N_O_ AS ADY_RECNO, 
       CASE WHEN COALESCE(ADC_XDATA, ' ') = ' ' THEN ADY_DATA ELSE ADC_XDATA END AS ADC_XDATA, 
       CASE WHEN COALESCE(ADC_XHORA, ' ') = ' ' THEN '15:00:00' ELSE ADC_XHORA END AS ADC_XHORA, 
       CASE WHEN COALESCE(ADC_XCODUS, ' ') = ' ' THEN '999999' ELSE ADC_XCODUS END AS ADC_XCODUS
  FROM ADY000 ADY
  JOIN AOB000 AOB ON AOB.AOB_FILIAL = ' ' AND AOB_ENTIDA = 'ADY' AND SUBSTR(LTRIM(RTRIM(AOB_CHAVE)), 1, 6) = ADY_PROPOS 
   AND AOB_DTNOTA BETWEEN @I_AOB_DTNT@ AND @F_AOB_DTNT@ AND AOB.D_E_L_E_T_ = ' '
  JOIN SUS000 SUS ON SUS.US_FILIAL = ' ' AND US_COD = ADY_CODIGO AND SUS.D_E_L_E_T_ = ' '
  JOIN AOM000 AOM ON AOM.AOM_FILIAL = ' ' AND AOM_CODAGR = '000112' AND AOM_CODNIV = ADY_XMODAL AND AOM.D_E_L_E_T_ = ' '
  LEFT JOIN ADC000 ADC ON ADC_FILIAL = ADY_FILIAL AND ADC_NROPOR = ADY_OPORTU AND ADC_XREVAT = ADY_REVISA AND ADC.D_E_L_E_T_ = ' '
 WHERE ADY_FILIAL = ' ' AND ADY_STATUS IN ('H', 'I', 'J', 'K') AND ADY_ENTIDA = '2' 
<ADVPL>If(_TIPO_P = "1", "AND ADY_DTUPL = ' '", If(_TIPO_P = "2", "AND (ADY_DTUPL <> ' ' AND ADY_HRUPLO = ' ')", "AND (ADY_DTUPL = ' ' OR (ADY_DTUPL <> ' ' AND ADY_HRUPLO = ' '))"))</ADVPL>
   AND ADY.D_E_L_E_T_ = ' ';;Formulario para apresentação de propostas sem data de upload (ADY_USRUPL, ADY_DTUPL, ADY_HRUPLO)
VENDNG;PROPOSTAS PARCEIROS;73;20180619;;71;2;;0;;;;2;AL;;;1;2;0;;;1;;SELECT DISTINCT
AD1_NROPOR
,AD1_DESCRI
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTO'
WHEN AD1_STATUS = '2' THEN 'CANCELADO'
WHEN AD1_STATUS = '9' THEN 'ENCERRADA'
END AS AD1_STATUS
,AD1_DTFIM
,ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS STAT_PROP
,ADZ_ITEM
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_PRCTAB
,ADZ_PRCVEN
,ADZ_QTDVEN
,ADZ_TOTAL
,ADZ_DT1VEN
,'CLIENTE' AS ENTIDADE
,AD1_CODCLI AS CODIGO
,A1_CGC AS CNPJ
,A1_NOME AS NOMECLI
,ADY_DTUPL
,PH3_DATA 
,PH3_CMPSOL 
,PH3_CMPCAN


FROM AD1000 AD1

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' ' AND A1_COD = AD1_CODCLI AND SA1.D_E_L_E_T_ = ' '
INNER JOIN ADY000 ADY ON ADY_FILIAL = ' ' AND ADY_OPORTU = AD1_NROPOR AND ADY.D_E_L_E_T_ = ' '
INNER JOIN ADZ000 ADZ ON ADZ_FILIAL = ' ' AND ADZ_PROPOS = ADY_PROPOS AND ADZ_REVISA = ADY_PREVIS AND ADZ.D_E_L_E_T_ = ' '
LEFT JOIN CNB000 CNB ON CNB.D_E_L_E_T_ = ' ' AND CNB_FILIAL = ' ' AND CNB_PROPOS = ADY_PROPOS AND CNB_PROREV = ADY_PREVIS
LEFT JOIN CN9000 CN9 ON CN9_FILIAL = ' ' AND CNB_CONTRA = CN9_NUMERO AND CNB_REVISA = CN9_REVISA AND CN9_ESPCTR = '2' AND CN9_SITUAC = '05' AND CN9_REVATU = ' ' AND CN9.D_E_L_E_T_ = ' '
LEFT JOIN PH3000 PH3 ON PH3_FILIAL = ' ' AND PH3_CONTRA = CN9_NUMERO AND PH3_REVISA = CN9_REVISA AND PH3_NUMERO = CNB_NUMERO AND PH3_ITEM = CNB_ITEM AND PH3_STATUS <> 'D' AND PH3.D_E_L_E_T_ = ' '

WHERE AD1_FILIAL = ' '
AND AD1_DTFIM BETWEEN @I_AD1_DTFIM@ AND @F_AD1_DTFIM@
AND AD1.D_E_L_E_T_ = ' '
AND ADY_XMODAL IN  ('0013','0018','0019','0030','0033','0034','0039','0040','0048','0272 ','0342','0050','0076','0082','0084','0086','0089','0095','0148','0165','0166','0167','0168','0177','0180','0182','0192','0203','0215','0244','0248','0250','0257','0263','0270','0302','0303','0337','0703','9901')

UNION ALL

SELECT DISTINCT
AD1_NROPOR
,AD1_DESCRI
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTO'
WHEN AD1_STATUS = '2' THEN 'CANCELADO'
WHEN AD1_STATUS = '9' THEN 'ENCERRADA'
END AS AD1_STATUS
,AD1_DTFIM
,ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
WHEN ADY_STATUS = 'Z' THEN 'FATURADA ADQUIRIDA'
END AS STAT_PROP
,ADZ_ITEM
,ADZ_PRODUT
,ADZ_DESCRI
,ADZ_PRCTAB
,ADZ_PRCVEN
,ADZ_QTDVEN
,ADZ_TOTAL
,ADZ_DT1VEN
,'PROSPECT' AS ENTIDADE
,AD1_PROSPE AS CODIGO
,US_CGC AS CNPJ
,US_NOME AS NOMECLI
,ADY_DTUPL
,PH3_DATA 
,PH3_CMPSOL 
,PH3_CMPCAN

FROM AD1000 AD1
INNER JOIN SUS000 SUS ON US_FILIAL = ' ' AND US_COD = AD1_PROSPE AND US_STATUS <> '6' AND SUS.D_E_L_E_T_ = ' '
INNER JOIN ADY000 ADY ON ADY_FILIAL = ' ' AND ADY_OPORTU = AD1_NROPOR AND ADY.D_E_L_E_T_ = ' '
LEFT JOIN ADZ000 ADZ ON ADZ_FILIAL = ' ' AND ADZ_PROPOS = ADY_PROPOS AND ADZ_REVISA = ADY_PREVIS AND ADZ.D_E_L_E_T_ = ' '
LEFT JOIN CNB000 CNB ON CNB.D_E_L_E_T_ = ' ' AND CNB_FILIAL = ' ' AND CNB_PROPOS = ADY_PROPOS AND CNB_PROREV = ADY_PREVIS
LEFT JOIN CN9000 CN9 ON CN9_FILIAL = ' ' AND CNB_CONTRA = CN9_NUMERO AND CNB_REVISA = CN9_REVISA AND CN9_ESPCTR = '2' AND CN9_SITUAC = '05' AND CN9_REVATU = ' ' AND CN9.D_E_L_E_T_ = ' '
LEFT JOIN PH3000 PH3 ON PH3_FILIAL = ' ' AND PH3_CONTRA = CN9_NUMERO AND PH3_REVISA = CN9_REVISA AND PH3_NUMERO = CNB_NUMERO AND PH3_ITEM = CNB_ITEM AND PH3_STATUS <> 'D' AND PH3.D_E_L_E_T_ = ' '

WHERE AD1_FILIAL = ' '
AND AD1_DTFIM BETWEEN @I_AD1_DTFIM@ AND @F_AD1_DTFIM@
AND AD1.D_E_L_E_T_ = ' '
AND ADY_XMODAL IN ('0013','0018','0019','0030','0033','0034','0039','0040','0048','0272 ','0342','0050','0076','0082','0084','0086','0089','0095','0148','0165','0166','0167','0168','0177','0180','0182','0192','0203','0215','0244','0248','0250','0257','0263','0270','0302','0303','0337','0703','9901');;
VENDNH;COMPRAS CLOUD;02;20180827;;79;2;;0;;;;2;AM;;;1;2;0;;;1;;SELECT DISTINCT C1_FILIAL, 
M0_FILIAL,
C1_EMISSAO, 
CASE WHEN C1_XTIDT = '1' THEN 'TI' ELSE 'Normal' END C1_XTIDT,
C1_XTOPER,
SX5.X5_DESCRI,
CASE WHEN C1_APROV = 'L' THEN 'Liberada' WHEN C1_APROV = 'B' THEN 'Bloqueada' WHEN C1_APROV = 'R' THEN 'Rejeitada' ELSE ' ' END C1_APROV,
C1_NUM, 
C1_ITEM,
C1_PRODUTO, 
C1_DESCRI, 
C1_QUANT, 
C1_VUNIT, 
C1_SOLICIT, 
C1_XJUSTIF, 
C1_CC,
CTT.CTT_DESC01, 
C1_CONTA,
CT1.CT1_DESC01,
C1_OBS,
CTD_ITEM,
CTD_DESC01,
CTH_CLVL,
CTH_DESC01,
replace(replace(utl_raw.cast_to_varchar2(SC1.C1_XCOMPLE),chr(13),''),chr(10),'') C1_XCOMPLE,
SCR.CR_DATALIB, 
SCR.CR_NIVEL,
SCR.CR_APROV,
USR_NOME,
C7_NUM,
C7_FORNECE,
A2_NOME,
CASE WHEN CR_STATUS = '01' THEN 'Aguardando nivel anterior' WHEN CR_STATUS = '02' THEN 'Pendente' WHEN CR_STATUS = '03' THEN 'Liberado' WHEN CR_STATUS = '04' THEN 'Bloqueado' WHEN CR_STATUS = '05' THEN 'Aprovado/Rejeitado outro usuario' WHEN CR_STATUS = '06' THEN 'Rejeitado' END CR_STATUS,
D1_DOC,
C7_EMISSAO,
C7_MOEDA,
CTO_DESC,
C7_QUANT,
C7_PRECO,
C7_TOTAL,
C7_COND,
E4_DESCRI,
D1_QUANT,
D1_VUNIT,
D1_TOTAL,
D1_EMISSAO

FROM SC1000 SC1

INNER JOIN ZX5000 ZX5
ON ZX5.ZX5_FILIAL = ' '
AND ZX5.ZX5_TABELA = 'CLD006'
AND ZX5.ZX5_CHAVE2 = SC1.C1_CC
AND ZX5.D_E_L_E_T_ = ' '

INNER JOIN CTD000 CTD
ON CTD.CTD_FILIAL = ' '
AND CTD.CTD_ITEM = SC1.C1_ITEMCTA
AND CTD.D_E_L_E_T_ = ' '

INNER JOIN CTH000 CTH
ON CTH.CTH_FILIAL = ' '
AND CTH.CTH_CLVL = SC1.C1_CLVL
AND CTH.D_E_L_E_T_ = ' '

INNER JOIN SCR000 SCR
ON SCR.CR_FILIAL = SC1.C1_FILIAL  
AND SCR.CR_TIPO = 'SC'
AND SCR.CR_NUM = SC1.C1_NUM 
AND SCR.D_E_L_E_T_ = ' '

INNER JOIN SIGAMAT SIGAMAT
ON SIGAMAT.M0_CODFIL = SC1.C1_FILIAL
AND SIGAMAT.M0_CODIGO = '00'
AND SIGAMAT.D_E_L_E_T_ = ' '

INNER JOIN SX5000 SX5
ON SX5.X5_FILIAL = ' '
AND SX5.X5_TABELA = 'ZV'
AND SX5.X5_CHAVE = SC1.C1_XTOPER
AND SX5.D_E_L_E_T_ = ' '

LEFT JOIN CTT000 CTT
ON CTT.CTT_FILIAL = ' ' 
AND CTT.CTT_CUSTO = SC1.C1_CC 
AND CTT.D_E_L_E_T_ = ' '
 
LEFT JOIN CT1000 CT1
ON CT1.CT1_FILIAL = ' ' 
AND CT1.CT1_CONTA = SC1.C1_CONTA 
AND CT1.D_E_L_E_T_ = ' '

LEFT JOIN SYS_USR USR 
ON USR.USR_ID = SCR.CR_USER
AND USR.D_E_L_E_T_= ' '

LEFT JOIN SC7000X SC7
ON SC7.C7_FILIAL = SC1.C1_FILIAL
AND SC7.C7_NUMSC = SC1.C1_NUM
AND SC7.C7_ITEMSC = SC1.C1_ITEM
AND SC7.C7_EMISSAO BETWEEN @DE_C7_EMISSAO@ AND @ATE_C7_EMISSAO@ 
AND SC7.D_E_L_E_T_ = ' '

LEFT JOIN SE4000 SE4 
ON SE4.E4_FILIAL = ' ' 
AND SE4.E4_CODIGO = SC7.C7_COND 
AND SE4.D_E_L_E_T_ = ' '

LEFT JOIN SD1000 SD1
ON SD1.D1_FILIAL = SC1.C1_FILIAL
AND SD1.D1_PEDIDO = SC7.C7_NUM
AND SD1.D1_ITEMPC = SC7.C7_ITEM
AND SD1.D1_FORNECE = SC7.C7_FORNECE
AND SD1.D1_LOJA = SC7.C7_LOJA
AND SD1.D_E_L_E_T_ = ' '

LEFT JOIN SA2000 SA2
ON SA2.A2_FILIAL = ' ' 
AND SA2.A2_COD = SC7.C7_FORNECE 
AND SA2.D_E_L_E_T_ = ' '

LEFT JOIN CTO000 CTO
ON CTO.CTO_FILIAL = ' '
AND CTO.CTO_MOEDA = SC7.C7_MOEDA
AND CTO.D_E_L_E_T_ = ' '

WHERE SC1.C1_FILIAL > ' '
AND SC1.C1_EMISSAO BETWEEN @DE_C1_EMISSAO@ AND @ATE_C1_EMISSAO@                				
AND SC1.D_E_L_E_T_ = ' '
ORDER BY C1_FILIAL, C1_EMISSAO, C1_NUM, C1_ITEM, CR_NIVEL;;
VERZQE;CONTRATOS CUJA VERSÃO DO ZQE NÃO ESTÁ SINCRONIZADA;69;20201209;;5;2;;0;;;;2;;;;1;2;0;;;1;;SELECT CN9_FILIAL, CN9_NUMERO, CN9_REVISA 
FROM 
(
SELECT  
CN9_FILIAL, CN9_NUMERO, CN9_REVISA 
FROM 
<ADVPL>RetSqlName('CN9')</ADVPL>  CN9 
INNER JOIN 
<ADVPL>RetSqlName('CNC')</ADVPL>  CNC 
ON
CN9.CN9_FILIAL = CNC.CNC_FILIAL AND
CN9.CN9_NUMERO = CNC.CNC_NUMERO AND
CN9.CN9_REVISA = CNC.CNC_REVISA
WHERE 
CN9.CN9_SITUAC = '05' AND
CN9.D_E_L_E_T_ = ' ' AND 
CNC.D_E_L_E_T_ = ' ' 
GROUP BY CN9_FILIAL, CN9_NUMERO, CN9_REVISA 
) TAB
WHERE 

EXISTS  ( SELECT ZQE.ZQE_CONTR 
FROM <ADVPL>RetSqlName('ZQE')</ADVPL>  ZQE  
WHERE 
ZQE.D_E_L_E_T_ = ' ' AND 
CN9_FILIAL = ZQE.ZQE_FILIAL AND
CN9_NUMERO = ZQE.ZQE_CONTR  AND
CN9_REVISA <> ZQE.ZQE_VERSAO
) 
;;
VGM001;RELATÓRIO ARQUIVO;06;20180724;;9;2;;0;;;;2;AN;;;1;2;0;;;1;;SELECT 
FLF_FILIAL,
M0_FILIAL,
FLF_TIPO,
FLF_PRESTA,
FLF_RELDTA,
FLF_RELDTE,
USR_NOME,

CASE WHEN FLF_FATCLI >= 1 AND FLF_FATEMP = 0  THEN 'CLIENTE'
WHEN FLF_FATEMP >= 1 AND FLF_FATCLI = 0  THEN 'TOTVS'
ELSE 'CLIENTE\TOTVS'  END AS TIPOFAT,

CASE WHEN  (FLF_TVLRE1 - FLF_TADIA1 - FLF_TDESC1)  >= 1 AND ((FLF_TVLRE2 - FLF_TADIA2 - FLF_TDESC2) <0 OR (FLF_TVLRE3 - FLF_TADIA3 - FLF_TDESC3)<0)  THEN 'A RECEBER/DEVOLVER'
WHEN  (FLF_TVLRE2 - FLF_TADIA2 - FLF_TDESC2)  >= 1 AND ((FLF_TVLRE1 - FLF_TADIA1 - FLF_TDESC1) <0 OR (FLF_TVLRE3 - FLF_TADIA3 - FLF_TDESC3)<0)  THEN 'A RECEBER/DEVOLVER'
WHEN  (FLF_TVLRE3 - FLF_TADIA3 - FLF_TDESC3)  >= 1 AND ((FLF_TVLRE1 - FLF_TADIA1 - FLF_TDESC1) <0 OR (FLF_TVLRE2 - FLF_TADIA2 - FLF_TDESC2)<0)  THEN 'A RECEBER/DEVOLVER'

WHEN  (FLF_TVLRE1 - FLF_TADIA1 - FLF_TDESC1)  >= 1 AND (FLF_TVLRE2 - FLF_TADIA2 - FLF_TDESC2) >= 0 AND (FLF_TVLRE3 - FLF_TADIA3 - FLF_TDESC3) >=0 THEN 'A RECEBER'
WHEN  (FLF_TVLRE2 - FLF_TADIA2 - FLF_TDESC2)  >= 1 AND (FLF_TVLRE1 - FLF_TADIA1 - FLF_TDESC1) >=0 AND (FLF_TVLRE3 - FLF_TADIA3 - FLF_TDESC3) >=0 THEN 'A RECEBER'
WHEN  (FLF_TVLRE3 - FLF_TADIA3 - FLF_TDESC3)  >= 1 AND (FLF_TVLRE1 - FLF_TADIA1 - FLF_TDESC1) >=0 AND (FLF_TVLRE2 - FLF_TADIA2 - FLF_TDESC2) >=0 THEN 'A RECEBER'

WHEN  (FLF_TVLRE1 - FLF_TADIA1 - FLF_TDESC1)  < 0 AND (FLF_TVLRE2 - FLF_TADIA2 - FLF_TDESC2) <= 0 AND (FLF_TVLRE3 - FLF_TADIA3 - FLF_TDESC3) <=0 THEN 'A DEVOLVER'
WHEN  (FLF_TVLRE2 - FLF_TADIA2 - FLF_TDESC2)  < 0 AND (FLF_TVLRE1 - FLF_TADIA1 - FLF_TDESC1) <=0 AND  (FLF_TVLRE3 - FLF_TADIA3 - FLF_TDESC3) <=0 THEN 'A DEVOLVER'
WHEN  (FLF_TVLRE3 - FLF_TADIA3 - FLF_TDESC3)  < 0 AND (FLF_TVLRE1 - FLF_TADIA1 - FLF_TDESC1) <=0 AND (FLF_TVLRE2 - FLF_TADIA2 - FLF_TDESC2) <=0 THEN 'A DEVOLVER'

ELSE 'SEM FINANCEIRO' 
END AS FINANCEIRO

FROM FLF000 FLF

JOIN SYS_USR RD0 ON USR_ID = FLF_RELUSR

LEFT JOIN SIGAMAT EMP ON M0_CODIGO = '00' AND M0_CODFIL = FLF_FILIAL AND EMP.D_E_L_E_T_= ' '

WHERE FLF_RELDTE <> ' '
AND FLF_FILIAL BETWEEN @FIL1@ AND @FIL2@
AND FLF_RELDTA BETWEEN @DATA@ AND @DATA2@
AND FLF.D_E_L_E_T_ = ' ';;
VGM002;CONSULTA DE NOTAS DULPLICADAS NA PREST DE CONTAS;06;20180924;;26;2;;0;;;;2;AO;;;1;2;0;;;1;;SELECT * FROM (SELECT FLF_FILIAL,
       FLF_PARTIC,
       RD0_NOME,
       FLF_PRESTA,
       SUBSTR(E2_HIST,4,10) PRESTA_FIN,
       FLF_SERIE,
       FLF_DOC,
       RD0_FORNEC,
       E2_PREFIXO,
       E2_NUM,
       E2_HIST
FROM FLF000 FLF
JOIN RD0000 RD0 ON RD0_CODIGO = FLF_PARTIC
LEFT JOIN SE2000 SE2 ON E2_FILIAL = FLF_FILIAL
AND E2_PREFIXO = FLF_SERIE
AND E2_NUM = FLF_DOC
AND E2_FORNECE = RD0_FORNEC
AND SE2.D_E_L_E_T_ = ' '
WHERE FLF_SERIE <> ' '
  AND FLF_DOC <> ' '
  AND FLF.D_E_L_E_T_ = ' '
  AND E2_PREFIXO <> ' '
  AND E2_NUM <> ' '
  AND FLF_PARTIC = @PARTIC@
ORDER BY FLF_PARTIC,
         E2_NUM)

WHERE FLF_PRESTA <> PRESTA_FIN

;;
VGM003;CONSULTA PRESTAÇÕES RUSSIA;06;20190503;;4;2;;0;;;;2;AP;;;1;2;0;;;1;;SELECT FLF_FILIAL,
FLF_TIPO,
FLF_PRESTA,
FLF_PARTIC,
FLF_EMISSA, 
FLF_DTINI,
FLF_DTFIM,
FLF_NACION,
FLF_CC,
FLF_ITECTA,
FLF_CLVL,
FLF_TADIA2,
M2_MOEDA2,
FLF_TADIA2*M2_MOEDA2 REAIS
FROM FLF000 FLF


JOIN SM2000 SM2 ON M2_DATA = FLF_DTFIM
AND SM2.D_E_L_E_T_ = ' '

JOIN FLE000 FLE ON FLE_FILIAL = FLF_FILIAL 
AND FLE_PRESTA = FLF_PRESTA
AND FLE_PARTIC = FLF_PARTIC
AND FLE.D_E_L_E_T_ = ' '


WHERE FLE_DESPES = '500014'
AND FLF_EMISSA BETWEEN @DATA1@ AND @DATA2@
AND FLF.D_E_L_E_T_ = ' ';;
VINDIB;TITULOS DA VINDI QUE NÃO GERARAM BOLETOS;69;20190729;;8;2;;0;;;;2;AQ;;;1;2;0;;;1;;SELECT A.D_E_L_E_T_ PLDELETADO, B.E1_VENCREA, E1_NUMBOR, E1_NUMBCO, PL3_IDTRAG, PL3_XTID,  PL3_OBS, A1_NOME, A.*  
FROM PL3000 A 
JOIN SE1000 B ON E1_FILIAL = PL3_FILIAL AND E1_PREFIXO = PL3_PREFIX AND E1_NUM=PL3_NUMTIT AND E1_PARCELA = PL3_PARTIT AND E1_CLIENTE=PL3_CODCLI AND B.D_E_L_E_T_=' '
JOIN SA1000 C ON A1_FILIAL = ' ' AND A1_COD = PL3_CODCLI AND A1_LOJA = PL3_LOJA AND C.D_E_L_E_T_= ' '
WHERE PL3_ERROR LIKE '%Boleto gerado%' AND PL3_GATEWA = '2'
AND A.D_E_L_E_T_=' '
AND E1_NUMBOR = ' '
AND B.D_E_L_E_T_=' ';;
VINDIC;VINDI - CREDENCIAMENTO CLIENTE;69;20190128;;73;2;;0;;;;2;AR;;;1;2;0;;;1;1;SELECT SA1.*, PMV_IDESTR, PMV_VAR1, PMV_VAR2, PMV.R_E_C_N_O_ AS PMV_RECNO,
       CASE WHEN PMV_IDESTR = ' ' AND PMV_VAR1 = ' ' AND PMV_VAR2 = ' ' THEN 'BR_PRETO'
            WHEN PMV_IDESTR <> ' ' AND PMV_VAR1 = ' ' AND PMV_VAR2 = ' ' THEN 'ENABLE'
            WHEN PMV_IDESTR <> ' ' AND PMV_VAR1 <> ' ' AND PMV_VAR2 = ' ' THEN 'BR_AZUL'
            WHEN PMV_IDESTR <> ' ' AND PMV_VAR1 <> ' ' AND PMV_VAR2 <> ' ' THEN 'BR_AMARELO' END AS STATUS
  FROM (SELECT A1_FILIAL, A1_COD, A1_LOJA, A1_NOME, A1_CGC, A1_XEMAILF, A1_DDD, A1_TEL, A1_END, A1_COMPLEM, A1_BAIRRO, A1_CEP, A1_MUN, A1_EST, AI0_XSMSP1, AI0_XSMSD1, AI0_XSMST1
	  FROM <ADVPL>RetSqlName("CNB")</ADVPL> CNB  
          JOIN <ADVPL>RetSqlName("CN9")</ADVPL> CN9 ON CN9.CN9_FILIAL = ' ' AND CN9.CN9_SITUAC  = '05' AND CN9.CN9_ESPCTR = '2' AND CN9.D_E_L_E_T_ = ' '
		  JOIN <ADVPL>RetSqlName("SA1")</ADVPL> SA1 ON SA1.A1_FILIAL = ' ' AND SA1.A1_COD = SUBSTR( CNB_CONTRA, 4, 6 ) AND SA1.A1_LOJA = '00'  
           AND A1_COD BETWEEN @I_A1_COD@ AND @F_A1_COD@ AND SA1.A1_MSBLQL IN (' ', '2') AND SA1.D_E_L_E_T_ = ' ' 
     LEFT JOIN <ADVPL>RetSqlName("AI0")</ADVPL> AI0 ON AI0.AI0_FILIAL =  SA1.A1_FILIAL AND AI0.AI0_CODCLI  = SA1.A1_COD AND AI0.AI0_LOJA = SA1.A1_LOJA AND AI0.D_E_L_E_T_ = ' '
         WHERE CNB.CNB_FILIAL  = '<ADVPL>xFilial("CNB")</ADVPL>' AND CNB.CNB_CONTRA = CN9.CN9_NUMERO AND CNB.CNB_REVISA = CN9.CN9_REVISA AND CNB.CNB_SITUAC = 'A'
           AND CNB.CNB_TIPREC = '1' AND CNB.CNB_CONDPG = '<ADVPL>GetMv("TI_VINDCPG",, "CV1")</ADVPL>' AND CNB.D_E_L_E_T_ = ' ' 
	GROUP BY A1_FILIAL, A1_COD, A1_LOJA, A1_NOME, A1_CGC, A1_XEMAILF, A1_DDD, A1_TEL, A1_END, A1_COMPLEM, A1_BAIRRO, A1_CEP, A1_MUN, A1_EST,AI0_XSMSP1, AI0_XSMSD1, AI0_XSMST1) SA1	
   LEFT JOIN <ADVPL>RetSqlName("PMV")</ADVPL> PMV ON PMV.PMV_FILIAL = '<ADVPL>xFilial("PMV")</ADVPL>' AND PMV.PMV_CHVFUL = A1_COD || A1_LOJA 
    AND PMV.PMV_CINTEG = '000010' AND PMV.PMV_ALIAS = 'PMV' AND PMV.D_E_L_E_T_ = ' '		
  <ADVPL>If(oCQuery:lJob, " WHERE COALESCE(PMV_IDESTR, ' ') = ' ' OR PMV_VAR1 = ' '", "")</ADVPL>;;Formulario para cadastramento do cliente na plataforma de cobranca Vindi (https://app.vindi.com.br)
VINDIF;FATURAS VINDI;69;20190318;;72;2;;0;;;;2;AS;;;1;2;0;;;1;1;SELECT PL3_FILIAL, CASE WHEN CAST('<ADVPL>Dtos(dDataBase)</ADVPL>' - PL3_DATA AS INTEGER) > 6 THEN 'BR_AMARELO' ELSE 'BR_PRETO' END AS STATUS,
       PL3_LOTE, PL3_CODEVE, PL3_PREFIX, PL3_NUMTIT, PL3_PARTIT, PL3_TIPTIT, PL3_CODCLI, PL3_LOJA, A1_NOME, A1_CGC, 
       PL3_DATA, PL3_HORA, PL3_VALOR, PL3_IDTRAG, PL3_XERCNT, PL3.R_E_C_N_O_ AS PL3_RECNO
  FROM <ADVPL>RetSqlName("PL3")</ADVPL> PL3
  JOIN <ADVPL>RetSqlName("SA1")</ADVPL> SA1 ON A1_FILIAL = '<ADVPL>xFilial("SA1")</ADVPL>' AND A1_COD = PL3_CODCLI AND A1_LOJA = PL3_LOJA AND SA1.D_E_L_E_T_ = ' '
 WHERE PL3_FILIAL BETWEEN ' ' AND 'ZZZZZZZ' AND PL3_GATEWA = '2' AND PL3_IDTRAG <> ' ' AND PL3_IDTRAA = ' ' AND PL3_NUMBOR = ' ' 
   AND PL3.D_E_L_E_T_ = ' ';;Formulario que permite a consulta das faturas vindi, com opcao de geracao de boleto/ cancelamento da fatura na vindi ou antecipação da fatura (para titulos sem retorno do NSU). O boleto poderá ser feito somente após o 15o dia da cobrança e a antecipação limitada a 5 tentativas, e que deve ocorrer no 3, 6, 9, 12 ou 15 dia após o envio da fatura
VINDII;VINDI - CLIENTES COM FATURA INICIAL A CANCELAR;69;20190812;;9;2;;0;;;;2;AT;;;1;2;0;;;1;1;SELECT A1_COD,A1_LOJA,A1_NOME,A1_CGC,A1_XEMAILF,A1_DDD,A1_TEL,A1_END,A1_COMPLEM,A1_BAIRRO,A1_CEP,A1_MUN,A1_EST,PMV_IDESTR,PMV_VAR1,PMV_VAR2,PMV.R_E_C_N_O_ AS PMV_RECNO 
FROM   PMV000 PMV 
JOIN (SELECT PL3_CODCLI || PL3_LOJA AS PL3_CODCLI FROM PL3000 
       WHERE PL3_FILIAL BETWEEN ' ' AND 'ZZZZZZ' AND PL3_GATEWA = '2' AND PL3_REFNUA <> ' ' AND PL3_XTID <> ' ' AND D_E_L_E_T_ = ' ' 
      GROUP BY PL3_CODCLI || PL3_LOJA) PL3 ON PL3_CODCLI = PMV_CHVFUL
JOIN SA1000 SA1 ON A1_COD || A1_LOJA = PL3_CODCLI 
       AND SA1.D_E_L_E_T_ = ' ' 
WHERE  PMV_CINTEG='000010' 
       AND PMV_ALIAS = 'PMV' 
       AND PMV.D_E_L_E_T_ = ' ' 
       AND PMV_VAR1 <> ' ' 
       AND PMV_VAR2 = ' ';;
VINDIL;VINDI - LOG COMUNICACAO;69;20190129;;186;2;;0;;;;2;AU;;;1;2;0;;;1;;SELECT SUBSTR(PN1_CHVFUL, 1, 6) AS A1_COD, SUBSTR(PN1_CHVFUL, 7, 2) AS A1_LOJA, SA1.A1_NOME, SA1.A1_CGC,
       CASE WHEN PN1_CPOCHV = 'PMV_CHVFUL' THEN 'CLIENTE' WHEN PN1.PN1_CPOCHV = 'PMV_CCHV1' THEN 'COBRANCA' 
            WHEN PN1_CPOCHV = 'PMV_CCHV2' THEN 'ESTORNO' ELSE '' END AS OPERACAO,
       CASE WHEN PN1_CPOCHV = 'PMV_CHVFUL' THEN PMV_IDESTR WHEN PN1.PN1_CPOCHV = 'PMV_CCHV1' THEN PMV_VAR1 
            WHEN PN1_CPOCHV = 'PMV_CCHV2' THEN PMV_VAR2 ELSE '' END AS PMV_ID, PN1_DTMNT, PN1_HRMNT, PN1.R_E_C_N_O_ AS PN1_RECNO, PMV_IDESTR
  FROM <ADVPL>RetSqlName("PN1")</ADVPL> PN1
  JOIN <ADVPL>RetSqlName("SA1")</ADVPL> SA1 ON A1_FILIAL = '<ADVPL>xFilial("SA1")</ADVPL>' AND SA1.A1_COD = SUBSTR(PN1_CHVFUL, 1, 6) 
   AND SA1.A1_LOJA = SUBSTR(PN1_CHVFUL, 7, 2) AND SA1.A1_COD BETWEEN @I_A1_COD@ AND @F_A1_COD@ AND SA1.D_E_L_E_T_ = ' '
LEFT  JOIN <ADVPL>RetSqlName("PMV")</ADVPL> PMV ON PMV.PMV_FILIAL = '<ADVPL>xFilial("PMV")</ADVPL>' AND PMV.PMV_CHVFUL = A1_COD || A1_LOJA 
   AND PMV.PMV_CINTEG = '000010' AND PMV.PMV_ALIAS = 'PMV' AND PMV.D_E_L_E_T_ = ' '		
 WHERE PN1_FILIAL = '<ADVPL>xFilial("PN1")</ADVPL>' AND PN1_CINTEG = '000010' AND PN1_ALIAS = 'PMV' AND PN1_DTMNT BETWEEN @I_PN1_DTMT@ AND @F_PN1_DTMT@
   AND PN1.D_E_L_E_T_ = ' ';;Consulta do Log de Comunicacao com a Vindi - https://app.vindi.com.br (Envio de Credenciamento do Cliente, Cobrança Inicial de 1 real e Estorno da Cobrança Inicial)
WINLOS;BASE WIN LOSS;73;20180712;;12;2;;0;;;;2;AV;;;1;2;0;;;1;;SELECT DISTINCT
AD1_NROPOR
,AD1_DESCRI
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTO'
WHEN AD1_STATUS = '2' THEN 'PERDIDO'
WHEN AD1_STATUS = '3' THEN 'SUSPENSO'
WHEN AD1_STATUS = '9' THEN 'GANHA'
END AS AD1_STATUS
,AD1_FCS
,ZX51.ZX5_DESCRI AS DESC_FCS
,AD1_FCI
,ZX52.ZX5_DESCRI AS DESC_FCI
,AD1_DATA
,AD1_DTFIM
,ADJ_CODNIV
,AOM_DESCRI
,ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
END AS STAT_PROP
,ADZ_PRODUT
,ADZ_DESCRI
,'CLIENTE' AS ENTIDADE
,AD1_CODCLI AS CODIGO
,A1_NOME
,A1_CGC
,A1_CNAE
,CC3_DESC
,A1_CODSEG
,AOV1.AOV_DESSEG AS SEGMEM
,A1_XCODSUB
,AOV2.AOV_DESSEG AS SUBSEG
,A1_EST
,A1_MUN
,A1_CODMEMB
,ADK_NOME
,U5_CONTAT
,U5_EMAIL

FROM AD1000 AD1

INNER JOIN SA1000 SA1 ON A1_FILIAL = ' ' 
AND SA1.D_E_L_E_T_ = ' '
AND A1_COD = AD1_CODCLI 

INNER JOIN AI0000 AI0 ON AI0_FILIAL = ' ' 
AND AI0.D_E_L_E_T_ = ' '
AND AI0_CODCLI = A1_COD 

INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' ' 
AND ADJ.D_E_L_E_T_ = ' '
AND ADJ_NROPOR = AD1_NROPOR 
AND ADJ_REVISA = AD1_REVISA 

LEFT JOIN CC3000 CC3 ON CC3_FILIAL = ' ' 
AND CC3.D_E_L_E_T_ = ' '
AND CC3_COD = A1_CNAE 

LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' ' 
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = A1_CODSEG AND AOV1.AOV_PAI = ' ' 

LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' ' 
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = A1_XCODSUB 
AND AOV2.AOV_PAI = A1_CODSEG 

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = A1_CODMEMB 

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' ' 
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = '000112' 
AND AOM_CODNIV = ADJ_CODNIV 

LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' '
AND ADY_OPORTU = AD1_NROPOR 
AND ADY_REVISA = AD1_REVISA 

LEFT JOIN ADZ000 ADZ ON ADZ_FILIAL = ' ' 
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS 
AND ADZ_REVISA = ADY_PREVIS 

LEFT JOIN ZX5000 ZX51 ON ZX51.ZX5_FILIAL = ' ' 
AND ZX51.D_E_L_E_T_ = ' '
AND ZX51.ZX5_TABELA = 'CRM001' 
AND ZX51.ZX5_CHAVE = AD1_FCS 

LEFT JOIN ZX5000 ZX52 ON ZX52.ZX5_FILIAL = ' ' 
AND ZX52.D_E_L_E_T_ = ' '
AND ZX52.ZX5_TABELA = 'CRM003' 
AND ZX52.ZX5_CHAVE = AD1_FCI 

LEFT JOIN AC8000 AC8 ON AC8_FILIAL = ' ' 
AND AC8.D_E_L_E_T_ = ' ' 
AND AC8_ENTIDA = 'SA1' 
AND A1_COD = SUBSTR(AC8_CODENT,1,6)

LEFT JOIN SU5000 SU5 ON U5_FILIAL = ' ' 
AND SU5.D_E_L_E_T_ = ' ' 
AND AC8_CODCON = U5_CODCONT

WHERE AD1_FILIAL = ' ' 
AND AD1_DTFIM BETWEEN @I_AD1_DTFIM@ AND @F_AD1_DTFIM@
AND AD1.D_E_L_E_T_ = ' '

UNION ALL

SELECT DISTINCT
AD1_NROPOR
,AD1_DESCRI
,CASE
WHEN AD1_STATUS = '1' THEN 'ABERTO'
WHEN AD1_STATUS = '2' THEN 'PERDIDO'
WHEN AD1_STATUS = '3' THEN 'SUSPENSO'
WHEN AD1_STATUS = '9' THEN 'GANHA'
END AS AD1_STATUS
,AD1_FCS
,ZX51.ZX5_DESCRI AS DESC_FCS
,AD1_FCI
,ZX52.ZX5_DESCRI AS DESC_FCI
,AD1_DATA
,AD1_DTFIM
,ADJ_CODNIV
,AOM_DESCRI
,ADY_PROPOS
,CASE
WHEN ADY_STATUS = 'A' THEN 'ABERTO'
WHEN ADY_STATUS = 'B' THEN 'FECHADA'
WHEN ADY_STATUS = 'C' THEN 'CANCELADA'
WHEN ADY_STATUS = 'D' THEN 'REPROVADA'
WHEN ADY_STATUS = 'E' THEN 'APROVADA'
WHEN ADY_STATUS = 'F' THEN 'BLOQUEADA'
WHEN ADY_STATUS = 'G' THEN 'UPLOAD PENDENTE'
WHEN ADY_STATUS = 'H' THEN 'AGUARDANDO ANALISE'
WHEN ADY_STATUS = 'I' THEN 'CONTRATO GERADO'
WHEN ADY_STATUS = 'J' THEN 'PEDIDO DE VENDA GERADO'
WHEN ADY_STATUS = 'K' THEN 'NF GERADA'
END AS STAT_PROP
,ADZ_PRODUT
,ADZ_DESCRI
,'PROSPECT' AS ENTIDADE
,AD1_PROSPE AS CODIGO
,US_NOME
,US_CGC
,US_CNAE
,CC3_DESC
,US_CODSEG
,AOV1.AOV_DESSEG AS SEGMEM
,US_XCODSUB
,AOV2.AOV_DESSEG AS SUBSEG
,US_EST
,US_MUN
,US_CODMEMB
,ADK_NOME
,U5_CONTAT
,U5_EMAIL

FROM AD1000 AD1

INNER JOIN SUS000 SUS ON US_FILIAL = ' ' 
AND SUS.D_E_L_E_T_ = ' '
AND US_COD = AD1_PROSPE

INNER JOIN ADJ000 ADJ ON ADJ_FILIAL = ' ' 
AND ADJ.D_E_L_E_T_ = ' '
AND ADJ_NROPOR = AD1_NROPOR 
AND ADJ_REVISA = AD1_REVISA 

LEFT JOIN CC3000 CC3 ON CC3_FILIAL = ' ' 
AND CC3.D_E_L_E_T_ = ' '
AND CC3_COD = US_CNAE 

LEFT JOIN AOV000 AOV1 ON AOV1.AOV_FILIAL = ' ' 
AND AOV1.D_E_L_E_T_ = ' '
AND AOV1.AOV_CODSEG = US_CODSEG AND AOV1.AOV_PAI = ' ' 

LEFT JOIN AOV000 AOV2 ON AOV2.AOV_FILIAL = ' ' 
AND AOV2.D_E_L_E_T_ = ' '
AND AOV2.AOV_CODSEG = US_XCODSUB 
AND AOV2.AOV_PAI = US_CODSEG 

LEFT JOIN <ADVPL>RETSQLNAME("ADK")</ADVPL> ADK ON ADK_FILIAL = ' ' 
AND ADK.D_E_L_E_T_ = ' '
AND ADK_COD = US_CODMEMB 

LEFT JOIN AOM000 AOM ON AOM_FILIAL = ' ' 
AND AOM.D_E_L_E_T_ = ' '
AND AOM_CODAGR = '000112' 
AND AOM_CODNIV = ADJ_CODNIV 

LEFT JOIN ADY000 ADY ON ADY_FILIAL = ' ' 
AND ADY.D_E_L_E_T_ = ' '
AND ADY_OPORTU = AD1_NROPOR 
AND ADY_REVISA = AD1_REVISA 

LEFT JOIN ADZ000 ADZ ON ADZ_FILIAL = ' ' 
AND ADZ.D_E_L_E_T_ = ' '
AND ADZ_PROPOS = ADY_PROPOS 
AND ADZ_REVISA = ADY_PREVIS 

LEFT JOIN ZX5000 ZX51 ON ZX51.ZX5_FILIAL = ' ' 
AND ZX51.D_E_L_E_T_ = ' '
AND ZX51.ZX5_TABELA = 'CRM001' 
AND ZX51.ZX5_CHAVE = AD1_FCS 

LEFT JOIN ZX5000 ZX52 ON ZX52.ZX5_FILIAL = ' ' 
AND ZX52.D_E_L_E_T_ = ' '
AND ZX52.ZX5_TABELA = 'CRM003' 
AND ZX52.ZX5_CHAVE = AD1_FCI 

LEFT JOIN AC8000 AC8 ON AC8_FILIAL = ' ' 
AND AC8.D_E_L_E_T_ = ' ' 
AND AC8_ENTIDA = 'SUS' 
AND US_COD = SUBSTR(AC8_CODENT,1,6)

LEFT JOIN SU5000 SU5 ON U5_FILIAL = ' ' 
AND SU5.D_E_L_E_T_ = ' ' 
AND AC8_CODCON = U5_CODCONT

WHERE AD1_FILIAL = ' ' 
AND AD1_DTFIM BETWEEN @I_AD1_DTFIM@ AND @F_AD1_DTFIM@
AND AD1.D_E_L_E_T_ = ' '
AND US_STATUS <> '6';;Relatório base win loss
XA4;AUDIT TRAIL;96;20200711;;5;2;XA4;0;;;;2;AW;;;1;2;0;;;1;;SELECT XA4_ITEM, XA4_IDTAB, XA4_IDFLD, XA4_EMP, XA4_TABLE, XA4_FIELD, R_E_C_N_O_ AS RECNO FROM XA4 WHERE D_E_L_E_T_ = ' ';;
ZL1;DE/PARA DE CONFIGURACOES;05;20180710;;14;2;ZL1;0;;;;2;AX;;;1;2;0;;;1;;;;
ZX5;TABELAS GENERICAS - TDI;05;20180920;;19;2;ZX5;0;;;;2;AY;;;1;2;0;;;1;;;;Manutenção na tabela generica do TI (ZX5)
ZX5SB1;CONSULTA PERSONALIZADA ZX5/SB1;05;20200914;;5;2;;0;;;;2;18;;;1;2;0;;;1;;SELECT DISTINCT
ZX5_TABELA,
ZX5_CHAVE,
ZX5_DESCRI
FROM ZX5000 ZX5

INNER JOIN SB1000 SB1
ON SB1.D_E_L_E_T_ = ' '
AND ZX5.D_E_L_E_T_ = ' '
AND ZX5_FILIAL = ' '
AND ZX5_TABELA='CRM045' 
AND ZX5_CHAVE=B1_XFAMILI;;
